
2022-03-21 14:30:24,822 p=94780 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:30:25,079 p=94780 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:30:25,083 p=94780 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 14:30:25,135 p=94780 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 14:30:25,150 p=94780 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 14:30:25,182 p=94780 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 14:30:27,294 p=94780 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:30:27,312 p=94780 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:30:27,316 p=94780 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:30:27,338 p=94780 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:30:27,355 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 14:30:28,464 p=94780 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 14:30:28,464 p=94780 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 14:30:28,474 p=94780 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 14:30:28,487 p=94780 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 14:30:29,200 p=94780 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 14:30:29,214 p=94780 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 14:30:29,217 p=94780 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 14:30:29,218 p=94780 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 14:30:30,046 p=94780 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 14:30:30,105 p=94780 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 14:30:30,112 p=94780 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 14:30:30,125 p=94780 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 14:30:30,137 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 14:30:31,438 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:30:31,451 p=94780 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:30:31,455 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:30:31,470 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:30:31,480 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 14:30:32,397 p=94780 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 14:30:32,428 p=94780 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 14:30:32,429 p=94780 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 14:30:32,440 p=94780 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 14:30:32,451 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 14:30:33,195 p=94780 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 14:30:33,196 p=94780 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 14:30:33,209 p=94780 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 14:30:33,216 p=94780 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 14:30:33,797 p=94780 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 14:30:33,836 p=94780 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 14:30:33,847 p=94780 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 14:30:33,855 p=94780 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 14:30:34,404 p=94780 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 14:30:34,469 p=94780 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 14:30:34,472 p=94780 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 14:30:34,477 p=94780 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 14:30:35,091 p=94780 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 14:30:35,110 p=94780 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 14:30:35,127 p=94780 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 14:30:35,279 p=94780 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 14:30:35,289 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 14:30:36,976 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:30:36,996 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:30:37,017 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:30:37,020 p=94780 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:30:37,033 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 14:30:38,899 p=94780 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:30:38,906 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:30:38,921 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:30:38,924 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:30:38,934 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 14:30:45,703 p=94780 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 14:30:45,750 p=94780 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 14:30:45,765 p=94780 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 14:30:45,766 p=94780 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 14:30:52,459 p=94780 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 14:30:52,469 p=94780 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 14:30:52,648 p=94780 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 14:30:53,038 p=94780 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 14:30:53,049 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 14:31:22,290 p=94780 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:31:23,698 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:31:24,881 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:31:27,009 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:31:27,019 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:31:27,070 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:27,071 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:27,082 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:27,736 p=94780 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:31:27,746 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:27,784 p=94780 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 11.12 (VMware Postgres 11.12.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 14:31:27,800 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:27,801 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:27,813 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:27,822 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:31:27,870 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:27,871 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:27,883 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:28,401 p=94780 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:31:28,412 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:28,448 p=94780 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 11.12 (VMware Postgres 11.12.0)"
}
2022-03-21 14:31:28,464 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:28,465 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:28,476 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:28,486 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 14:31:29,169 p=94780 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:31:29,169 p=94780 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:31:29,177 p=94780 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:31:29,183 p=94780 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:31:29,193 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 14:31:29,239 p=94780 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:31:29,248 p=94780 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:31:29,260 p=94780 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:31:29,275 p=94780 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:31:29,286 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 14:31:29,335 p=94780 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:31:29,338 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:29,354 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:29,370 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:29,380 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:29,415 p=94780 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:31:29,431 p=94780 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:31:29,433 p=94780 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:31:29,445 p=94780 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:31:29,455 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 14:31:29,488 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:29,503 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:29,515 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,294 p=94780 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"ansible_job_id": "68479039438.18711", "changed": true, "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )", "delta": "0:00:06.736812", "end": "2022-03-21 14:31:36.792424", "finished": 1, "msg": "non-zero return code", "rc": 12, "results_file": "/var/lib/pgsql/.ansible_async/68479039438.18711", "start": "2022-03-21 14:31:30.055612", "started": 1, "stderr": "14:31:30 18721 INFO  Using default --ssl-mode \"require\"\n14:31:30 18721 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:31:30 18721 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:31:30 18721 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:31:30 18721 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=postgres-haproxy01\"\n14:31:30 18721 INFO  Started pg_autoctl postgres service with pid 18725\n14:31:30 18721 INFO  Started pg_autoctl monitor-init service with pid 18726\n14:31:30 18725 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n14:31:30 18726 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known\n14:31:30 18726 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details\n14:31:30 18726 WARN  Failed to grant connection to local network.\n14:31:30 18721 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:31:30 18721 INFO  Restarting service monitor-init\n14:31:30 18729 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known\n14:31:30 18729 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details\n14:31:30 18729 WARN  Failed to grant connection to local network.\n14:31:31 18721 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:31:31 18721 INFO  Restarting service monitor-init\n14:31:31 18730 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known\n14:31:31 18730 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details\n14:31:31 18730 WARN  Failed to grant connection to local network.\n14:31:31 18721 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:31:31 18721 INFO  Restarting service monitor-init\n14:31:36 18731 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known\n14:31:36 18731 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details\n14:31:36 18731 WARN  Failed to grant connection to local network.\n14:31:36 18721 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:31:36 18721 INFO  Restarting service monitor-init\n14:31:36 18862 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known\n14:31:36 18862 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details\n14:31:36 18862 WARN  Failed to grant connection to local network.\n14:31:36 18721 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:31:36 18721 INFO  Restarting service monitor-init\n14:31:36 18863 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known\n14:31:36 18863 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details\n14:31:36 18863 WARN  Failed to grant connection to local network.\n14:31:36 18721 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:31:36 18721 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 6 seconds, stopping now\n14:31:36 18725 INFO  Postgres controller service received signal SIGTERM, terminating\n14:31:36 18721 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.\n14:31:36 18721 INFO  Stop pg_autoctl", "stderr_lines": ["14:31:30 18721 INFO  Using default --ssl-mode \"require\"", "14:31:30 18721 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic", "14:31:30 18721 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.", "14:31:30 18721 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details", "14:31:30 18721 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=postgres-haproxy01\"", "14:31:30 18721 INFO  Started pg_autoctl postgres service with pid 18725", "14:31:30 18721 INFO  Started pg_autoctl monitor-init service with pid 18726", "14:31:30 18725 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v", "14:31:30 18726 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known", "14:31:30 18726 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details", "14:31:30 18726 WARN  Failed to grant connection to local network.", "14:31:30 18721 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:31:30 18721 INFO  Restarting service monitor-init", "14:31:30 18729 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known", "14:31:30 18729 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details", "14:31:30 18729 WARN  Failed to grant connection to local network.", "14:31:31 18721 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:31:31 18721 INFO  Restarting service monitor-init", "14:31:31 18730 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known", "14:31:31 18730 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details", "14:31:31 18730 WARN  Failed to grant connection to local network.", "14:31:31 18721 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:31:31 18721 INFO  Restarting service monitor-init", "14:31:36 18731 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known", "14:31:36 18731 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details", "14:31:36 18731 WARN  Failed to grant connection to local network.", "14:31:36 18721 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:31:36 18721 INFO  Restarting service monitor-init", "14:31:36 18862 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known", "14:31:36 18862 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details", "14:31:36 18862 WARN  Failed to grant connection to local network.", "14:31:36 18721 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:31:36 18721 INFO  Restarting service monitor-init", "14:31:36 18863 WARN  Failed to resolve DNS name \"postgres-haproxy01\": Name or service not known", "14:31:36 18863 WARN  Failed to find IP address for hostname \"postgres-haproxy01\", see above for details", "14:31:36 18863 WARN  Failed to grant connection to local network.", "14:31:36 18721 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:31:36 18721 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 6 seconds, stopping now", "14:31:36 18725 INFO  Postgres controller service received signal SIGTERM, terminating", "14:31:36 18721 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.", "14:31:36 18721 INFO  Stop pg_autoctl"], "stdout": "", "stdout_lines": []}
2022-03-21 14:31:41,303 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:41,324 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,339 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,352 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,362 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 14:31:41,399 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,400 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,412 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,422 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 14:31:41,458 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,459 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,470 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,482 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 14:31:41,502 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,520 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,533 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,542 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:41,578 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,579 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,591 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,600 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:31:41,621 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,639 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,652 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,661 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 14:31:41,682 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,697 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,710 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,720 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:41,757 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,758 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,770 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,780 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 14:31:41,802 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,818 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,832 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,843 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:41,864 p=94780 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:31:41,912 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,927 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:41,938 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 14:31:41,973 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:41,984 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:48,686 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:31:48,694 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:48,732 p=94780 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "65037811788.21513",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:01.270685",
        "end": "2022-03-21 14:31:43.819610",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/65037811788.21513",
        "start": "2022-03-21 14:31:42.548925",
        "started": 1,
        "stderr": "14:31:42 21523 INFO  Using default --ssl-mode \"require\"\n14:31:42 21523 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:31:42 21523 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:31:42 21523 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:31:42 21523 INFO  Started pg_autoctl postgres service with pid 21528\n14:31:42 21523 INFO  Started pg_autoctl node-init service with pid 21529\n14:31:42 21528 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:31:42 21529 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:31:42 21529 INFO  HINT: use `pg_autoctl run` to start the service.\n14:31:42 21523 WARN  pg_autoctl service node-init exited with exit status 0\n14:31:42 21528 INFO  Postgres controller service received signal SIGTERM, terminating\n14:31:42 21523 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:31:42 21523 INFO  Using default --ssl-mode \"require\"",
            "14:31:42 21523 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:31:42 21523 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:31:42 21523 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:31:42 21523 INFO  Started pg_autoctl postgres service with pid 21528",
            "14:31:42 21523 INFO  Started pg_autoctl node-init service with pid 21529",
            "14:31:42 21528 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:31:42 21529 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:31:42 21529 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:31:42 21523 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:31:42 21528 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:31:42 21523 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:31:48,733 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:48,741 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:48,752 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 14:31:48,786 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:48,797 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:55,257 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:31:55,267 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:31:55,310 p=94780 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "230542595291.21902",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031440",
        "end": "2022-03-21 14:31:49.407930",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/230542595291.21902",
        "start": "2022-03-21 14:31:49.376490",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:31:55,311 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:55,320 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:55,333 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 14:31:55,367 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:55,378 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:55,813 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:31:55,824 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 14:31:55,858 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:55,872 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:57,036 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:31:57,047 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:31:57,083 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:57,096 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:31:57,816 p=94780 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:31:57,826 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 14:31:57,862 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:31:57,872 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:32:00,779 p=94780 u=moonja n=ansible | fatal: [co7-node01]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.404000", "end": "2022-03-21 14:32:00.757188", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:31:58.353188", "stderr": "14:31:58 22734 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:32:00 22734 ERROR Connection to database failed: could not connect to server: Connection refused\n14:32:00 22734 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:32:00 22734 ERROR \tTCP/IP connections on port 5432?\n14:32:00 22734 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 23 attempts in 2 seconds, pg_autoctl stops retrying now\n14:32:00 22734 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:31:58 22734 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:32:00 22734 ERROR Connection to database failed: could not connect to server: Connection refused", "14:32:00 22734 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:32:00 22734 ERROR \tTCP/IP connections on port 5432?", "14:32:00 22734 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 23 attempts in 2 seconds, pg_autoctl stops retrying now", "14:32:00 22734 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:32:00,788 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:32:00,809 p=94780 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:32:00,820 p=94780 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:32:00,830 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 14:32:07,172 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:32:07,172 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:32:07,182 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:32:07,209 p=94780 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "175318724510.20637",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.240777",
        "end": "2022-03-21 14:32:01.637722",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/175318724510.20637",
        "start": "2022-03-21 14:32:01.396945",
        "started": 1,
        "stderr": "14:32:01 20647 INFO  Using default --ssl-mode \"require\"\n14:32:01 20647 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:32:01 20647 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:32:01 20647 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:32:01 20647 INFO  Started pg_autoctl postgres service with pid 20652\n14:32:01 20652 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:32:01 20647 INFO  Started pg_autoctl node-init service with pid 20653\n14:32:01 20653 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:32:01 20653 INFO  HINT: use `pg_autoctl run` to start the service.\n14:32:01 20647 WARN  pg_autoctl service node-init exited with exit status 0\n14:32:01 20652 INFO  Postgres controller service received signal SIGTERM, terminating\n14:32:01 20647 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:32:01 20647 INFO  Using default --ssl-mode \"require\"",
            "14:32:01 20647 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:32:01 20647 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:32:01 20647 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:32:01 20647 INFO  Started pg_autoctl postgres service with pid 20652",
            "14:32:01 20652 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:32:01 20647 INFO  Started pg_autoctl node-init service with pid 20653",
            "14:32:01 20653 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:32:01 20653 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:32:01 20647 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:32:01 20652 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:32:01 20647 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:32:07,224 p=94780 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "822724583294.20045",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.240686",
        "end": "2022-03-21 14:32:01.641092",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/822724583294.20045",
        "start": "2022-03-21 14:32:01.400406",
        "started": 1,
        "stderr": "14:32:01 20055 INFO  Using default --ssl-mode \"require\"\n14:32:01 20055 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:32:01 20055 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:32:01 20055 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:32:01 20055 INFO  Started pg_autoctl postgres service with pid 20060\n14:32:01 20055 INFO  Started pg_autoctl node-init service with pid 20061\n14:32:01 20060 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:32:01 20061 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:32:01 20061 INFO  HINT: use `pg_autoctl run` to start the service.\n14:32:01 20055 WARN  pg_autoctl service node-init exited with exit status 0\n14:32:01 20060 INFO  Postgres controller service received signal SIGTERM, terminating\n14:32:01 20055 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:32:01 20055 INFO  Using default --ssl-mode \"require\"",
            "14:32:01 20055 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:32:01 20055 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:32:01 20055 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:32:01 20055 INFO  Started pg_autoctl postgres service with pid 20060",
            "14:32:01 20055 INFO  Started pg_autoctl node-init service with pid 20061",
            "14:32:01 20060 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:32:01 20061 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:32:01 20061 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:32:01 20055 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:32:01 20060 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:32:01 20055 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:32:07,234 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 14:32:13,528 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:32:13,528 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:32:13,536 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:32:13,561 p=94780 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "617665533103.21018",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032128",
        "end": "2022-03-21 14:32:07.869291",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/617665533103.21018",
        "start": "2022-03-21 14:32:07.837163",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:32:13,576 p=94780 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "636601926022.20426",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032086",
        "end": "2022-03-21 14:32:07.869228",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/636601926022.20426",
        "start": "2022-03-21 14:32:07.837142",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:32:13,586 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 14:32:14,023 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:32:14,049 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:32:14,060 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 14:32:14,792 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:32:14,794 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:32:14,804 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:32:15,465 p=94780 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:32:15,466 p=94780 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:32:15,474 p=94780 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 14:32:18,363 p=94780 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.354955", "end": "2022-03-21 14:32:18.320207", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:32:15.965252", "stderr": "14:32:16 21850 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:32:18 21850 ERROR Connection to database failed: could not connect to server: Connection refused\n14:32:18 21850 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:32:18 21850 ERROR \tTCP/IP connections on port 5432?\n14:32:18 21850 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 19 attempts in 2 seconds, pg_autoctl stops retrying now\n14:32:18 21850 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:32:16 21850 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:32:18 21850 ERROR Connection to database failed: could not connect to server: Connection refused", "14:32:18 21850 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:32:18 21850 ERROR \tTCP/IP connections on port 5432?", "14:32:18 21850 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 19 attempts in 2 seconds, pg_autoctl stops retrying now", "14:32:18 21850 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:32:18,364 p=94780 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.356156", "end": "2022-03-21 14:32:18.322091", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:32:15.965935", "stderr": "14:32:16 21258 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:32:18 21258 ERROR Connection to database failed: could not connect to server: Connection refused\n14:32:18 21258 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:32:18 21258 ERROR \tTCP/IP connections on port 5432?\n14:32:18 21258 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 19 attempts in 2 seconds, pg_autoctl stops retrying now\n14:32:18 21258 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:32:16 21258 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:32:18 21258 ERROR Connection to database failed: could not connect to server: Connection refused", "14:32:18 21258 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:32:18 21258 ERROR \tTCP/IP connections on port 5432?", "14:32:18 21258 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 19 attempts in 2 seconds, pg_autoctl stops retrying now", "14:32:18 21258 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:32:18,366 p=94780 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 14:32:18,366 p=94780 u=moonja n=ansible | co7-master                 : ok=16   changed=8    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2022-03-21 14:32:18,366 p=94780 u=moonja n=ansible | co7-node01                 : ok=19   changed=11   unreachable=0    failed=1    skipped=16   rescued=0    ignored=0   
2022-03-21 14:32:18,366 p=94780 u=moonja n=ansible | co7-node02                 : ok=19   changed=11   unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 14:32:18,366 p=94780 u=moonja n=ansible | co7-node03                 : ok=19   changed=11   unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 14:39:47,965 p=98793 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:39:48,342 p=98793 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:39:48,348 p=98793 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 14:39:48,413 p=98793 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 14:39:48,430 p=98793 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 14:39:48,461 p=98793 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 14:39:50,817 p=98793 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:39:50,824 p=98793 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:39:50,839 p=98793 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:39:50,840 p=98793 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:39:50,857 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 14:39:51,929 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 14:39:51,930 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 14:39:51,947 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 14:39:51,960 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 14:39:51,972 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 14:39:52,794 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 14:39:52,796 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 14:39:52,803 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 14:39:52,814 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 14:39:53,402 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 14:39:53,414 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 14:39:53,445 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 14:39:53,482 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 14:39:54,022 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 14:39:54,047 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 14:39:54,066 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 14:39:54,080 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 14:39:54,633 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 14:39:54,659 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 14:39:54,731 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 14:39:54,732 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 14:39:54,744 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 14:39:56,847 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:39:56,849 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:39:56,859 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:39:56,860 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:39:56,870 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 14:39:58,521 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:39:58,578 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:39:58,592 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:39:58,599 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:39:58,609 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:39:58,642 p=98793 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:39:58,656 p=98793 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:39:58,668 p=98793 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:39:59,443 p=98793 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 14:39:59,443 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:39:59,452 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:39:59,485 p=98793 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:39:59,500 p=98793 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:39:59,512 p=98793 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:39:59,921 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:39:59,931 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 14:40:00,634 p=98793 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:40:00,652 p=98793 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:40:00,665 p=98793 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:40:00,680 p=98793 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:40:00,689 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 14:40:00,737 p=98793 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:40:02,819 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:40:02,820 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:40:03,262 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:40:03,273 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 14:40:03,293 p=98793 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:40:03,309 p=98793 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:40:03,987 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:40:03,987 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:40:03,996 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 14:40:04,016 p=98793 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:40:04,032 p=98793 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:40:04,794 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:40:04,794 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:40:04,803 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 14:40:04,825 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:04,827 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:04,831 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:04,837 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:04,837 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:04,842 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:04,843 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:04,846 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:04,850 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:04,850 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:05,574 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:40:05,574 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:40:06,013 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:40:06,014 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:40:06,501 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:40:06,502 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:40:07,001 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 14:40:07,002 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 14:40:07,428 p=98793 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:40:07,429 p=98793 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:40:07,440 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 14:40:07,460 p=98793 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:40:07,490 p=98793 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:40:07,501 p=98793 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:40:07,917 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:40:07,928 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 14:40:07,949 p=98793 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:40:07,983 p=98793 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:40:07,995 p=98793 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:40:08,728 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:40:08,738 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 14:40:08,761 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:08,762 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:08,770 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:08,771 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:08,775 p=98793 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:08,794 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:08,796 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:08,799 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:08,802 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:08,802 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:08,810 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:08,812 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:08,815 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:08,817 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:08,818 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:09,284 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:40:09,723 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:40:10,242 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:40:10,842 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 14:40:11,349 p=98793 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:40:11,360 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 14:40:11,394 p=98793 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:40:11,410 p=98793 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:40:11,422 p=98793 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:40:11,895 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:40:11,904 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 14:40:11,938 p=98793 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:40:11,954 p=98793 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:40:11,966 p=98793 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:40:12,511 p=98793 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 14:40:12,511 p=98793 u=moonja n=ansible | ...ignoring
2022-03-21 14:40:12,520 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 14:40:12,558 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:12,559 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:12,563 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:12,568 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:12,568 p=98793 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:12,573 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:12,575 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:12,581 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:12,581 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:12,582 p=98793 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:12,591 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:40:12,594 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:40:12,596 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:40:12,599 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:40:12,599 p=98793 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:40:13,006 p=98793 u=moonja n=ansible | ok: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:40:13,450 p=98793 u=moonja n=ansible | ok: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:40:13,921 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:40:14,421 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 14:40:14,816 p=98793 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:40:14,827 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 14:40:46,257 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:40:48,542 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:40:48,583 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:40:49,448 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:40:49,457 p=98793 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 14:40:49,906 p=98793 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:40:49,928 p=98793 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:40:49,943 p=98793 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:40:49,955 p=98793 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:40:50,001 p=98793 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 14:40:50,002 p=98793 u=moonja n=ansible | co7-master                 : ok=13   changed=10   unreachable=0    failed=0    skipped=7    rescued=0    ignored=1   
2022-03-21 14:40:50,002 p=98793 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 14:40:50,002 p=98793 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 14:40:50,002 p=98793 u=moonja n=ansible | co7-node03                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 14:42:38,824 p=462 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:42:39,075 p=462 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:42:39,080 p=462 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 14:42:39,130 p=462 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 14:42:39,145 p=462 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 14:42:39,175 p=462 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 14:42:41,468 p=462 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:42:41,512 p=462 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:42:41,523 p=462 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:42:41,614 p=462 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:42:41,632 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 14:42:42,648 p=462 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 14:42:42,666 p=462 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 14:42:42,688 p=462 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 14:42:42,696 p=462 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 14:42:43,347 p=462 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 14:42:43,394 p=462 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 14:42:43,459 p=462 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 14:42:43,466 p=462 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 14:42:44,270 p=462 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 14:42:44,360 p=462 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 14:42:44,363 p=462 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 14:42:44,382 p=462 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 14:42:44,395 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 14:42:45,644 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:42:45,647 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:42:45,726 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:42:45,743 p=462 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:42:45,753 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 14:42:46,804 p=462 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 14:42:46,806 p=462 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 14:42:46,812 p=462 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 14:42:46,814 p=462 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 14:42:46,826 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 14:42:47,634 p=462 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 14:42:47,635 p=462 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 14:42:47,733 p=462 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 14:42:47,734 p=462 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 14:42:48,388 p=462 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 14:42:48,420 p=462 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 14:42:48,502 p=462 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 14:42:48,512 p=462 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 14:42:49,030 p=462 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 14:42:49,063 p=462 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 14:42:49,114 p=462 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 14:42:49,124 p=462 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 14:42:49,681 p=462 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 14:42:49,687 p=462 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 14:42:49,733 p=462 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 14:42:49,750 p=462 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 14:42:49,760 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 14:42:51,492 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:42:51,569 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:42:51,582 p=462 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:42:51,583 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:42:51,629 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 14:42:53,348 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:42:53,354 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:42:53,372 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:42:53,379 p=462 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:42:53,390 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 14:43:00,182 p=462 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 14:43:00,191 p=462 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 14:43:00,286 p=462 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 14:43:00,294 p=462 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 14:43:06,763 p=462 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 14:43:06,775 p=462 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 14:43:06,804 p=462 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 14:43:06,815 p=462 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 14:43:06,828 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 14:43:34,709 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:43:35,102 p=462 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:43:36,074 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:43:36,169 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:43:36,178 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:43:36,228 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:43:36,229 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:43:36,240 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:43:36,920 p=462 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 14:43:36,920 p=462 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:43:36,932 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:43:36,968 p=462 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 11.12 (VMware Postgres 11.12.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 14:43:36,985 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:43:36,986 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:43:36,998 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:43:37,008 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:43:37,042 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:43:37,056 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:43:37,069 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:43:37,539 p=462 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:43:37,549 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:43:37,588 p=462 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 11.12 (VMware Postgres 11.12.0)"
}
2022-03-21 14:43:37,604 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:43:37,605 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:43:37,617 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:43:37,627 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 14:43:38,336 p=462 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:43:38,341 p=462 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:43:38,349 p=462 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:43:38,350 p=462 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:43:38,360 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 14:43:38,408 p=462 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:43:38,414 p=462 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:43:38,428 p=462 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:43:38,444 p=462 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:43:38,454 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 14:43:38,502 p=462 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:43:38,505 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:43:38,519 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:43:38,536 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:43:38,546 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:43:38,581 p=462 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:43:38,598 p=462 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:43:38,600 p=462 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:43:38,612 p=462 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:43:38,622 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 14:43:38,671 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:43:38,672 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:43:38,682 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:42,602 p=462 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"ansible_job_id": "609022748809.26934", "changed": true, "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )", "delta": "0:01:02.018786", "end": "2022-03-21 14:44:41.284806", "finished": 1, "msg": "non-zero return code", "rc": 12, "results_file": "/var/lib/pgsql/.ansible_async/609022748809.26934", "start": "2022-03-21 14:43:39.266020", "started": 1, "stderr": "14:43:39 26944 INFO  Using default --ssl-mode \"require\"\n14:43:39 26944 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:43:39 26944 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:43:39 26944 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:43:39 26944 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n14:43:39 26944 INFO  Started pg_autoctl postgres service with pid 26948\n14:43:39 26944 INFO  Started pg_autoctl monitor-init service with pid 26949\n14:43:39 26948 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n14:43:39 26949 INFO  Granting connection privileges on 192.168.0.0/24\n14:43:39 26953 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:43:49 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:43:49 26949 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:43:49 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:43:49 26949 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:43:49 26948 ERROR Failed to get Postgres pid, see above for details\n14:43:49 26949 ERROR Failed to get Postgres pid, see above for details\n14:43:49 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:43:49 26949 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:43:49 26948 ERROR 2022-03-21 14:43:39.439 KST [26953] FATAL:  database files are incompatible with server\n14:43:49 26949 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:43:49 26948 ERROR 2022-03-21 14:43:39.439 KST [26953] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).\n14:43:49 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:43:49 26944 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:43:49 26944 INFO  Restarting service monitor-init\n14:43:49 27092 INFO  Granting connection privileges on 192.168.0.0/24\n14:43:49 27094 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:43:59 27092 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:43:59 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:43:59 27092 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:43:59 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:43:59 27092 ERROR Failed to get Postgres pid, see above for details\n14:43:59 26948 ERROR Failed to get Postgres pid, see above for details\n14:43:59 27092 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:43:59 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:43:59 27092 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:43:59 26948 ERROR 2022-03-21 14:43:49.307 KST [27094] FATAL:  database files are incompatible with server\n14:43:59 26948 ERROR 2022-03-21 14:43:49.307 KST [27094] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).\n14:43:59 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:43:59 26944 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:43:59 26944 INFO  Restarting service monitor-init\n14:43:59 27267 INFO  Granting connection privileges on 192.168.0.0/24\n14:43:59 27269 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:44:09 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:09 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:09 26948 ERROR Failed to get Postgres pid, see above for details\n14:44:09 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:44:09 26948 ERROR 2022-03-21 14:43:59.248 KST [27269] FATAL:  database files are incompatible with server\n14:44:09 26948 ERROR 2022-03-21 14:43:59.248 KST [27269] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).\n14:44:09 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:44:09 27267 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:09 27267 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:09 27267 ERROR Failed to get Postgres pid, see above for details\n14:44:09 27267 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:44:09 27267 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:44:09 26944 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:44:09 26944 INFO  Restarting service monitor-init\n14:44:09 27442 INFO  Granting connection privileges on 192.168.0.0/24\n14:44:10 27444 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:44:20 27442 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:20 27442 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:20 27442 ERROR Failed to get Postgres pid, see above for details\n14:44:20 27442 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:44:20 27442 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:44:20 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:20 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:20 26948 ERROR Failed to get Postgres pid, see above for details\n14:44:20 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:44:20 26948 ERROR 2022-03-21 14:44:10.814 KST [27444] FATAL:  database files are incompatible with server\n14:44:20 26948 ERROR 2022-03-21 14:44:10.814 KST [27444] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).\n14:44:20 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:44:20 26944 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:44:20 26944 INFO  Restarting service monitor-init\n14:44:20 27617 INFO  Granting connection privileges on 192.168.0.0/24\n14:44:21 27619 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:44:31 27617 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:31 27617 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:31 27617 ERROR Failed to get Postgres pid, see above for details\n14:44:31 27617 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:44:31 27617 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:44:31 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:31 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:31 26948 ERROR Failed to get Postgres pid, see above for details\n14:44:31 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:44:31 26948 ERROR 2022-03-21 14:44:21.509 KST [27619] FATAL:  database files are incompatible with server\n14:44:31 26948 ERROR 2022-03-21 14:44:21.509 KST [27619] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).\n14:44:31 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:44:31 26944 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:44:31 26944 INFO  Restarting service monitor-init\n14:44:31 27792 INFO  Granting connection privileges on 192.168.0.0/24\n14:44:31 27794 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:44:41 27792 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:41 27792 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:41 27792 ERROR Failed to get Postgres pid, see above for details\n14:44:41 27792 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:44:41 27792 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:44:41 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:44:41 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:44:41 26948 ERROR Failed to get Postgres pid, see above for details\n14:44:41 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:44:41 26948 ERROR 2022-03-21 14:44:31.251 KST [27794] FATAL:  database files are incompatible with server\n14:44:41 26948 ERROR 2022-03-21 14:44:31.251 KST [27794] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).\n14:44:41 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:44:41 26944 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:44:41 26944 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 52 seconds, stopping now\n14:44:41 26948 INFO  Postgres controller service received signal SIGTERM, terminating\n14:44:41 26944 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.\n14:44:41 26944 INFO  Stop pg_autoctl", "stderr_lines": ["14:43:39 26944 INFO  Using default --ssl-mode \"require\"", "14:43:39 26944 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic", "14:43:39 26944 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.", "14:43:39 26944 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details", "14:43:39 26944 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"", "14:43:39 26944 INFO  Started pg_autoctl postgres service with pid 26948", "14:43:39 26944 INFO  Started pg_autoctl monitor-init service with pid 26949", "14:43:39 26948 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v", "14:43:39 26949 INFO  Granting connection privileges on 192.168.0.0/24", "14:43:39 26953 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:43:49 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:43:49 26949 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:43:49 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:43:49 26949 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:43:49 26948 ERROR Failed to get Postgres pid, see above for details", "14:43:49 26949 ERROR Failed to get Postgres pid, see above for details", "14:43:49 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:43:49 26949 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:43:49 26948 ERROR 2022-03-21 14:43:39.439 KST [26953] FATAL:  database files are incompatible with server", "14:43:49 26949 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:43:49 26948 ERROR 2022-03-21 14:43:39.439 KST [26953] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).", "14:43:49 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:43:49 26944 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:43:49 26944 INFO  Restarting service monitor-init", "14:43:49 27092 INFO  Granting connection privileges on 192.168.0.0/24", "14:43:49 27094 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:43:59 27092 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:43:59 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:43:59 27092 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:43:59 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:43:59 27092 ERROR Failed to get Postgres pid, see above for details", "14:43:59 26948 ERROR Failed to get Postgres pid, see above for details", "14:43:59 27092 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:43:59 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:43:59 27092 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:43:59 26948 ERROR 2022-03-21 14:43:49.307 KST [27094] FATAL:  database files are incompatible with server", "14:43:59 26948 ERROR 2022-03-21 14:43:49.307 KST [27094] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).", "14:43:59 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:43:59 26944 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:43:59 26944 INFO  Restarting service monitor-init", "14:43:59 27267 INFO  Granting connection privileges on 192.168.0.0/24", "14:43:59 27269 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:44:09 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:09 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:09 26948 ERROR Failed to get Postgres pid, see above for details", "14:44:09 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:44:09 26948 ERROR 2022-03-21 14:43:59.248 KST [27269] FATAL:  database files are incompatible with server", "14:44:09 26948 ERROR 2022-03-21 14:43:59.248 KST [27269] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).", "14:44:09 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:44:09 27267 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:09 27267 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:09 27267 ERROR Failed to get Postgres pid, see above for details", "14:44:09 27267 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:44:09 27267 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:44:09 26944 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:44:09 26944 INFO  Restarting service monitor-init", "14:44:09 27442 INFO  Granting connection privileges on 192.168.0.0/24", "14:44:10 27444 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:44:20 27442 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:20 27442 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:20 27442 ERROR Failed to get Postgres pid, see above for details", "14:44:20 27442 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:44:20 27442 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:44:20 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:20 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:20 26948 ERROR Failed to get Postgres pid, see above for details", "14:44:20 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:44:20 26948 ERROR 2022-03-21 14:44:10.814 KST [27444] FATAL:  database files are incompatible with server", "14:44:20 26948 ERROR 2022-03-21 14:44:10.814 KST [27444] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).", "14:44:20 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:44:20 26944 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:44:20 26944 INFO  Restarting service monitor-init", "14:44:20 27617 INFO  Granting connection privileges on 192.168.0.0/24", "14:44:21 27619 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:44:31 27617 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:31 27617 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:31 27617 ERROR Failed to get Postgres pid, see above for details", "14:44:31 27617 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:44:31 27617 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:44:31 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:31 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:31 26948 ERROR Failed to get Postgres pid, see above for details", "14:44:31 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:44:31 26948 ERROR 2022-03-21 14:44:21.509 KST [27619] FATAL:  database files are incompatible with server", "14:44:31 26948 ERROR 2022-03-21 14:44:21.509 KST [27619] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).", "14:44:31 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:44:31 26944 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:44:31 26944 INFO  Restarting service monitor-init", "14:44:31 27792 INFO  Granting connection privileges on 192.168.0.0/24", "14:44:31 27794 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:44:41 27792 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:41 27792 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:41 27792 ERROR Failed to get Postgres pid, see above for details", "14:44:41 27792 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:44:41 27792 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:44:41 26948 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:44:41 26948 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:44:41 26948 ERROR Failed to get Postgres pid, see above for details", "14:44:41 26948 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:44:41 26948 ERROR 2022-03-21 14:44:31.251 KST [27794] FATAL:  database files are incompatible with server", "14:44:41 26948 ERROR 2022-03-21 14:44:31.251 KST [27794] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 11.12 (VMware Postgres 11.12.0).", "14:44:41 26948 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:44:41 26944 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:44:41 26944 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 52 seconds, stopping now", "14:44:41 26948 INFO  Postgres controller service received signal SIGTERM, terminating", "14:44:41 26944 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.", "14:44:41 26944 INFO  Stop pg_autoctl"], "stdout": "", "stdout_lines": []}
2022-03-21 14:44:42,611 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:44:42,631 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:42,648 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:42,658 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:42,669 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 14:44:42,690 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:42,707 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:42,717 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:42,728 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 14:44:42,748 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:42,765 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:42,776 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:42,787 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 14:44:42,807 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:42,825 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:42,838 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:42,849 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:44:42,870 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:42,919 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:42,934 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:42,946 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:44:42,968 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:42,985 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:42,998 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:43,008 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 14:44:43,042 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:43,043 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:43,055 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:43,064 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:44:43,099 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:43,100 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:43,112 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:43,122 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 14:44:43,158 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:43,159 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:43,170 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:43,180 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:44:43,200 p=462 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:44:43,216 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:43,229 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:43,239 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 14:44:43,274 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:43,286 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:49,870 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:44:49,879 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:44:49,915 p=462 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "484728723380.30116",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.236633",
        "end": "2022-03-21 14:44:44.276798",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/484728723380.30116",
        "start": "2022-03-21 14:44:44.040165",
        "started": 1,
        "stderr": "14:44:44 30126 INFO  Using default --ssl-mode \"require\"\n14:44:44 30126 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:44:44 30126 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:44:44 30126 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:44:44 30126 INFO  Started pg_autoctl postgres service with pid 30129\n14:44:44 30129 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:44:44 30126 INFO  Started pg_autoctl node-init service with pid 30130\n14:44:44 30130 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:44:44 30130 INFO  HINT: use `pg_autoctl run` to start the service.\n14:44:44 30126 WARN  pg_autoctl service node-init exited with exit status 0\n14:44:44 30129 INFO  Postgres controller service received signal SIGTERM, terminating\n14:44:44 30126 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:44:44 30126 INFO  Using default --ssl-mode \"require\"",
            "14:44:44 30126 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:44:44 30126 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:44:44 30126 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:44:44 30126 INFO  Started pg_autoctl postgres service with pid 30129",
            "14:44:44 30129 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:44:44 30126 INFO  Started pg_autoctl node-init service with pid 30130",
            "14:44:44 30130 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:44:44 30130 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:44:44 30126 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:44:44 30129 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:44:44 30126 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 14:44:49,916 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:49,926 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:49,937 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 14:44:49,970 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:49,980 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:56,265 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:44:56,273 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:44:56,312 p=462 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "959229850031.30503",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031428",
        "end": "2022-03-21 14:44:50.611442",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/959229850031.30503",
        "start": "2022-03-21 14:44:50.580014",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:44:56,312 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:56,325 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:56,336 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 14:44:56,411 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:56,426 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:56,957 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:44:56,969 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 14:44:57,008 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:57,021 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:58,186 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:44:58,199 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:44:58,236 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:58,247 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:44:59,171 p=462 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:44:59,184 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 14:44:59,219 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:44:59,230 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:45:01,191 p=462 u=moonja n=ansible | fatal: [co7-node01]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:01.508777", "end": "2022-03-21 14:45:01.163661", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:44:59.654884", "stderr": "14:44:59 31327 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:45:01 31327 ERROR Connection to database failed: could not connect to server: Connection refused\n14:45:01 31327 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:45:01 31327 ERROR \tTCP/IP connections on port 5432?\n14:45:01 31327 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 19 attempts in 2 seconds, pg_autoctl stops retrying now\n14:45:01 31327 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:44:59 31327 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:45:01 31327 ERROR Connection to database failed: could not connect to server: Connection refused", "14:45:01 31327 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:45:01 31327 ERROR \tTCP/IP connections on port 5432?", "14:45:01 31327 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 19 attempts in 2 seconds, pg_autoctl stops retrying now", "14:45:01 31327 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:45:01,202 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:45:01,225 p=462 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:45:01,238 p=462 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:45:01,247 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 14:45:07,944 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:45:07,945 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:45:07,955 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:45:07,981 p=462 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "646272782483.29243",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.640076",
        "end": "2022-03-21 14:45:02.690149",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/646272782483.29243",
        "start": "2022-03-21 14:45:02.050073",
        "started": 1,
        "stderr": "14:45:02 29253 INFO  Using default --ssl-mode \"require\"\n14:45:02 29253 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:45:02 29253 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:45:02 29253 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:45:02 29253 INFO  Started pg_autoctl postgres service with pid 29256\n14:45:02 29253 INFO  Started pg_autoctl node-init service with pid 29257\n14:45:02 29256 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:45:02 29257 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:45:02 29257 INFO  HINT: use `pg_autoctl run` to start the service.\n14:45:02 29253 WARN  pg_autoctl service node-init exited with exit status 0\n14:45:02 29256 INFO  Postgres controller service received signal SIGTERM, terminating\n14:45:02 29253 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:45:02 29253 INFO  Using default --ssl-mode \"require\"",
            "14:45:02 29253 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:45:02 29253 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:45:02 29253 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:45:02 29253 INFO  Started pg_autoctl postgres service with pid 29256",
            "14:45:02 29253 INFO  Started pg_autoctl node-init service with pid 29257",
            "14:45:02 29256 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:45:02 29257 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:45:02 29257 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:45:02 29253 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:45:02 29256 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:45:02 29253 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 14:45:07,994 p=462 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "81485327823.28657",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.540918",
        "end": "2022-03-21 14:45:02.595429",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/81485327823.28657",
        "start": "2022-03-21 14:45:02.054511",
        "started": 1,
        "stderr": "14:45:02 28667 INFO  Using default --ssl-mode \"require\"\n14:45:02 28667 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:45:02 28667 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:45:02 28667 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:45:02 28667 INFO  Started pg_autoctl postgres service with pid 28670\n14:45:02 28667 INFO  Started pg_autoctl node-init service with pid 28671\n14:45:02 28670 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:45:02 28671 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:45:02 28671 INFO  HINT: use `pg_autoctl run` to start the service.\n14:45:02 28667 WARN  pg_autoctl service node-init exited with exit status 0\n14:45:02 28670 INFO  Postgres controller service received signal SIGTERM, terminating\n14:45:02 28667 INFO  Waiting for subprocesses to terminate.\n14:45:02 28667 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:45:02 28667 INFO  Using default --ssl-mode \"require\"",
            "14:45:02 28667 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:45:02 28667 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:45:02 28667 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:45:02 28667 INFO  Started pg_autoctl postgres service with pid 28670",
            "14:45:02 28667 INFO  Started pg_autoctl node-init service with pid 28671",
            "14:45:02 28670 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:45:02 28671 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:45:02 28671 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:45:02 28667 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:45:02 28670 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:45:02 28667 INFO  Waiting for subprocesses to terminate.",
            "14:45:02 28667 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 14:45:08,005 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 14:45:14,456 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:45:14,456 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:45:14,466 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:45:14,493 p=462 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "662536546262.29622",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.033874",
        "end": "2022-03-21 14:45:08.606978",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/662536546262.29622",
        "start": "2022-03-21 14:45:08.573104",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:45:14,506 p=462 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "736245661161.29036",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.037035",
        "end": "2022-03-21 14:45:08.622028",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/736245661161.29036",
        "start": "2022-03-21 14:45:08.584993",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:45:14,517 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 14:45:15,072 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:45:15,072 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:45:15,083 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 14:45:16,136 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:45:16,141 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:45:16,151 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:45:16,683 p=462 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:45:16,683 p=462 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:45:16,694 p=462 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 14:45:19,711 p=462 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.514285", "end": "2022-03-21 14:45:19.674501", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:45:17.160216", "stderr": "14:45:17 29861 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:45:19 29861 ERROR Connection to database failed: could not connect to server: Connection refused\n14:45:19 29861 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:45:19 29861 ERROR \tTCP/IP connections on port 5432?\n14:45:19 29861 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 22 attempts in 2 seconds, pg_autoctl stops retrying now\n14:45:19 29861 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:45:17 29861 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:45:19 29861 ERROR Connection to database failed: could not connect to server: Connection refused", "14:45:19 29861 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:45:19 29861 ERROR \tTCP/IP connections on port 5432?", "14:45:19 29861 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 22 attempts in 2 seconds, pg_autoctl stops retrying now", "14:45:19 29861 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:45:19,712 p=462 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.515451", "end": "2022-03-21 14:45:19.672457", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:45:17.157006", "stderr": "14:45:17 30446 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:45:19 30446 ERROR Connection to database failed: could not connect to server: Connection refused\n14:45:19 30446 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:45:19 30446 ERROR \tTCP/IP connections on port 5432?\n14:45:19 30446 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 22 attempts in 2 seconds, pg_autoctl stops retrying now\n14:45:19 30446 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:45:17 30446 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:45:19 30446 ERROR Connection to database failed: could not connect to server: Connection refused", "14:45:19 30446 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:45:19 30446 ERROR \tTCP/IP connections on port 5432?", "14:45:19 30446 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 22 attempts in 2 seconds, pg_autoctl stops retrying now", "14:45:19 30446 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:45:19,714 p=462 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 14:45:19,714 p=462 u=moonja n=ansible | co7-master                 : ok=16   changed=8    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2022-03-21 14:45:19,714 p=462 u=moonja n=ansible | co7-node01                 : ok=19   changed=11   unreachable=0    failed=1    skipped=16   rescued=0    ignored=0   
2022-03-21 14:45:19,714 p=462 u=moonja n=ansible | co7-node02                 : ok=19   changed=11   unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 14:45:19,714 p=462 u=moonja n=ansible | co7-node03                 : ok=19   changed=11   unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 14:52:50,797 p=4748 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:52:51,049 p=4748 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:52:51,054 p=4748 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 14:52:51,104 p=4748 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 14:52:51,118 p=4748 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 14:52:51,149 p=4748 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 14:52:53,573 p=4748 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:52:53,631 p=4748 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:52:53,657 p=4748 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:52:53,692 p=4748 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:52:53,709 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 14:52:54,614 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 14:52:54,626 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 14:52:54,628 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 14:52:54,658 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 14:52:54,669 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 14:52:55,387 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 14:52:55,404 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 14:52:55,411 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 14:52:55,419 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 14:52:56,010 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 14:52:56,057 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 14:52:56,083 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 14:52:56,083 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 14:52:56,644 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 14:52:56,667 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 14:52:56,696 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 14:52:56,719 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 14:52:57,261 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 14:52:57,306 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 14:52:57,307 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 14:52:57,338 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 14:52:57,350 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 14:52:59,341 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:52:59,344 p=4748 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:52:59,349 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:52:59,361 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:52:59,371 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 14:53:00,961 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:53:00,973 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:53:00,976 p=4748 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:53:00,976 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:53:00,986 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:53:01,031 p=4748 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:53:01,032 p=4748 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:53:01,042 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:01,923 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:53:01,933 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:53:01,981 p=4748 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:53:01,981 p=4748 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:53:01,992 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:02,542 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:53:02,552 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 14:53:03,257 p=4748 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:53:03,260 p=4748 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:53:03,385 p=4748 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:53:03,385 p=4748 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:53:03,395 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 14:53:03,447 p=4748 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:53:03,484 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:04,375 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:53:04,376 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:53:04,387 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 14:53:04,407 p=4748 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:53:04,423 p=4748 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:53:05,100 p=4748 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:53:05,100 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:53:05,110 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 14:53:05,144 p=4748 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:53:05,158 p=4748 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:53:05,871 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:53:05,897 p=4748 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:53:05,909 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 14:53:05,931 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:05,932 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:05,936 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:05,940 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:05,940 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:05,947 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:05,949 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:05,952 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:05,954 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:05,955 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:06,727 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:53:06,728 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:53:07,165 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:53:07,166 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:53:07,581 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:53:07,581 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:53:08,068 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 14:53:08,070 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 14:53:08,544 p=4748 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:53:08,544 p=4748 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:53:08,557 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 14:53:08,576 p=4748 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:53:08,607 p=4748 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:53:08,617 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:09,124 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:53:09,133 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 14:53:09,153 p=4748 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:53:09,183 p=4748 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:53:09,194 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:09,893 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:53:09,902 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 14:53:09,925 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:09,926 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:09,929 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:09,933 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:09,934 p=4748 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:09,959 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:09,959 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:09,962 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:09,965 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:09,965 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:09,971 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:09,977 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:09,977 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:09,978 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:09,979 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:10,467 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:53:10,887 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:53:11,401 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:53:11,832 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 14:53:12,351 p=4748 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:53:12,374 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 14:53:12,423 p=4748 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:53:12,442 p=4748 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:53:12,456 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:12,818 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:53:12,841 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 14:53:12,893 p=4748 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:53:12,914 p=4748 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:53:12,926 p=4748 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:53:13,601 p=4748 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 14:53:13,610 p=4748 u=moonja n=ansible | ...ignoring
2022-03-21 14:53:13,621 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 14:53:13,680 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:13,698 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:13,698 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:13,699 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:13,720 p=4748 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:13,740 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:13,741 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:13,759 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:13,759 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:13,760 p=4748 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:13,779 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 14:53:13,780 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 14:53:13,799 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 14:53:13,799 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 14:53:13,800 p=4748 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 14:53:14,237 p=4748 u=moonja n=ansible | ok: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 14:53:14,889 p=4748 u=moonja n=ansible | ok: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 14:53:15,400 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 14:53:15,828 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 14:53:16,388 p=4748 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 14:53:16,419 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 14:53:49,377 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:53:51,277 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:53:51,293 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:53:51,951 p=4748 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:53:51,969 p=4748 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 14:53:52,422 p=4748 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:53:52,436 p=4748 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:53:52,444 p=4748 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:53:52,467 p=4748 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:53:52,512 p=4748 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 14:53:52,512 p=4748 u=moonja n=ansible | co7-master                 : ok=13   changed=10   unreachable=0    failed=0    skipped=7    rescued=0    ignored=1   
2022-03-21 14:53:52,513 p=4748 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 14:53:52,513 p=4748 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 14:53:52,513 p=4748 u=moonja n=ansible | co7-node03                 : ok=11   changed=9    unreachable=0    failed=0    skipped=9    rescued=0    ignored=0   
2022-03-21 14:54:52,640 p=6243 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:54:52,890 p=6243 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 14:54:52,895 p=6243 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 14:54:52,943 p=6243 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 14:54:52,956 p=6243 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 14:54:52,985 p=6243 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 14:54:55,202 p=6243 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:54:55,238 p=6243 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:54:55,274 p=6243 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:54:55,311 p=6243 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:54:55,332 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 14:54:56,380 p=6243 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 14:54:56,414 p=6243 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 14:54:56,427 p=6243 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 14:54:56,429 p=6243 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 14:54:57,115 p=6243 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 14:54:57,131 p=6243 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 14:54:57,137 p=6243 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 14:54:57,168 p=6243 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 14:54:58,007 p=6243 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 14:54:58,015 p=6243 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 14:54:58,019 p=6243 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 14:54:58,045 p=6243 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 14:54:58,057 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 14:54:59,329 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:54:59,339 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:54:59,340 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:54:59,360 p=6243 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:54:59,371 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 14:55:00,262 p=6243 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 14:55:00,269 p=6243 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 14:55:00,273 p=6243 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 14:55:00,538 p=6243 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 14:55:00,551 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 14:55:01,214 p=6243 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 14:55:01,245 p=6243 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 14:55:01,260 p=6243 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 14:55:01,261 p=6243 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 14:55:01,839 p=6243 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 14:55:01,855 p=6243 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 14:55:01,870 p=6243 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 14:55:01,886 p=6243 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 14:55:02,441 p=6243 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 14:55:02,465 p=6243 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 14:55:02,485 p=6243 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 14:55:02,488 p=6243 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 14:55:03,083 p=6243 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 14:55:03,108 p=6243 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 14:55:03,120 p=6243 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 14:55:03,180 p=6243 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 14:55:03,191 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 14:55:04,860 p=6243 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:55:04,873 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:55:04,902 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:55:04,903 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:55:04,914 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 14:55:06,294 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:55:06,295 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:55:06,511 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:55:06,741 p=6243 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:55:06,753 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 14:55:13,446 p=6243 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 14:55:13,496 p=6243 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 14:55:13,496 p=6243 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 14:55:13,504 p=6243 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 14:55:19,662 p=6243 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 14:55:19,696 p=6243 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 14:55:19,708 p=6243 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 14:55:19,709 p=6243 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 14:55:19,719 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 14:55:45,296 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:55:47,575 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:55:49,221 p=6243 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:55:49,855 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:55:49,864 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:55:49,898 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:55:49,912 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:55:49,924 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:55:50,606 p=6243 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 14:55:50,606 p=6243 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:55:50,618 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:55:50,654 p=6243 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 10.17 (VMware Postgres 10.17.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 14:55:50,670 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:55:50,671 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:55:50,683 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:55:50,693 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 14:55:50,765 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:55:50,782 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:55:50,793 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:55:51,236 p=6243 u=moonja n=ansible | changed: [co7-master]
2022-03-21 14:55:51,246 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:55:51,281 p=6243 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 10.17 (VMware Postgres 10.17.0)"
}
2022-03-21 14:55:51,296 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:55:51,296 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:55:51,308 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:55:51,317 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 14:55:51,986 p=6243 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 14:55:51,989 p=6243 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 14:55:52,001 p=6243 u=moonja n=ansible | ok: [co7-master]
2022-03-21 14:55:52,008 p=6243 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 14:55:52,018 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 14:55:52,063 p=6243 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:55:52,074 p=6243 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:55:52,083 p=6243 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:55:52,098 p=6243 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 14:55:52,108 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 14:55:52,153 p=6243 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 14:55:52,157 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:55:52,171 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:55:52,188 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:55:52,197 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:55:52,231 p=6243 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:55:52,247 p=6243 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:55:52,249 p=6243 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:55:52,260 p=6243 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 14:55:52,269 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 14:55:52,312 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:55:52,313 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:55:52,324 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,151 p=6243 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"ansible_job_id": "771070428742.3367", "changed": true, "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )", "delta": "0:01:01.374478", "end": "2022-03-21 14:56:54.311127", "finished": 1, "msg": "non-zero return code", "rc": 12, "results_file": "/var/lib/pgsql/.ansible_async/771070428742.3367", "start": "2022-03-21 14:55:52.936649", "started": 1, "stderr": "14:55:52 3377 INFO  Using default --ssl-mode \"require\"\n14:55:52 3377 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:55:52 3377 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:55:52 3377 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:55:52 3377 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n14:55:53 3377 INFO  Started pg_autoctl postgres service with pid 3381\n14:55:53 3381 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n14:55:53 3377 INFO  Started pg_autoctl monitor-init service with pid 3382\n14:55:53 3382 INFO  Granting connection privileges on 192.168.0.0/24\n14:55:53 3386 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:56:03 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:03 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:03 3381 ERROR Failed to get Postgres pid, see above for details\n14:56:03 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:56:03 3381 ERROR 2022-03-21 14:55:53.471 KST [3386] FATAL:  database files are incompatible with server\n14:56:03 3381 ERROR 2022-03-21 14:55:53.471 KST [3386] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n14:56:03 3382 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:03 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:56:03 3382 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:03 3382 ERROR Failed to get Postgres pid, see above for details\n14:56:03 3382 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:56:03 3382 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:56:03 3377 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:56:03 3377 INFO  Restarting service monitor-init\n14:56:03 3518 INFO  Granting connection privileges on 192.168.0.0/24\n14:56:04 3604 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:56:14 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:14 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:14 3381 ERROR Failed to get Postgres pid, see above for details\n14:56:14 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:56:14 3381 ERROR 2022-03-21 14:56:04.919 KST [3604] FATAL:  database files are incompatible with server\n14:56:14 3381 ERROR 2022-03-21 14:56:04.919 KST [3604] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n14:56:14 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:56:14 3518 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:14 3518 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:14 3518 ERROR Failed to get Postgres pid, see above for details\n14:56:14 3518 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:56:14 3518 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:56:14 3377 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:56:14 3377 INFO  Restarting service monitor-init\n14:56:14 3693 INFO  Granting connection privileges on 192.168.0.0/24\n14:56:14 3695 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:56:24 3693 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:24 3693 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:24 3693 ERROR Failed to get Postgres pid, see above for details\n14:56:24 3693 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:56:24 3693 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:56:24 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:24 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:24 3381 ERROR Failed to get Postgres pid, see above for details\n14:56:24 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:56:24 3381 ERROR 2022-03-21 14:56:14.348 KST [3695] FATAL:  database files are incompatible with server\n14:56:24 3381 ERROR 2022-03-21 14:56:14.348 KST [3695] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n14:56:24 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:56:24 3377 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:56:24 3377 INFO  Restarting service monitor-init\n14:56:24 3868 INFO  Granting connection privileges on 192.168.0.0/24\n14:56:24 3870 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:56:34 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:34 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:34 3381 ERROR Failed to get Postgres pid, see above for details\n14:56:34 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:56:34 3381 ERROR 2022-03-21 14:56:24.285 KST [3870] FATAL:  database files are incompatible with server\n14:56:34 3381 ERROR 2022-03-21 14:56:24.285 KST [3870] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n14:56:34 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:56:34 3868 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:34 3868 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:34 3868 ERROR Failed to get Postgres pid, see above for details\n14:56:34 3868 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:56:34 3868 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:56:34 3377 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:56:34 3377 INFO  Restarting service monitor-init\n14:56:34 4043 INFO  Granting connection privileges on 192.168.0.0/24\n14:56:34 4045 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:56:44 4043 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:44 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:44 4043 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:44 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:44 4043 ERROR Failed to get Postgres pid, see above for details\n14:56:44 3381 ERROR Failed to get Postgres pid, see above for details\n14:56:44 4043 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:56:44 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:56:44 4043 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:56:44 3381 ERROR 2022-03-21 14:56:34.487 KST [4045] FATAL:  database files are incompatible with server\n14:56:44 3381 ERROR 2022-03-21 14:56:34.487 KST [4045] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n14:56:44 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:56:44 3377 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:56:44 3377 INFO  Restarting service monitor-init\n14:56:44 4226 INFO  Granting connection privileges on 192.168.0.0/24\n14:56:44 4228 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n14:56:54 4226 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:54 4226 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:54 4226 ERROR Failed to get Postgres pid, see above for details\n14:56:54 4226 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n14:56:54 4226 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n14:56:54 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n14:56:54 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n14:56:54 3381 ERROR Failed to get Postgres pid, see above for details\n14:56:54 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n14:56:54 3381 ERROR 2022-03-21 14:56:44.243 KST [4228] FATAL:  database files are incompatible with server\n14:56:54 3381 ERROR 2022-03-21 14:56:44.243 KST [4228] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n14:56:54 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n14:56:54 3377 ERROR pg_autoctl service monitor-init exited with exit status 12\n14:56:54 3377 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 51 seconds, stopping now\n14:56:54 3381 INFO  Postgres controller service received signal SIGTERM, terminating\n14:56:54 3377 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.\n14:56:54 3377 INFO  Stop pg_autoctl", "stderr_lines": ["14:55:52 3377 INFO  Using default --ssl-mode \"require\"", "14:55:52 3377 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic", "14:55:52 3377 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.", "14:55:52 3377 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details", "14:55:52 3377 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"", "14:55:53 3377 INFO  Started pg_autoctl postgres service with pid 3381", "14:55:53 3381 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v", "14:55:53 3377 INFO  Started pg_autoctl monitor-init service with pid 3382", "14:55:53 3382 INFO  Granting connection privileges on 192.168.0.0/24", "14:55:53 3386 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:56:03 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:03 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:03 3381 ERROR Failed to get Postgres pid, see above for details", "14:56:03 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:56:03 3381 ERROR 2022-03-21 14:55:53.471 KST [3386] FATAL:  database files are incompatible with server", "14:56:03 3381 ERROR 2022-03-21 14:55:53.471 KST [3386] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "14:56:03 3382 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:03 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:56:03 3382 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:03 3382 ERROR Failed to get Postgres pid, see above for details", "14:56:03 3382 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:56:03 3382 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:56:03 3377 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:56:03 3377 INFO  Restarting service monitor-init", "14:56:03 3518 INFO  Granting connection privileges on 192.168.0.0/24", "14:56:04 3604 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:56:14 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:14 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:14 3381 ERROR Failed to get Postgres pid, see above for details", "14:56:14 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:56:14 3381 ERROR 2022-03-21 14:56:04.919 KST [3604] FATAL:  database files are incompatible with server", "14:56:14 3381 ERROR 2022-03-21 14:56:04.919 KST [3604] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "14:56:14 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:56:14 3518 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:14 3518 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:14 3518 ERROR Failed to get Postgres pid, see above for details", "14:56:14 3518 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:56:14 3518 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:56:14 3377 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:56:14 3377 INFO  Restarting service monitor-init", "14:56:14 3693 INFO  Granting connection privileges on 192.168.0.0/24", "14:56:14 3695 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:56:24 3693 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:24 3693 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:24 3693 ERROR Failed to get Postgres pid, see above for details", "14:56:24 3693 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:56:24 3693 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:56:24 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:24 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:24 3381 ERROR Failed to get Postgres pid, see above for details", "14:56:24 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:56:24 3381 ERROR 2022-03-21 14:56:14.348 KST [3695] FATAL:  database files are incompatible with server", "14:56:24 3381 ERROR 2022-03-21 14:56:14.348 KST [3695] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "14:56:24 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:56:24 3377 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:56:24 3377 INFO  Restarting service monitor-init", "14:56:24 3868 INFO  Granting connection privileges on 192.168.0.0/24", "14:56:24 3870 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:56:34 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:34 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:34 3381 ERROR Failed to get Postgres pid, see above for details", "14:56:34 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:56:34 3381 ERROR 2022-03-21 14:56:24.285 KST [3870] FATAL:  database files are incompatible with server", "14:56:34 3381 ERROR 2022-03-21 14:56:24.285 KST [3870] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "14:56:34 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:56:34 3868 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:34 3868 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:34 3868 ERROR Failed to get Postgres pid, see above for details", "14:56:34 3868 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:56:34 3868 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:56:34 3377 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:56:34 3377 INFO  Restarting service monitor-init", "14:56:34 4043 INFO  Granting connection privileges on 192.168.0.0/24", "14:56:34 4045 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:56:44 4043 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:44 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:44 4043 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:44 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:44 4043 ERROR Failed to get Postgres pid, see above for details", "14:56:44 3381 ERROR Failed to get Postgres pid, see above for details", "14:56:44 4043 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:56:44 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:56:44 4043 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:56:44 3381 ERROR 2022-03-21 14:56:34.487 KST [4045] FATAL:  database files are incompatible with server", "14:56:44 3381 ERROR 2022-03-21 14:56:34.487 KST [4045] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "14:56:44 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:56:44 3377 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:56:44 3377 INFO  Restarting service monitor-init", "14:56:44 4226 INFO  Granting connection privileges on 192.168.0.0/24", "14:56:44 4228 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "14:56:54 4226 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:54 4226 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:54 4226 ERROR Failed to get Postgres pid, see above for details", "14:56:54 4226 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "14:56:54 4226 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "14:56:54 3381 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "14:56:54 3381 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "14:56:54 3381 ERROR Failed to get Postgres pid, see above for details", "14:56:54 3381 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "14:56:54 3381 ERROR 2022-03-21 14:56:44.243 KST [4228] FATAL:  database files are incompatible with server", "14:56:54 3381 ERROR 2022-03-21 14:56:44.243 KST [4228] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "14:56:54 3381 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "14:56:54 3377 ERROR pg_autoctl service monitor-init exited with exit status 12", "14:56:54 3377 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 51 seconds, stopping now", "14:56:54 3381 INFO  Postgres controller service received signal SIGTERM, terminating", "14:56:54 3377 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.", "14:56:54 3377 INFO  Stop pg_autoctl"], "stdout": "", "stdout_lines": []}
2022-03-21 14:56:55,159 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:56:55,179 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,195 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,207 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,216 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 14:56:55,236 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,253 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,266 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,275 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 14:56:55,310 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,311 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,323 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,334 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 14:56:55,399 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,400 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,413 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,423 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:56:55,443 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,460 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,470 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,480 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:56:55,500 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,517 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,528 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,538 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 14:56:55,558 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,574 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,584 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,595 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:56:55,628 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,630 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,640 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,650 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 14:56:55,683 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,685 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,693 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,704 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:56:55,723 p=6243 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 14:56:55,740 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,750 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:56:55,760 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 14:56:55,791 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:56:55,803 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:02,511 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:57:02,519 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:57:02,554 p=6243 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "84257077516.7056",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.236752",
        "end": "2022-03-21 14:56:56.804036",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/84257077516.7056",
        "start": "2022-03-21 14:56:56.567284",
        "started": 1,
        "stderr": "14:56:56 7066 INFO  Using default --ssl-mode \"require\"\n14:56:56 7066 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:56:56 7066 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:56:56 7066 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:56:56 7066 INFO  Started pg_autoctl postgres service with pid 7069\n14:56:56 7066 INFO  Started pg_autoctl node-init service with pid 7070\n14:56:56 7069 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:56:56 7070 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:56:56 7070 INFO  HINT: use `pg_autoctl run` to start the service.\n14:56:56 7066 WARN  pg_autoctl service node-init exited with exit status 0\n14:56:56 7069 INFO  Postgres controller service received signal SIGTERM, terminating\n14:56:56 7066 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:56:56 7066 INFO  Using default --ssl-mode \"require\"",
            "14:56:56 7066 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:56:56 7066 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:56:56 7066 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:56:56 7066 INFO  Started pg_autoctl postgres service with pid 7069",
            "14:56:56 7066 INFO  Started pg_autoctl node-init service with pid 7070",
            "14:56:56 7069 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:56:56 7070 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:56:56 7070 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:56:56 7066 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:56:56 7069 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:56:56 7066 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 14:57:02,554 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:02,563 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:02,573 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 14:57:02,605 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:02,615 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:08,886 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:57:08,898 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:57:08,950 p=6243 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "886843836197.7436",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032611",
        "end": "2022-03-21 14:57:03.266663",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/886843836197.7436",
        "start": "2022-03-21 14:57:03.234052",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:57:08,951 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:08,967 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:08,978 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 14:57:09,014 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:09,025 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:09,449 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:57:09,460 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 14:57:09,499 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:09,511 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:10,590 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:57:10,623 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:57:10,699 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:10,711 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:11,563 p=6243 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 14:57:11,574 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 14:57:11,608 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:11,619 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:14,506 p=6243 u=moonja n=ansible | fatal: [co7-node01]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.454614", "end": "2022-03-21 14:57:14.523715", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:57:12.069101", "stderr": "14:57:12 8260 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:57:14 8260 ERROR Connection to database failed: could not connect to server: Connection refused\n14:57:14 8260 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:57:14 8260 ERROR \tTCP/IP connections on port 5432?\n14:57:14 8260 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 26 attempts in 2 seconds, pg_autoctl stops retrying now\n14:57:14 8260 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:57:12 8260 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:57:14 8260 ERROR Connection to database failed: could not connect to server: Connection refused", "14:57:14 8260 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:57:14 8260 ERROR \tTCP/IP connections on port 5432?", "14:57:14 8260 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 26 attempts in 2 seconds, pg_autoctl stops retrying now", "14:57:14 8260 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:57:14,516 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:57:14,535 p=6243 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 14:57:14,544 p=6243 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 14:57:14,554 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 14:57:21,134 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:57:21,135 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:57:21,143 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:57:21,167 p=6243 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "409677627999.6199",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.828655",
        "end": "2022-03-21 14:57:16.209703",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/409677627999.6199",
        "start": "2022-03-21 14:57:15.381048",
        "started": 1,
        "stderr": "14:57:15 6209 INFO  Using default --ssl-mode \"require\"\n14:57:15 6209 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:57:15 6209 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:57:15 6209 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:57:15 6209 INFO  Started pg_autoctl postgres service with pid 6212\n14:57:15 6212 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:57:15 6209 INFO  Started pg_autoctl node-init service with pid 6213\n14:57:15 6213 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:57:15 6213 INFO  HINT: use `pg_autoctl run` to start the service.\n14:57:15 6209 WARN  pg_autoctl service node-init exited with exit status 0\n14:57:15 6212 INFO  Postgres controller service received signal SIGTERM, terminating\n14:57:15 6209 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:57:15 6209 INFO  Using default --ssl-mode \"require\"",
            "14:57:15 6209 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:57:15 6209 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:57:15 6209 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:57:15 6209 INFO  Started pg_autoctl postgres service with pid 6212",
            "14:57:15 6212 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:57:15 6209 INFO  Started pg_autoctl node-init service with pid 6213",
            "14:57:15 6213 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:57:15 6213 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:57:15 6209 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:57:15 6212 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:57:15 6209 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 14:57:21,180 p=6243 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "862670250387.5388",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.239500",
        "end": "2022-03-21 14:57:15.622472",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/862670250387.5388",
        "start": "2022-03-21 14:57:15.382972",
        "started": 1,
        "stderr": "14:57:15 5398 INFO  Using default --ssl-mode \"require\"\n14:57:15 5398 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n14:57:15 5398 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n14:57:15 5398 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n14:57:15 5398 INFO  Started pg_autoctl postgres service with pid 5401\n14:57:15 5401 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n14:57:15 5398 INFO  Started pg_autoctl node-init service with pid 5402\n14:57:15 5402 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n14:57:15 5402 INFO  HINT: use `pg_autoctl run` to start the service.\n14:57:15 5398 WARN  pg_autoctl service node-init exited with exit status 0\n14:57:15 5401 INFO  Postgres controller service received signal SIGTERM, terminating\n14:57:15 5398 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "14:57:15 5398 INFO  Using default --ssl-mode \"require\"",
            "14:57:15 5398 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "14:57:15 5398 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "14:57:15 5398 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "14:57:15 5398 INFO  Started pg_autoctl postgres service with pid 5401",
            "14:57:15 5401 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "14:57:15 5398 INFO  Started pg_autoctl node-init service with pid 5402",
            "14:57:15 5402 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "14:57:15 5402 INFO  HINT: use `pg_autoctl run` to start the service.",
            "14:57:15 5398 WARN  pg_autoctl service node-init exited with exit status 0",
            "14:57:15 5401 INFO  Postgres controller service received signal SIGTERM, terminating",
            "14:57:15 5398 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 14:57:21,191 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 14:57:27,737 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:57:27,737 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:57:27,746 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 14:57:27,769 p=6243 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "276402495157.6578",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032453",
        "end": "2022-03-21 14:57:22.014252",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/276402495157.6578",
        "start": "2022-03-21 14:57:21.981799",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:57:27,781 p=6243 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "501304053455.5767",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032443",
        "end": "2022-03-21 14:57:22.014268",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/501304053455.5767",
        "start": "2022-03-21 14:57:21.981825",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 14:57:27,793 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 14:57:28,291 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:57:28,293 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:57:28,305 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 14:57:29,173 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:57:29,176 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:57:29,187 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 14:57:29,788 p=6243 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 14:57:29,788 p=6243 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 14:57:29,798 p=6243 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 14:57:32,730 p=6243 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.337784", "end": "2022-03-21 14:57:32.632088", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:57:30.294304", "stderr": "14:57:30 6591 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:57:32 6591 ERROR Connection to database failed: could not connect to server: Connection refused\n14:57:32 6591 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:57:32 6591 ERROR \tTCP/IP connections on port 5432?\n14:57:32 6591 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 27 attempts in 2 seconds, pg_autoctl stops retrying now\n14:57:32 6591 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:57:30 6591 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:57:32 6591 ERROR Connection to database failed: could not connect to server: Connection refused", "14:57:32 6591 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:57:32 6591 ERROR \tTCP/IP connections on port 5432?", "14:57:32 6591 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 27 attempts in 2 seconds, pg_autoctl stops retrying now", "14:57:32 6591 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:57:32,731 p=6243 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": true, "cmd": "( source ~/.bash_profile ; pg_autoctl show state )", "delta": "0:00:02.337619", "end": "2022-03-21 14:57:32.632357", "msg": "non-zero return code", "rc": 6, "start": "2022-03-21 14:57:30.294738", "stderr": "14:57:30 7402 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n14:57:32 7402 ERROR Connection to database failed: could not connect to server: Connection refused\n14:57:32 7402 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting\n14:57:32 7402 ERROR \tTCP/IP connections on port 5432?\n14:57:32 7402 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 27 attempts in 2 seconds, pg_autoctl stops retrying now\n14:57:32 7402 ERROR Failed to retrieve current state from the monitor", "stderr_lines": ["14:57:30 7402 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready", "14:57:32 7402 ERROR Connection to database failed: could not connect to server: Connection refused", "14:57:32 7402 ERROR \tIs the server running on host \"co7-master\" (192.168.0.81) and accepting", "14:57:32 7402 ERROR \tTCP/IP connections on port 5432?", "14:57:32 7402 ERROR Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 27 attempts in 2 seconds, pg_autoctl stops retrying now", "14:57:32 7402 ERROR Failed to retrieve current state from the monitor"], "stdout": "", "stdout_lines": []}
2022-03-21 14:57:32,733 p=6243 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 14:57:32,733 p=6243 u=moonja n=ansible | co7-master                 : ok=16   changed=7    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2022-03-21 14:57:32,733 p=6243 u=moonja n=ansible | co7-node01                 : ok=19   changed=11   unreachable=0    failed=1    skipped=16   rescued=0    ignored=0   
2022-03-21 14:57:32,733 p=6243 u=moonja n=ansible | co7-node02                 : ok=19   changed=11   unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 14:57:32,734 p=6243 u=moonja n=ansible | co7-node03                 : ok=19   changed=11   unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:00:52,617 p=10365 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:00:52,848 p=10365 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:00:52,853 p=10365 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:00:52,900 p=10365 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:00:52,915 p=10365 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:00:52,942 p=10365 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:00:55,148 p=10365 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:00:55,215 p=10365 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:00:55,218 p=10365 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:00:55,419 p=10365 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:00:55,435 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 15:00:56,390 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:00:56,391 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:00:56,391 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:00:56,393 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:00:56,402 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 15:00:57,241 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:00:57,254 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:00:57,265 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:00:57,287 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:00:57,858 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:00:57,865 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:00:57,889 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:00:57,901 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:00:58,484 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:00:58,497 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:00:58,514 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:00:58,539 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:00:59,093 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:00:59,170 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:00:59,175 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:00:59,180 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:00:59,190 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:01:01,101 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:01,113 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:01,118 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:01,173 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:01,182 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 15:01:02,720 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:02,733 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:02,748 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:02,757 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:02,767 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:01:02,811 p=10365 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:01:02,811 p=10365 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:01:02,822 p=10365 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:01:03,463 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:03,473 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:01:03,516 p=10365 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:01:03,517 p=10365 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:01:03,528 p=10365 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:01:03,966 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:03,978 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:01:04,679 p=10365 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:01:04,679 p=10365 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:01:04,688 p=10365 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:01:04,690 p=10365 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:01:04,700 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:01:04,774 p=10365 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:01:05,674 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:05,687 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:05,690 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:05,700 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:01:05,719 p=10365 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:01:05,735 p=10365 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:01:06,377 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:06,378 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:06,387 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:01:06,406 p=10365 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:01:06,421 p=10365 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:01:07,143 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:07,163 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:07,172 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 15:01:07,194 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:07,195 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:07,199 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:07,203 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:07,205 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:07,210 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:07,211 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:07,217 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:07,217 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:07,217 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:07,875 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:01:07,876 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:01:08,362 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:01:08,363 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:01:08,877 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:01:08,878 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:01:09,386 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 15:01:09,387 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 15:01:09,855 p=10365 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:01:09,856 p=10365 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:01:09,868 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:01:09,887 p=10365 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:01:09,915 p=10365 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:01:09,926 p=10365 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:01:10,321 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:10,330 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:01:10,349 p=10365 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:01:10,377 p=10365 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:01:10,388 p=10365 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:01:11,129 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:11,139 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:01:11,161 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:11,163 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:11,167 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:11,173 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:11,173 p=10365 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:11,198 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:11,199 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:11,201 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:11,204 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:11,204 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:11,210 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:11,216 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:11,216 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:11,217 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:11,218 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:11,641 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:01:12,075 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:01:12,517 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:01:12,941 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 15:01:13,392 p=10365 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:01:13,403 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:01:13,435 p=10365 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:01:13,450 p=10365 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:01:13,461 p=10365 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:01:13,832 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:13,842 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:01:13,874 p=10365 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:01:13,888 p=10365 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:01:13,899 p=10365 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:01:14,512 p=10365 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:01:14,512 p=10365 u=moonja n=ansible | ...ignoring
2022-03-21 15:01:14,522 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:01:14,559 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:14,560 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:14,563 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:14,566 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:14,567 p=10365 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:14,572 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:14,573 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:14,579 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:14,579 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:14,579 p=10365 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:14,588 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:01:14,593 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:01:14,595 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:01:14,596 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:01:14,596 p=10365 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:01:15,058 p=10365 u=moonja n=ansible | ok: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:01:15,569 p=10365 u=moonja n=ansible | ok: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:01:16,034 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:01:16,544 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 15:01:16,966 p=10365 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:01:16,976 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 15:01:45,419 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:46,521 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:47,029 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:47,893 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:47,903 p=10365 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:01:48,341 p=10365 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:01:48,367 p=10365 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:01:48,375 p=10365 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:01:48,392 p=10365 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:01:48,436 p=10365 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:01:48,436 p=10365 u=moonja n=ansible | co7-master                 : ok=13   changed=10   unreachable=0    failed=0    skipped=7    rescued=0    ignored=1   
2022-03-21 15:01:48,436 p=10365 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:01:48,436 p=10365 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:01:48,437 p=10365 u=moonja n=ansible | co7-node03                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:03:51,675 p=11813 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:03:51,896 p=11813 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:03:51,900 p=11813 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:03:51,960 p=11813 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:03:51,976 p=11813 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:03:52,006 p=11813 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:03:54,186 p=11813 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:03:54,200 p=11813 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:03:54,257 p=11813 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:03:54,308 p=11813 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:03:54,324 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 15:03:55,177 p=11813 u=moonja n=ansible | failed: [co7-node01] (item=5432) => {"ansible_loop_var": "item", "changed": false, "item": "5432", "msg": "firewall is not currently running, unable to perform immediate actions without a running firewall daemon"}
2022-03-21 15:03:55,178 p=11813 u=moonja n=ansible | failed: [co7-node03] (item=5432) => {"ansible_loop_var": "item", "changed": false, "item": "5432", "msg": "firewall is not currently running, unable to perform immediate actions without a running firewall daemon"}
2022-03-21 15:03:55,179 p=11813 u=moonja n=ansible | failed: [co7-master] (item=5432) => {"ansible_loop_var": "item", "changed": false, "item": "5432", "msg": "firewall is not currently running, unable to perform immediate actions without a running firewall daemon"}
2022-03-21 15:03:55,179 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:03:55,179 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:03:55,180 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:03:55,183 p=11813 u=moonja n=ansible | failed: [co7-node02] (item=5432) => {"ansible_loop_var": "item", "changed": false, "item": "5432", "msg": "firewall is not currently running, unable to perform immediate actions without a running firewall daemon"}
2022-03-21 15:03:55,184 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:03:55,193 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 15:03:55,882 p=11813 u=moonja n=ansible | ok: [co7-master] => (item=co7-master)
2022-03-21 15:03:55,883 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=co7-master)
2022-03-21 15:03:55,885 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=co7-master)
2022-03-21 15:03:55,893 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=co7-master)
2022-03-21 15:03:56,433 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node01)
2022-03-21 15:03:56,436 p=11813 u=moonja n=ansible | ok: [co7-master] => (item=co7-node01)
2022-03-21 15:03:56,445 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node01)
2022-03-21 15:03:56,456 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node01)
2022-03-21 15:03:57,004 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node02)
2022-03-21 15:03:57,004 p=11813 u=moonja n=ansible | ok: [co7-master] => (item=co7-node02)
2022-03-21 15:03:57,019 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node02)
2022-03-21 15:03:57,029 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node02)
2022-03-21 15:03:57,553 p=11813 u=moonja n=ansible | ok: [co7-master] => (item=co7-node03)
2022-03-21 15:03:57,557 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node03)
2022-03-21 15:03:57,561 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node03)
2022-03-21 15:03:57,578 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node03)
2022-03-21 15:03:57,589 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:03:58,714 p=11813 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:03:58,737 p=11813 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:03:58,738 p=11813 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:03:58,738 p=11813 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:03:58,749 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 15:04:00,258 p=11813 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:04:00,259 p=11813 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:04:00,267 p=11813 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:04:00,269 p=11813 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:04:00,278 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:04:00,322 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:00,323 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:00,333 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:00,994 p=11813 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 15:04:00,995 p=11813 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": true, "cmd": "( pg_autoctl version )", "delta": "0:00:00.027999", "end": "2022-03-21 15:04:01.132122", "msg": "non-zero return code", "rc": 127, "start": "2022-03-21 15:04:01.104123", "stderr": "/bin/sh: pg_autoctl: command not found", "stderr_lines": ["/bin/sh: pg_autoctl: command not found"], "stdout": "", "stdout_lines": []}
2022-03-21 15:04:00,995 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:04:01,004 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:04:01,035 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:01,049 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:01,061 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:01,513 p=11813 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": true, "cmd": "( pg_ctl -V )", "delta": "0:00:00.027964", "end": "2022-03-21 15:04:01.651868", "msg": "non-zero return code", "rc": 127, "start": "2022-03-21 15:04:01.623904", "stderr": "/bin/sh: pg_ctl: command not found", "stderr_lines": ["/bin/sh: pg_ctl: command not found"], "stdout": "", "stdout_lines": []}
2022-03-21 15:04:01,523 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:04:02,206 p=11813 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:04:02,213 p=11813 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:04:02,213 p=11813 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:04:02,224 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:04:02,259 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:02,272 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:02,288 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:02,298 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:04:02,317 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:03,032 p=11813 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:04:03,033 p=11813 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:04:03,040 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:04:03,059 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:04,018 p=11813 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:04:04,018 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:04:04,019 p=11813 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:04:04,019 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:04:04,029 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 15:04:04,050 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:04:04,052 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:04:04,055 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:04:04,059 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:04:04,060 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:04:04,061 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:04:04,848 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:04:04,849 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:04:05,337 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:04:05,341 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:04:05,738 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:04:05,761 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:04:06,161 p=11813 u=moonja n=ansible | ok: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 15:04:06,172 p=11813 u=moonja n=ansible | ok: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 15:04:06,576 p=11813 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:04:06,578 p=11813 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:04:11,123 p=11813 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 15:04:12,140 p=11813 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 15:04:12,158 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:04:12,191 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:12,202 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:12,609 p=11813 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:04:12,620 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:04:12,653 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:12,664 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:13,232 p=11813 u=moonja n=ansible | fatal: [co7-node01]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:04:13,232 p=11813 u=moonja n=ansible | ...ignoring
2022-03-21 15:04:13,242 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:04:13,280 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:04:13,281 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:04:13,283 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:04:13,285 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:04:13,288 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:04:13,289 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:04:13,291 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:04:13,298 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:04:13,302 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:04:13,302 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:04:13,302 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:04:13,303 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:04:13,757 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:04:14,180 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:04:14,586 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:04:15,016 p=11813 u=moonja n=ansible | ok: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 15:04:15,425 p=11813 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:04:18,827 p=11813 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 15:04:18,846 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:04:18,916 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:18,917 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:18,928 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:18,938 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:04:18,958 p=11813 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:04:18,974 p=11813 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:04:18,987 p=11813 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:04:18,996 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:04:19,018 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:04:19,019 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:04:19,020 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:04:19,023 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:04:19,028 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:04:19,029 p=11813 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:04:19,033 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:04:19,034 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:04:19,036 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:04:19,038 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:04:19,041 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:04:19,041 p=11813 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:04:19,051 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:04:19,054 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:04:19,055 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:04:19,058 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:04:19,060 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:04:19,061 p=11813 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:04:19,072 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 15:04:25,892 p=11813 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:04:26,485 p=11813 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:04:26,640 p=11813 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:04:26,650 p=11813 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:04:27,134 p=11813 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:04:27,136 p=11813 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:04:27,140 p=11813 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:04:27,179 p=11813 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:04:27,179 p=11813 u=moonja n=ansible | co7-master                 : ok=6    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=2   
2022-03-21 15:04:27,179 p=11813 u=moonja n=ansible | co7-node01                 : ok=11   changed=3    unreachable=0    failed=0    skipped=9    rescued=0    ignored=2   
2022-03-21 15:04:27,179 p=11813 u=moonja n=ansible | co7-node02                 : ok=11   changed=3    unreachable=0    failed=0    skipped=9    rescued=0    ignored=2   
2022-03-21 15:04:27,179 p=11813 u=moonja n=ansible | co7-node03                 : ok=11   changed=3    unreachable=0    failed=0    skipped=9    rescued=0    ignored=2   
2022-03-21 15:06:27,738 p=14749 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:06:27,974 p=14749 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:06:27,979 p=14749 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:06:28,025 p=14749 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:06:28,037 p=14749 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:06:28,064 p=14749 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:06:30,260 p=14749 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:06:30,264 p=14749 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:06:30,333 p=14749 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:06:30,400 p=14749 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:06:30,416 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 15:06:31,443 p=14749 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 15:06:31,450 p=14749 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 15:06:31,458 p=14749 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 15:06:31,476 p=14749 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 15:06:32,168 p=14749 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:06:32,192 p=14749 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:06:32,193 p=14749 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:06:32,230 p=14749 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:06:33,030 p=14749 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 15:06:33,066 p=14749 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 15:06:33,080 p=14749 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 15:06:33,110 p=14749 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 15:06:33,122 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 15:06:34,432 p=14749 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:06:34,450 p=14749 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:06:34,463 p=14749 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:06:34,494 p=14749 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:06:34,503 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 15:06:35,435 p=14749 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:06:35,436 p=14749 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:06:35,441 p=14749 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:06:35,442 p=14749 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:06:35,453 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 15:06:36,197 p=14749 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:06:36,200 p=14749 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:06:36,205 p=14749 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:06:36,206 p=14749 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:06:36,799 p=14749 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:06:36,807 p=14749 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:06:36,821 p=14749 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:06:36,822 p=14749 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:06:37,415 p=14749 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:06:37,418 p=14749 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:06:37,420 p=14749 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:06:37,425 p=14749 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:06:38,033 p=14749 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:06:38,044 p=14749 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:06:38,063 p=14749 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:06:38,074 p=14749 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:06:38,084 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:06:39,654 p=14749 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:06:39,655 p=14749 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:06:39,659 p=14749 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:06:39,666 p=14749 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:06:39,676 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:06:41,223 p=14749 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:06:41,246 p=14749 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:06:41,251 p=14749 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:06:41,265 p=14749 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:06:41,275 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 15:06:48,072 p=14749 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 15:06:48,120 p=14749 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 15:06:48,129 p=14749 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 15:06:48,163 p=14749 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 15:06:54,323 p=14749 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:06:54,389 p=14749 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:06:54,417 p=14749 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:06:54,425 p=14749 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:06:54,434 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 15:07:26,355 p=14749 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:07:28,929 p=14749 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:07:28,944 p=14749 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:07:29,268 p=14749 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:07:29,278 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:07:29,312 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:07:29,328 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:07:29,340 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:07:30,091 p=14749 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:07:30,102 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:07:30,140 p=14749 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 10.17 (VMware Postgres 10.17.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 15:07:30,160 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:07:30,161 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:07:30,174 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:07:30,184 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:07:30,220 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:07:30,234 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:07:30,248 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:07:30,856 p=14749 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:07:30,865 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:07:30,903 p=14749 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 10.17 (VMware Postgres 10.17.0)"
}
2022-03-21 15:07:30,919 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:07:30,920 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:07:30,936 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:07:30,946 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:07:31,701 p=14749 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:07:31,703 p=14749 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:07:31,704 p=14749 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:07:31,708 p=14749 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:07:31,717 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 15:07:31,765 p=14749 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:07:31,773 p=14749 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:07:31,787 p=14749 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:07:31,803 p=14749 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:07:31,814 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:07:31,863 p=14749 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:07:31,868 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:07:31,882 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:07:31,898 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:07:31,908 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:07:31,945 p=14749 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:07:31,964 p=14749 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:07:31,965 p=14749 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:07:31,976 p=14749 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:07:31,987 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 15:07:32,020 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:07:32,034 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:07:32,047 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:42,647 p=14749 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"ansible_job_id": "37880792226.13919", "changed": true, "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )", "delta": "0:01:09.467017", "end": "2022-03-21 15:08:42.239561", "finished": 1, "msg": "non-zero return code", "rc": 12, "results_file": "/var/lib/pgsql/.ansible_async/37880792226.13919", "start": "2022-03-21 15:07:32.772544", "started": 1, "stderr": "15:07:32 13929 INFO  Using default --ssl-mode \"require\"\n15:07:32 13929 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:07:32 13929 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:07:32 13929 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:07:32 13929 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n15:07:32 13929 INFO  Started pg_autoctl postgres service with pid 13933\n15:07:32 13933 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n15:07:32 13929 INFO  Started pg_autoctl monitor-init service with pid 13934\n15:07:32 13934 INFO  Granting connection privileges on 192.168.0.0/24\n15:07:32 13938 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:07:42 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:07:42 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:07:42 13934 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:07:42 13933 ERROR Failed to get Postgres pid, see above for details\n15:07:42 13934 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:07:42 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:07:42 13934 ERROR Failed to get Postgres pid, see above for details\n15:07:42 13933 ERROR 2022-03-21 15:07:32.883 KST [13938] FATAL:  database files are incompatible with server\n15:07:42 13934 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n15:07:42 13933 ERROR 2022-03-21 15:07:32.883 KST [13938] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:07:42 13934 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n15:07:42 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:07:42 13929 ERROR pg_autoctl service monitor-init exited with exit status 12\n15:07:42 13929 INFO  Restarting service monitor-init\n15:07:42 14069 INFO  Granting connection privileges on 192.168.0.0/24\n15:07:42 14071 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:07:52 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:07:52 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:07:52 13933 ERROR Failed to get Postgres pid, see above for details\n15:07:52 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:07:52 13933 ERROR 2022-03-21 15:07:42.295 KST [14071] FATAL:  database files are incompatible with server\n15:07:52 13933 ERROR 2022-03-21 15:07:42.295 KST [14071] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:07:52 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:07:52 14069 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:07:52 14069 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:07:52 14069 ERROR Failed to get Postgres pid, see above for details\n15:07:52 14069 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n15:07:52 14069 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n15:07:52 13929 ERROR pg_autoctl service monitor-init exited with exit status 12\n15:07:52 13929 INFO  Restarting service monitor-init\n15:07:52 14253 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:07:52 14252 INFO  Granting connection privileges on 192.168.0.0/24\n15:08:02 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:02 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:02 13933 ERROR Failed to get Postgres pid, see above for details\n15:08:02 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:08:02 13933 ERROR 2022-03-21 15:07:52.237 KST [14253] FATAL:  database files are incompatible with server\n15:08:02 13933 ERROR 2022-03-21 15:07:52.237 KST [14253] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:08:02 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:08:02 14428 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:08:03 14252 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:03 14252 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:03 14252 ERROR Failed to get Postgres pid, see above for details\n15:08:03 14252 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n15:08:03 14252 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n15:08:03 13929 ERROR pg_autoctl service monitor-init exited with exit status 12\n15:08:03 13929 INFO  Restarting service monitor-init\n15:08:03 14429 INFO  Granting connection privileges on 192.168.0.0/24\n15:08:12 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:12 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:12 13933 ERROR Failed to get Postgres pid, see above for details\n15:08:12 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:08:12 13933 ERROR 2022-03-21 15:08:02.275 KST [14428] FATAL:  database files are incompatible with server\n15:08:12 13933 ERROR 2022-03-21 15:08:02.275 KST [14428] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:08:12 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:08:12 14603 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:08:13 14429 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:13 14429 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:13 14429 ERROR Failed to get Postgres pid, see above for details\n15:08:13 14429 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n15:08:13 14429 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n15:08:13 13929 ERROR pg_autoctl service monitor-init exited with exit status 12\n15:08:13 13929 INFO  Restarting service monitor-init\n15:08:13 14604 INFO  Granting connection privileges on 192.168.0.0/24\n15:08:22 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:22 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:22 13933 ERROR Failed to get Postgres pid, see above for details\n15:08:22 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:08:22 13933 ERROR 2022-03-21 15:08:12.220 KST [14603] FATAL:  database files are incompatible with server\n15:08:22 13933 ERROR 2022-03-21 15:08:12.220 KST [14603] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:08:22 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:08:22 14778 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:08:23 14604 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:23 14604 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:23 14604 ERROR Failed to get Postgres pid, see above for details\n15:08:23 14604 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n15:08:23 14604 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n15:08:23 13929 ERROR pg_autoctl service monitor-init exited with exit status 12\n15:08:23 13929 INFO  Restarting service monitor-init\n15:08:23 14779 INFO  Granting connection privileges on 192.168.0.0/24\n15:08:32 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:32 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:32 13933 ERROR Failed to get Postgres pid, see above for details\n15:08:32 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:08:32 13933 ERROR 2022-03-21 15:08:22.262 KST [14778] FATAL:  database files are incompatible with server\n15:08:32 13933 ERROR 2022-03-21 15:08:22.262 KST [14778] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:08:32 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:08:32 14953 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:08:33 14779 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:33 14779 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:33 14779 ERROR Failed to get Postgres pid, see above for details\n15:08:33 14779 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"\n15:08:33 14779 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details\n15:08:33 13929 ERROR pg_autoctl service monitor-init exited with exit status 12\n15:08:33 13929 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 51 seconds, stopping now\n15:08:33 13929 INFO  Waiting for subprocesses to terminate.\n15:08:38 13929 INFO  pg_autoctl services are still running, signaling them with unknown signal.\n15:08:42 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory\n15:08:42 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?\n15:08:42 13933 ERROR Failed to get Postgres pid, see above for details\n15:08:42 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":\n15:08:42 13933 ERROR 2022-03-21 15:08:32.298 KST [14953] FATAL:  database files are incompatible with server\n15:08:42 13933 ERROR 2022-03-21 15:08:32.298 KST [14953] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).\n15:08:42 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"\n15:08:42 13933 INFO  Postgres controller service received signal SIGTERM, terminating\n15:08:42 13929 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.\n15:08:42 13929 INFO  Stop pg_autoctl", "stderr_lines": ["15:07:32 13929 INFO  Using default --ssl-mode \"require\"", "15:07:32 13929 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic", "15:07:32 13929 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.", "15:07:32 13929 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details", "15:07:32 13929 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"", "15:07:32 13929 INFO  Started pg_autoctl postgres service with pid 13933", "15:07:32 13933 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v", "15:07:32 13929 INFO  Started pg_autoctl monitor-init service with pid 13934", "15:07:32 13934 INFO  Granting connection privileges on 192.168.0.0/24", "15:07:32 13938 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:07:42 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:07:42 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:07:42 13934 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:07:42 13933 ERROR Failed to get Postgres pid, see above for details", "15:07:42 13934 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:07:42 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:07:42 13934 ERROR Failed to get Postgres pid, see above for details", "15:07:42 13933 ERROR 2022-03-21 15:07:32.883 KST [13938] FATAL:  database files are incompatible with server", "15:07:42 13934 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "15:07:42 13933 ERROR 2022-03-21 15:07:32.883 KST [13938] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:07:42 13934 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "15:07:42 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:07:42 13929 ERROR pg_autoctl service monitor-init exited with exit status 12", "15:07:42 13929 INFO  Restarting service monitor-init", "15:07:42 14069 INFO  Granting connection privileges on 192.168.0.0/24", "15:07:42 14071 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:07:52 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:07:52 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:07:52 13933 ERROR Failed to get Postgres pid, see above for details", "15:07:52 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:07:52 13933 ERROR 2022-03-21 15:07:42.295 KST [14071] FATAL:  database files are incompatible with server", "15:07:52 13933 ERROR 2022-03-21 15:07:42.295 KST [14071] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:07:52 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:07:52 14069 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:07:52 14069 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:07:52 14069 ERROR Failed to get Postgres pid, see above for details", "15:07:52 14069 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "15:07:52 14069 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "15:07:52 13929 ERROR pg_autoctl service monitor-init exited with exit status 12", "15:07:52 13929 INFO  Restarting service monitor-init", "15:07:52 14253 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:07:52 14252 INFO  Granting connection privileges on 192.168.0.0/24", "15:08:02 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:02 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:02 13933 ERROR Failed to get Postgres pid, see above for details", "15:08:02 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:08:02 13933 ERROR 2022-03-21 15:07:52.237 KST [14253] FATAL:  database files are incompatible with server", "15:08:02 13933 ERROR 2022-03-21 15:07:52.237 KST [14253] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:08:02 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:08:02 14428 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:08:03 14252 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:03 14252 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:03 14252 ERROR Failed to get Postgres pid, see above for details", "15:08:03 14252 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "15:08:03 14252 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "15:08:03 13929 ERROR pg_autoctl service monitor-init exited with exit status 12", "15:08:03 13929 INFO  Restarting service monitor-init", "15:08:03 14429 INFO  Granting connection privileges on 192.168.0.0/24", "15:08:12 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:12 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:12 13933 ERROR Failed to get Postgres pid, see above for details", "15:08:12 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:08:12 13933 ERROR 2022-03-21 15:08:02.275 KST [14428] FATAL:  database files are incompatible with server", "15:08:12 13933 ERROR 2022-03-21 15:08:02.275 KST [14428] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:08:12 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:08:12 14603 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:08:13 14429 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:13 14429 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:13 14429 ERROR Failed to get Postgres pid, see above for details", "15:08:13 14429 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "15:08:13 14429 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "15:08:13 13929 ERROR pg_autoctl service monitor-init exited with exit status 12", "15:08:13 13929 INFO  Restarting service monitor-init", "15:08:13 14604 INFO  Granting connection privileges on 192.168.0.0/24", "15:08:22 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:22 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:22 13933 ERROR Failed to get Postgres pid, see above for details", "15:08:22 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:08:22 13933 ERROR 2022-03-21 15:08:12.220 KST [14603] FATAL:  database files are incompatible with server", "15:08:22 13933 ERROR 2022-03-21 15:08:12.220 KST [14603] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:08:22 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:08:22 14778 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:08:23 14604 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:23 14604 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:23 14604 ERROR Failed to get Postgres pid, see above for details", "15:08:23 14604 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "15:08:23 14604 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "15:08:23 13929 ERROR pg_autoctl service monitor-init exited with exit status 12", "15:08:23 13929 INFO  Restarting service monitor-init", "15:08:23 14779 INFO  Granting connection privileges on 192.168.0.0/24", "15:08:32 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:32 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:32 13933 ERROR Failed to get Postgres pid, see above for details", "15:08:32 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:08:32 13933 ERROR 2022-03-21 15:08:22.262 KST [14778] FATAL:  database files are incompatible with server", "15:08:32 13933 ERROR 2022-03-21 15:08:22.262 KST [14778] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:08:32 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:08:32 14953 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *", "15:08:33 14779 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:33 14779 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:33 14779 ERROR Failed to get Postgres pid, see above for details", "15:08:33 14779 ERROR Failed to ensure that Postgres is running in \"/var/lib/pgsql/monitor\"", "15:08:33 14779 ERROR Failed to install pg_auto_failover in the monitor's Postgres database, see above for details", "15:08:33 13929 ERROR pg_autoctl service monitor-init exited with exit status 12", "15:08:33 13929 FATAL pg_autoctl service monitor-init has already been restarted 5 times in the last 51 seconds, stopping now", "15:08:33 13929 INFO  Waiting for subprocesses to terminate.", "15:08:38 13929 INFO  pg_autoctl services are still running, signaling them with unknown signal.", "15:08:42 13933 ERROR Failed to open file \"/var/lib/pgsql/monitor/postmaster.pid\": No such file or directory", "15:08:42 13933 INFO  Is PostgreSQL at \"/var/lib/pgsql/monitor\" up and running?", "15:08:42 13933 ERROR Failed to get Postgres pid, see above for details", "15:08:42 13933 WARN  Postgres logs from \"/var/lib/pgsql/monitor/startup.log\":", "15:08:42 13933 ERROR 2022-03-21 15:08:32.298 KST [14953] FATAL:  database files are incompatible with server", "15:08:42 13933 ERROR 2022-03-21 15:08:32.298 KST [14953] DETAIL:  The data directory was initialized by PostgreSQL version 12, which is not compatible with this version 10.17 (VMware Postgres 10.17.0).", "15:08:42 13933 WARN  Failed to start Postgres instance at \"/var/lib/pgsql/monitor\"", "15:08:42 13933 INFO  Postgres controller service received signal SIGTERM, terminating", "15:08:42 13929 FATAL Something went wrong in sub-process supervision, stopping now. See above for details.", "15:08:42 13929 INFO  Stop pg_autoctl"], "stdout": "", "stdout_lines": []}
2022-03-21 15:08:42,655 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:08:42,675 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:42,690 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:42,703 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:42,713 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 15:08:42,733 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:42,804 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:42,809 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:42,822 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 15:08:42,842 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:42,858 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:42,871 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:42,880 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:08:42,915 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:42,916 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:42,927 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:42,937 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:08:42,956 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:42,972 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:42,984 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:42,994 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:08:43,014 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:43,037 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:43,050 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:43,059 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 15:08:43,079 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:43,094 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:43,107 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:43,116 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:08:43,136 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:43,155 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:43,165 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:43,176 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 15:08:43,195 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:43,211 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:43,224 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:43,233 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:08:43,253 p=14749 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:08:43,269 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:43,281 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:08:43,291 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:08:43,324 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:08:43,334 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,558 p=14749 u=moonja n=ansible | fatal: [co7-node01]: FAILED! => {"ansible_job_id": "842500526077.18909", "changed": false, "child_pid": 18913, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/842500526077.18909", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:11:53,566 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:11:53,589 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,599 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,609 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 15:11:53,629 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,640 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,651 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:11:53,671 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,680 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,691 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 15:11:53,712 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,724 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,735 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:11:53,756 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,765 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,777 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:11:53,799 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,810 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,821 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 15:11:53,845 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,854 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,865 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:11:53,886 p=14749 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:11:53,898 p=14749 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:11:53,908 p=14749 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:15:00,129 p=14749 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"ansible_job_id": "790630851375.18230", "changed": false, "child_pid": 18234, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/790630851375.18230", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:15:03,847 p=14749 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"ansible_job_id": "676037469421.17418", "changed": false, "child_pid": 17422, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/676037469421.17418", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:15:03,849 p=14749 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:15:03,850 p=14749 u=moonja n=ansible | co7-master                 : ok=16   changed=8    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2022-03-21 15:15:03,850 p=14749 u=moonja n=ansible | co7-node01                 : ok=12   changed=6    unreachable=0    failed=1    skipped=16   rescued=0    ignored=0   
2022-03-21 15:15:03,850 p=14749 u=moonja n=ansible | co7-node02                 : ok=12   changed=6    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:15:03,850 p=14749 u=moonja n=ansible | co7-node03                 : ok=12   changed=6    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:18:08,847 p=20433 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:18:09,075 p=20433 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:18:09,079 p=20433 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:18:09,126 p=20433 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:18:09,138 p=20433 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:18:09,166 p=20433 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:18:11,378 p=20433 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:18:11,446 p=20433 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:18:11,465 p=20433 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:18:11,499 p=20433 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:18:11,515 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 15:18:12,447 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:18:12,451 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:18:12,453 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:18:12,821 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:18:12,831 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 15:18:13,569 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:18:13,570 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:18:13,577 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:18:13,580 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:18:14,181 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:18:14,210 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:18:14,218 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:18:14,239 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:18:14,766 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:18:14,786 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:18:14,810 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:18:14,824 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:18:15,389 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:18:15,417 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:18:15,419 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:18:15,471 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:18:15,483 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:18:17,412 p=20433 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:18:17,419 p=20433 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:18:17,441 p=20433 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:18:17,454 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:18:17,464 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 15:18:18,889 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:18:19,067 p=20433 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:18:19,076 p=20433 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:18:19,127 p=20433 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:18:19,137 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:18:19,182 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:19,182 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:19,193 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:19,732 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:18:19,741 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:18:19,773 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:19,787 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:19,800 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:20,221 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:18:20,230 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:18:20,868 p=20433 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:18:20,886 p=20433 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:18:20,887 p=20433 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:18:20,899 p=20433 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:18:20,909 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:18:20,953 p=20433 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:18:20,958 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:20,971 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:20,987 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:20,996 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:18:21,015 p=20433 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:18:21,030 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:21,671 p=20433 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:18:21,671 p=20433 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:18:21,679 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:18:21,698 p=20433 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:18:21,713 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:22,654 p=20433 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:18:22,654 p=20433 u=moonja n=ansible | ...ignoring
2022-03-21 15:18:22,654 p=20433 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:18:22,655 p=20433 u=moonja n=ansible | ...ignoring
2022-03-21 15:18:22,664 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 15:18:22,685 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:22,687 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:22,690 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:22,695 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:22,697 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:22,701 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:18:22,702 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:22,702 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:22,705 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:22,709 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:22,713 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:22,714 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:18:23,310 p=20433 u=moonja n=ansible | ok: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:18:23,312 p=20433 u=moonja n=ansible | ok: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:18:23,719 p=20433 u=moonja n=ansible | ok: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:18:23,720 p=20433 u=moonja n=ansible | ok: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:18:24,135 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:18:24,135 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:18:24,548 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 15:18:24,548 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 15:18:24,947 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:18:24,947 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:18:25,350 p=20433 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 15:18:25,351 p=20433 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 15:18:25,363 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:18:25,381 p=20433 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:18:25,410 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:25,421 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:25,903 p=20433 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:18:25,913 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:18:25,933 p=20433 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:18:25,963 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:25,975 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:26,594 p=20433 u=moonja n=ansible | fatal: [co7-node01]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:18:26,594 p=20433 u=moonja n=ansible | ...ignoring
2022-03-21 15:18:26,604 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:18:26,626 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:26,627 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:26,634 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:26,635 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:26,635 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:26,636 p=20433 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:18:26,659 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:26,660 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:26,663 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:26,668 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:26,668 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:26,669 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:18:26,671 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:26,673 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:26,677 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:26,679 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:26,681 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:26,682 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:18:27,038 p=20433 u=moonja n=ansible | ok: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:18:27,506 p=20433 u=moonja n=ansible | ok: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:18:27,975 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:18:28,385 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 15:18:28,866 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:18:29,253 p=20433 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 15:18:29,264 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:18:29,296 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:29,311 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:29,323 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:29,792 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:18:29,803 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:18:29,849 p=20433 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:18:29,850 p=20433 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:18:29,861 p=20433 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:18:30,467 p=20433 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:18:30,467 p=20433 u=moonja n=ansible | ...ignoring
2022-03-21 15:18:30,477 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:18:30,515 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:30,516 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:30,522 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:30,523 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:30,523 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:30,528 p=20433 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:18:30,529 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:30,530 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:30,532 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:30,535 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:30,537 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:30,538 p=20433 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:18:30,544 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:18:30,550 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:18:30,554 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:18:30,555 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:18:30,555 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:18:30,556 p=20433 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:18:31,011 p=20433 u=moonja n=ansible | ok: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:18:31,439 p=20433 u=moonja n=ansible | ok: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:18:31,902 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:18:32,315 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 15:18:32,755 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:18:33,255 p=20433 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-21 15:18:33,267 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 15:19:01,928 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:19:08,104 p=20433 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:19:08,182 p=20433 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:19:08,272 p=20433 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:19:08,280 p=20433 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:19:08,758 p=20433 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:19:08,759 p=20433 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:19:08,764 p=20433 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:19:08,796 p=20433 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:19:08,842 p=20433 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:19:08,842 p=20433 u=moonja n=ansible | co7-master                 : ok=13   changed=10   unreachable=0    failed=0    skipped=7    rescued=0    ignored=1   
2022-03-21 15:19:08,842 p=20433 u=moonja n=ansible | co7-node01                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 15:19:08,842 p=20433 u=moonja n=ansible | co7-node02                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 15:19:08,842 p=20433 u=moonja n=ansible | co7-node03                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 15:21:55,944 p=22186 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:21:56,174 p=22186 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:21:56,179 p=22186 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:21:56,225 p=22186 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:21:56,239 p=22186 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:21:56,269 p=22186 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:21:58,443 p=22186 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:21:58,508 p=22186 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:21:58,518 p=22186 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:21:58,591 p=22186 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:21:58,607 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 15:21:59,648 p=22186 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 15:21:59,663 p=22186 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 15:21:59,706 p=22186 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 15:21:59,711 p=22186 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 15:22:00,383 p=22186 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:22:00,428 p=22186 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:22:00,482 p=22186 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:22:00,488 p=22186 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:22:01,215 p=22186 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 15:22:01,276 p=22186 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 15:22:01,359 p=22186 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 15:22:01,365 p=22186 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 15:22:01,376 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 15:22:02,610 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:22:02,626 p=22186 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:22:02,676 p=22186 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:22:02,724 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:22:02,735 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 15:22:03,561 p=22186 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:22:03,562 p=22186 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:22:03,564 p=22186 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:22:03,577 p=22186 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:22:03,587 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 15:22:04,319 p=22186 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:22:04,353 p=22186 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:22:04,355 p=22186 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:22:04,359 p=22186 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:22:04,920 p=22186 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:22:05,012 p=22186 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:22:05,435 p=22186 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:22:05,598 p=22186 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:22:05,694 p=22186 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:22:05,842 p=22186 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:22:06,044 p=22186 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:22:06,236 p=22186 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:22:06,362 p=22186 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:22:06,437 p=22186 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:22:06,629 p=22186 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:22:06,995 p=22186 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:22:07,006 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:22:08,594 p=22186 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:22:08,609 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:22:08,618 p=22186 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:22:08,619 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:22:08,630 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:22:10,131 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:22:10,135 p=22186 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:22:10,139 p=22186 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:22:10,162 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:22:10,171 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 15:22:16,932 p=22186 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 15:22:17,142 p=22186 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 15:22:17,491 p=22186 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 15:22:17,526 p=22186 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 15:22:23,181 p=22186 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:22:23,391 p=22186 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:22:24,408 p=22186 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:22:25,555 p=22186 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:22:25,564 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 15:22:46,076 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:22:48,136 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:22:54,343 p=22186 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:22:54,394 p=22186 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:22:54,405 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:22:54,454 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:22:54,455 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:22:54,465 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:22:55,041 p=22186 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 15:22:55,042 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:22:55,052 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:22:55,088 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 10.17 (VMware Postgres 10.17.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 15:22:55,104 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:22:55,105 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:22:55,117 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:22:55,126 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:22:55,157 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:22:55,172 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:22:55,184 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:22:55,648 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:22:55,657 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:22:55,693 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 10.17 (VMware Postgres 10.17.0)"
}
2022-03-21 15:22:55,709 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:22:55,710 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:22:55,722 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:22:55,731 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:22:56,416 p=22186 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:22:56,418 p=22186 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:22:56,433 p=22186 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:22:56,440 p=22186 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:22:56,449 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 15:22:56,499 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:22:56,504 p=22186 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:22:56,517 p=22186 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:22:56,535 p=22186 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:22:56,546 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:22:56,592 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:22:56,597 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:22:56,612 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:22:56,628 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:22:56,638 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:22:56,674 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:22:56,692 p=22186 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:22:56,692 p=22186 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:22:56,704 p=22186 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:22:56,714 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 15:22:56,746 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:22:56,761 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:22:56,772 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:15,632 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:15,640 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:15,722 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:15,751 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "655790712633.23162",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:15.714353",
        "end": "2022-03-21 15:23:13.201495",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/655790712633.23162",
        "start": "2022-03-21 15:22:57.487142",
        "started": 1,
        "stderr": "15:22:57 23172 INFO  Using default --ssl-mode \"require\"\n15:22:57 23172 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:22:57 23172 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:22:57 23172 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:22:57 23172 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n15:22:57 23172 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n15:23:04 23172 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n15:23:04 23172 INFO  Started pg_autoctl postgres service with pid 23318\n15:23:04 23318 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n15:23:04 23172 INFO  Started pg_autoctl monitor-init service with pid 23319\n15:23:04 23319 INFO  Granting connection privileges on 192.168.0.0/24\n15:23:04 23324 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:23:05 23318 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 23324\n15:23:06 23319 WARN  NOTICE:  installing required extension \"btree_gist\"\n15:23:06 23319 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n15:23:06 23319 INFO  Monitor has been successfully initialized.\n15:23:06 23172 WARN  pg_autoctl service monitor-init exited with exit status 0\n15:23:06 23318 INFO  Postgres controller service received signal SIGTERM, terminating\n15:23:06 23318 INFO  Stopping pg_autoctl postgres service\n15:23:06 23318 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n15:23:06 23172 INFO  Waiting for subprocesses to terminate.\n15:23:11 23172 INFO  pg_autoctl services are still running, signaling them with unknown signal.\n15:23:13 23172 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:22:57 23172 INFO  Using default --ssl-mode \"require\"",
            "15:22:57 23172 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:22:57 23172 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:22:57 23172 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:22:57 23172 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "15:22:57 23172 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "15:23:04 23172 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "15:23:04 23172 INFO  Started pg_autoctl postgres service with pid 23318",
            "15:23:04 23318 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "15:23:04 23172 INFO  Started pg_autoctl monitor-init service with pid 23319",
            "15:23:04 23319 INFO  Granting connection privileges on 192.168.0.0/24",
            "15:23:04 23324 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "15:23:05 23318 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 23324",
            "15:23:06 23319 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "15:23:06 23319 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "15:23:06 23319 INFO  Monitor has been successfully initialized.",
            "15:23:06 23172 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "15:23:06 23318 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:23:06 23318 INFO  Stopping pg_autoctl postgres service",
            "15:23:06 23318 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "15:23:06 23172 INFO  Waiting for subprocesses to terminate.",
            "15:23:11 23172 INFO  pg_autoctl services are still running, signaling them with unknown signal.",
            "15:23:13 23172 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:23:15,752 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:15,753 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:15,762 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 15:23:15,794 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:15,808 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:15,819 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:22,175 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:22,183 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 15:23:22,215 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:22,230 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:22,242 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:22,691 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:22,702 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:23:22,735 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:22,750 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:22,761 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:24,521 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:24,531 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:24,602 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "-.mount basic.target system.slice systemd-journald.socket",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount basic.target system.slice",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:23:24,619 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:24,620 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:24,632 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:24,641 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:23:24,687 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:24,687 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:24,699 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:25,378 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:25,387 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 15:23:25,421 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:25,436 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:25,448 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:25,886 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:25,897 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:25,950 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.035395",
        "end": "2022-03-21 15:23:26.114054",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:23:26.078659",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 24282     1  0 15:23 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 24286 24282  0 15:23 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 24287 24282  0 15:23 ?        00:00:00 pg_autoctl: monitor listener\npostgres 24328 24286  2 15:23 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres 24430 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: logger process  \npostgres 24452 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer process  \npostgres 24453 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: writer process  \npostgres 24454 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: wal writer process  \npostgres 24455 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher process  \npostgres 24456 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector process  \npostgres 24457 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor  \npostgres 24458 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: logical replication launcher  \npostgres 24471 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  \npostgres 24472 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  \npostgres 24512 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle\njomoon   24544 19261  0 15:23 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=heiclncsarmbzvwpwqehoyqncwgpzqlt] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-heiclncsarmbzvwpwqehoyqncwgpzqlt ; /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py' && sleep 0\nroot     24568 24544  0 15:23 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=heiclncsarmbzvwpwqehoyqncwgpzqlt] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-heiclncsarmbzvwpwqehoyqncwgpzqlt ; /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py\npostgres 24569 24568  0 15:23 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-heiclncsarmbzvwpwqehoyqncwgpzqlt ; /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py\npostgres 24570 24569  0 15:23 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py\npostgres 24572 24570  0 15:23 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 24573 24572  0 15:23 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 24574 24573  0 15:23 pts/0    00:00:00 ps -ef\npostgres 24575 24573  0 15:23 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 24282     1  0 15:23 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 24286 24282  0 15:23 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 24287 24282  0 15:23 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 24328 24286  2 15:23 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres 24430 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: logger process  ",
            "postgres 24452 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer process  ",
            "postgres 24453 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: writer process  ",
            "postgres 24454 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: wal writer process  ",
            "postgres 24455 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher process  ",
            "postgres 24456 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector process  ",
            "postgres 24457 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor  ",
            "postgres 24458 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: logical replication launcher  ",
            "postgres 24471 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  ",
            "postgres 24472 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  ",
            "postgres 24512 24328  0 15:23 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle",
            "jomoon   24544 19261  0 15:23 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=heiclncsarmbzvwpwqehoyqncwgpzqlt] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-heiclncsarmbzvwpwqehoyqncwgpzqlt ; /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py' && sleep 0",
            "root     24568 24544  0 15:23 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=heiclncsarmbzvwpwqehoyqncwgpzqlt] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-heiclncsarmbzvwpwqehoyqncwgpzqlt ; /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py",
            "postgres 24569 24568  0 15:23 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-heiclncsarmbzvwpwqehoyqncwgpzqlt ; /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py",
            "postgres 24570 24569  0 15:23 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647843805.472515-23925-69352356793962/AnsiballZ_command.py",
            "postgres 24572 24570  0 15:23 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 24573 24572  0 15:23 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 24574 24573  0 15:23 pts/0    00:00:00 ps -ef",
            "postgres 24575 24573  0 15:23 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 15:23:25,963 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:25,963 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:25,978 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:25,987 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 15:23:26,021 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:26,036 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:26,049 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:26,484 p=22186 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:23:26,492 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:26,550 p=22186 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.035116",
        "end": "2022-03-21 15:23:26.710813",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:23:26.675697",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-21 15:23:26,564 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:23:26,565 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:26,577 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:26,586 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:23:26,606 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:26,635 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:26,647 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:45,214 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:23:45,226 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:45,248 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:45,300 p=22186 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "30811258113.29293",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:13.195786",
        "end": "2022-03-21 15:23:40.613904",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/30811258113.29293",
        "start": "2022-03-21 15:23:27.418118",
        "started": 1,
        "stderr": "15:23:27 29303 INFO  Using default --ssl-mode \"require\"\n15:23:27 29303 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:23:27 29303 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:23:27 29303 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:23:27 29303 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n15:23:27 29303 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n15:23:27 29303 INFO  Started pg_autoctl postgres service with pid 29305\n15:23:27 29305 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:23:27 29303 INFO  Started pg_autoctl node-init service with pid 29306\n15:23:27 29306 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n15:23:27 29306 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:23:27 29306 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:23:27 29306 INFO  Successfully registered as \"single\" to the monitor.\n15:23:27 29306 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n15:23:27 29306 INFO  Initialising postgres as a primary\n15:23:27 29306 INFO  Initialising a PostgreSQL cluster at \"ha\"\n15:23:27 29306 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n15:23:34 29306 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:23:34 29306 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:23:34 29306 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:23:34 29306 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:23:34 29306 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:23:36 29457 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:23:36 29305 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 29457\n15:23:37 29306 INFO  CREATE DATABASE appdb;\n15:23:39 29306 INFO  CREATE EXTENSION pg_stat_statements;\n15:23:39 29306 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:23:39 29306 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n15:23:39 29306 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:23:39 29306 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n15:23:39 29306 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:23:39 29306 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n15:23:39 29306 INFO  Transition complete: current state is now \"single\"\n15:23:39 29306 INFO  keeper has been successfully initialized.\n15:23:39 29303 WARN  pg_autoctl service node-init exited with exit status 0\n15:23:39 29305 INFO  Postgres controller service received signal SIGTERM, terminating\n15:23:39 29305 INFO  Stopping pg_autoctl postgres service\n15:23:39 29305 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:23:39 29303 INFO  Waiting for subprocesses to terminate.\n15:23:40 29303 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:23:27 29303 INFO  Using default --ssl-mode \"require\"",
            "15:23:27 29303 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:23:27 29303 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:23:27 29303 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:23:27 29303 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "15:23:27 29303 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "15:23:27 29303 INFO  Started pg_autoctl postgres service with pid 29305",
            "15:23:27 29305 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:23:27 29303 INFO  Started pg_autoctl node-init service with pid 29306",
            "15:23:27 29306 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "15:23:27 29306 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:23:27 29306 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:23:27 29306 INFO  Successfully registered as \"single\" to the monitor.",
            "15:23:27 29306 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "15:23:27 29306 INFO  Initialising postgres as a primary",
            "15:23:27 29306 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "15:23:27 29306 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "15:23:34 29306 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:23:34 29306 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:23:34 29306 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:23:34 29306 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:23:34 29306 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:23:36 29457 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:23:36 29305 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 29457",
            "15:23:37 29306 INFO  CREATE DATABASE appdb;",
            "15:23:39 29306 INFO  CREATE EXTENSION pg_stat_statements;",
            "15:23:39 29306 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:23:39 29306 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "15:23:39 29306 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:23:39 29306 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "15:23:39 29306 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:23:39 29306 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "15:23:39 29306 INFO  Transition complete: current state is now \"single\"",
            "15:23:39 29306 INFO  keeper has been successfully initialized.",
            "15:23:39 29303 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:23:39 29305 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:23:39 29305 INFO  Stopping pg_autoctl postgres service",
            "15:23:39 29305 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:23:39 29303 INFO  Waiting for subprocesses to terminate.",
            "15:23:40 29303 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:23:45,301 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:45,301 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:45,310 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 15:23:45,331 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:45,364 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:45,375 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:51,753 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:23:51,763 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:51,787 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:51,826 p=22186 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "711279370254.29889",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031364",
        "end": "2022-03-21 15:23:46.229915",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/711279370254.29889",
        "start": "2022-03-21 15:23:46.198551",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:23:51,832 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:51,838 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:51,847 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 15:23:51,868 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:51,900 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:51,911 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:52,421 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:23:52,431 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:23:52,451 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:52,481 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:52,493 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:53,176 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:23:53,187 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:23:53,208 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:53,239 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:53,252 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:53,685 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:23:53,695 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 15:23:53,717 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:53,747 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:53,758 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:54,285 p=22186 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:23:54,295 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:23:54,317 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:54,352 p=22186 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.064371",
        "end": "2022-03-21 15:23:54.509335",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:23:54.444964",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/16C4AF0 |        no |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/16C4AF0 |        no |              single |              single"
        ]
    }
}
2022-03-21 15:23:54,353 p=22186 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:23:54,365 p=22186 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:23:54,374 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:23:54,394 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:23:54,412 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,354 p=22186 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"ansible_job_id": "164026040325.27857", "changed": false, "child_pid": 27861, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/164026040325.27857", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:27:02,355 p=22186 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"ansible_job_id": "382039101355.28670", "changed": false, "child_pid": 28674, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/382039101355.28670", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:27:02,364 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:27:02,386 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,396 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,406 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 15:27:02,427 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,439 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,450 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:27:02,471 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,483 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,494 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 15:27:02,514 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,529 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,540 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:27:02,561 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,573 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,583 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:27:02,603 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,615 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,626 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 15:27:02,646 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,656 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,667 p=22186 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:27:02,686 p=22186 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:27:02,696 p=22186 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:27:02,727 p=22186 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:27:02,727 p=22186 u=moonja n=ansible | co7-master                 : ok=27   changed=15   unreachable=0    failed=0    skipped=19   rescued=0    ignored=0   
2022-03-21 15:27:02,727 p=22186 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:27:02,727 p=22186 u=moonja n=ansible | co7-node02                 : ok=12   changed=6    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:27:02,727 p=22186 u=moonja n=ansible | co7-node03                 : ok=12   changed=6    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:27:37,906 p=26033 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:27:38,135 p=26033 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:27:38,139 p=26033 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 308,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:27:38,185 p=26033 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:27:38,198 p=26033 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:27:38,225 p=26033 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:27:40,295 p=26033 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:27:40,340 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:27:40,437 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:27:40,440 p=26033 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:27:40,456 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 15:27:41,491 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 15:27:41,502 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 15:27:41,507 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 15:27:41,531 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 15:27:42,171 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:27:42,227 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:27:42,242 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:27:42,254 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:27:47,589 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 15:27:48,150 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 15:27:48,163 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 15:27:48,166 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 15:27:48,177 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 15:27:49,087 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:27:49,098 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:27:49,103 p=26033 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:27:49,110 p=26033 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:27:49,120 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 15:27:50,111 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=5432)
2022-03-21 15:27:50,113 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=5432)
2022-03-21 15:27:50,122 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=5432)
2022-03-21 15:27:50,122 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=5432)
2022-03-21 15:27:50,134 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 15:27:50,985 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=co7-master)
2022-03-21 15:27:50,986 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=co7-master)
2022-03-21 15:27:51,012 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=co7-master)
2022-03-21 15:27:51,012 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=co7-master)
2022-03-21 15:27:51,583 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=co7-node01)
2022-03-21 15:27:51,585 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node01)
2022-03-21 15:27:51,622 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node01)
2022-03-21 15:27:51,628 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node01)
2022-03-21 15:27:52,239 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node02)
2022-03-21 15:27:52,256 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=co7-node02)
2022-03-21 15:27:52,279 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node02)
2022-03-21 15:27:52,302 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node02)
2022-03-21 15:27:52,861 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node03)
2022-03-21 15:27:52,861 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node03)
2022-03-21 15:27:52,863 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=co7-node03)
2022-03-21 15:27:52,878 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node03)
2022-03-21 15:27:52,890 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:27:54,556 p=26033 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:27:54,568 p=26033 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:27:54,632 p=26033 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:27:54,648 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:27:54,658 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:27:55,937 p=26033 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:27:55,948 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:27:55,954 p=26033 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:27:55,963 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:27:55,972 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 15:28:02,849 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 15:28:02,849 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 15:28:02,921 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 15:28:02,922 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 15:28:09,159 p=26033 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:28:09,173 p=26033 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:28:09,173 p=26033 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:28:09,237 p=26033 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:28:09,247 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 15:28:15,619 p=26033 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:28:15,645 p=26033 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:28:16,405 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:28:16,613 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:28:16,622 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:28:16,657 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:16,673 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:16,685 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:17,456 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:17,467 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:17,503 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 10.17 (VMware Postgres 10.17.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 15:28:17,520 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:17,521 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:17,533 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:17,543 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:28:17,575 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:17,589 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:17,602 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:18,047 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:18,056 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:18,141 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 10.17 (VMware Postgres 10.17.0)"
}
2022-03-21 15:28:18,159 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:18,159 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:18,171 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:18,181 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:28:18,820 p=26033 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:28:18,824 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:28:18,880 p=26033 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:28:18,882 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:28:18,892 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 15:28:18,940 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:24282,24286,24287"
}
2022-03-21 15:28:18,945 p=26033 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:30427,30430,30431"
}
2022-03-21 15:28:18,959 p=26033 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:28:18,975 p=26033 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:28:18,986 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:28:19,054 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:19,067 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:22,203 p=26033 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:28:22,250 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:22,260 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:22,295 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "stopped",
        "status": {
            "ActiveEnterTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "ActiveEnterTimestampMonotonic": "6408055958",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "active",
            "After": "systemd-journald.socket basic.target system.slice -.mount",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "yes",
            "AssertTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "AssertTimestampMonotonic": "6408055569",
            "Before": "shutdown.target multi-user.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "yes",
            "ConditionTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "ConditionTimestampMonotonic": "6408055568",
            "Conflicts": "shutdown.target",
            "ControlGroup": "/system.slice/pgautofailover.service",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "24282",
            "ExecMainStartTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "ExecMainStartTimestampMonotonic": "6408055920",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[Mon 2022-03-21 15:23:24 KST] ; stop_time=[n/a] ; pid=24282 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "InactiveExitTimestampMonotonic": "6408055958",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "24282",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "basic.target system.slice -.mount",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "running",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "enabled",
            "User": "postgres",
            "WantedBy": "multi-user.target",
            "WatchdogTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "WatchdogTimestampMonotonic": "6408055944",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:28:22,314 p=26033 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "stopped",
        "status": {
            "ActiveEnterTimestamp": "Mon 2022-03-21 15:23:53 KST",
            "ActiveEnterTimestampMonotonic": "6435716522",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "active",
            "After": "systemd-journald.socket basic.target system.slice -.mount",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "yes",
            "AssertTimestamp": "Mon 2022-03-21 15:23:53 KST",
            "AssertTimestampMonotonic": "6435716137",
            "Before": "shutdown.target multi-user.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "yes",
            "ConditionTimestamp": "Mon 2022-03-21 15:23:53 KST",
            "ConditionTimestampMonotonic": "6435716137",
            "Conflicts": "shutdown.target",
            "ControlGroup": "/system.slice/pgautofailover.service",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/ha",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "30427",
            "ExecMainStartTimestamp": "Mon 2022-03-21 15:23:53 KST",
            "ExecMainStartTimestampMonotonic": "6435716475",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[Mon 2022-03-21 15:23:53 KST] ; stop_time=[n/a] ; pid=30427 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestamp": "Mon 2022-03-21 15:23:53 KST",
            "InactiveExitTimestampMonotonic": "6435716522",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "31193",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "31193",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "30427",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "basic.target system.slice -.mount",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "running",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "enabled",
            "User": "postgres",
            "WantedBy": "multi-user.target",
            "WatchdogTimestamp": "Mon 2022-03-21 15:23:53 KST",
            "WatchdogTimestampMonotonic": "6435716507",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:28:22,315 p=26033 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:28:22,326 p=26033 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:28:22,335 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 15:28:22,380 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:22,381 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:22,392 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:28,689 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:28,697 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:28,734 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "255434771658.28697",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:01.005649",
        "end": "2022-03-21 15:28:24.246703",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/255434771658.28697",
        "start": "2022-03-21 15:28:23.241054",
        "started": 1,
        "stderr": "15:28:23 28707 INFO  Using default --ssl-mode \"require\"\n15:28:23 28707 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:28:23 28707 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:28:23 28707 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:28:23 28707 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n15:28:23 28707 INFO  Started pg_autoctl postgres service with pid 28711\n15:28:23 28711 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n15:28:23 28707 INFO  Started pg_autoctl monitor-init service with pid 28712\n15:28:23 28712 INFO  Granting connection privileges on 192.168.0.0/24\n15:28:23 28716 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:28:23 28711 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 28716\n15:28:23 28712 INFO  The user \"autoctl\" already exists, skipping.\n15:28:23 28712 INFO  The database \"pg_auto_failover\" already exists, skipping.\n15:28:23 28712 WARN  NOTICE:  extension \"pgautofailover\" already exists, skipping\n15:28:23 28712 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n15:28:23 28712 INFO  Monitor has been successfully initialized.\n15:28:23 28707 WARN  pg_autoctl service monitor-init exited with exit status 0\n15:28:23 28711 INFO  Postgres controller service received signal SIGTERM, terminating\n15:28:23 28711 INFO  Stopping pg_autoctl postgres service\n15:28:23 28711 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n15:28:24 28707 INFO  Waiting for subprocesses to terminate.\n15:28:24 28707 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:28:23 28707 INFO  Using default --ssl-mode \"require\"",
            "15:28:23 28707 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:28:23 28707 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:28:23 28707 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:28:23 28707 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "15:28:23 28707 INFO  Started pg_autoctl postgres service with pid 28711",
            "15:28:23 28711 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "15:28:23 28707 INFO  Started pg_autoctl monitor-init service with pid 28712",
            "15:28:23 28712 INFO  Granting connection privileges on 192.168.0.0/24",
            "15:28:23 28716 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "15:28:23 28711 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 28716",
            "15:28:23 28712 INFO  The user \"autoctl\" already exists, skipping.",
            "15:28:23 28712 INFO  The database \"pg_auto_failover\" already exists, skipping.",
            "15:28:23 28712 WARN  NOTICE:  extension \"pgautofailover\" already exists, skipping",
            "15:28:23 28712 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "15:28:23 28712 INFO  Monitor has been successfully initialized.",
            "15:28:23 28707 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "15:28:23 28711 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:28:23 28711 INFO  Stopping pg_autoctl postgres service",
            "15:28:23 28711 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "15:28:24 28707 INFO  Waiting for subprocesses to terminate.",
            "15:28:24 28707 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:28:28,749 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:28,755 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:28,762 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:28,771 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 15:28:28,816 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:28,817 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:28,828 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:35,147 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:35,157 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 15:28:35,203 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:35,204 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:35,215 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:35,806 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:28:35,816 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:28:35,863 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:35,863 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:35,874 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:36,535 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:36,546 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:36,589 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "ActiveEnterTimestampMonotonic": "6408055958",
            "ActiveExitTimestamp": "Mon 2022-03-21 15:28:20 KST",
            "ActiveExitTimestampMonotonic": "6703493324",
            "ActiveState": "inactive",
            "After": "-.mount systemd-journald.socket basic.target system.slice",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "yes",
            "AssertTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "AssertTimestampMonotonic": "6408055569",
            "Before": "shutdown.target multi-user.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "yes",
            "ConditionTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "ConditionTimestampMonotonic": "6408055568",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "1",
            "ExecMainExitTimestamp": "Mon 2022-03-21 15:28:22 KST",
            "ExecMainExitTimestampMonotonic": "6705807173",
            "ExecMainPID": "24282",
            "ExecMainStartTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "ExecMainStartTimestampMonotonic": "6408055920",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestamp": "Mon 2022-03-21 15:28:22 KST",
            "InactiveEnterTimestampMonotonic": "6705807314",
            "InactiveExitTimestamp": "Mon 2022-03-21 15:23:24 KST",
            "InactiveExitTimestampMonotonic": "6408055958",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount basic.target system.slice",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "enabled",
            "User": "postgres",
            "WantedBy": "multi-user.target",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:28:36,603 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:36,604 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:36,615 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:36,625 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:28:36,657 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:36,673 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:36,685 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:37,313 p=26033 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:28:37,324 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 15:28:37,357 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:37,371 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:37,384 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:37,852 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:37,862 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:37,899 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.035331",
        "end": "2022-03-21 15:28:38.093684",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:28:38.058353",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 29613     1  0 15:28 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 29616 29613  0 15:28 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 29617 29613  0 15:28 ?        00:00:00 pg_autoctl: monitor listener\npostgres 29647 29616  5 15:28 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres 29692 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: logger process  \npostgres 29700 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer process  \npostgres 29701 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: writer process  \npostgres 29702 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: wal writer process  \npostgres 29703 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher process  \npostgres 29704 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector process  \npostgres 29705 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor  \npostgres 29707 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: logical replication launcher  \npostgres 29719 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  \npostgres 29720 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  \npostgres 29721 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle\njomoon   29873 24952  0 15:28 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=mifcauxlzevxgutyzomzhbnnkiiefqfk] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-mifcauxlzevxgutyzomzhbnnkiiefqfk ; /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py' && sleep 0\nroot     29897 29873  0 15:28 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=mifcauxlzevxgutyzomzhbnnkiiefqfk] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-mifcauxlzevxgutyzomzhbnnkiiefqfk ; /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py\npostgres 29898 29897  0 15:28 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-mifcauxlzevxgutyzomzhbnnkiiefqfk ; /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py\npostgres 29899 29898  0 15:28 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py\npostgres 29901 29899  0 15:28 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 29902 29901  0 15:28 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 29903 29902  0 15:28 pts/0    00:00:00 ps -ef\npostgres 29904 29902  0 15:28 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 29613     1  0 15:28 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 29616 29613  0 15:28 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 29617 29613  0 15:28 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 29647 29616  5 15:28 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres 29692 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: logger process  ",
            "postgres 29700 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer process  ",
            "postgres 29701 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: writer process  ",
            "postgres 29702 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: wal writer process  ",
            "postgres 29703 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher process  ",
            "postgres 29704 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector process  ",
            "postgres 29705 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor  ",
            "postgres 29707 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: logical replication launcher  ",
            "postgres 29719 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  ",
            "postgres 29720 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: bgworker: pg_auto_failover monitor worker  ",
            "postgres 29721 29647  0 15:28 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle",
            "jomoon   29873 24952  0 15:28 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=mifcauxlzevxgutyzomzhbnnkiiefqfk] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-mifcauxlzevxgutyzomzhbnnkiiefqfk ; /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py' && sleep 0",
            "root     29897 29873  0 15:28 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=mifcauxlzevxgutyzomzhbnnkiiefqfk] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-mifcauxlzevxgutyzomzhbnnkiiefqfk ; /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py",
            "postgres 29898 29897  0 15:28 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-mifcauxlzevxgutyzomzhbnnkiiefqfk ; /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py",
            "postgres 29899 29898  0 15:28 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647844117.425059-27584-139246724973716/AnsiballZ_command.py",
            "postgres 29901 29899  0 15:28 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 29902 29901  0 15:28 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 29903 29902  0 15:28 pts/0    00:00:00 ps -ef",
            "postgres 29904 29902  0 15:28 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 15:28:37,914 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:37,915 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:37,927 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:37,936 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 15:28:37,981 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:37,982 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:37,993 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:38,445 p=26033 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:28:38,455 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:38,492 p=26033 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.035349",
        "end": "2022-03-21 15:28:38.685971",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:28:38.650622",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-21 15:28:38,508 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:28:38,509 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:38,520 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:38,529 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:28:38,561 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:38,577 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:38,588 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:44,853 p=26033 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:28:44,862 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:44,897 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:44,938 p=26033 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "578215629765.2099",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.239681",
        "end": "2022-03-21 15:28:39.646189",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/578215629765.2099",
        "start": "2022-03-21 15:28:39.406508",
        "started": 1,
        "stderr": "15:28:39 2109 INFO  Using default --ssl-mode \"require\"\n15:28:39 2109 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:28:39 2109 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:28:39 2109 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:28:39 2109 INFO  Started pg_autoctl postgres service with pid 2114\n15:28:39 2114 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:28:39 2109 INFO  Started pg_autoctl node-init service with pid 2115\n15:28:39 2115 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n15:28:39 2115 INFO  HINT: use `pg_autoctl run` to start the service.\n15:28:39 2109 WARN  pg_autoctl service node-init exited with exit status 0\n15:28:39 2114 INFO  Postgres controller service received signal SIGTERM, terminating\n15:28:39 2109 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:28:39 2109 INFO  Using default --ssl-mode \"require\"",
            "15:28:39 2109 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:28:39 2109 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:28:39 2109 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:28:39 2109 INFO  Started pg_autoctl postgres service with pid 2114",
            "15:28:39 2114 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:28:39 2109 INFO  Started pg_autoctl node-init service with pid 2115",
            "15:28:39 2115 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "15:28:39 2115 INFO  HINT: use `pg_autoctl run` to start the service.",
            "15:28:39 2109 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:28:39 2114 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:28:39 2109 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:28:44,939 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:44,939 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:44,949 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 15:28:44,981 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:44,996 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:45,007 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:54,243 p=26033 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:28:54,251 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:54,271 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:54,303 p=26033 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "810489236724.2488",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031999",
        "end": "2022-03-21 15:28:45.945014",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/810489236724.2488",
        "start": "2022-03-21 15:28:45.913015",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:28:54,304 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:54,313 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:54,337 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 15:28:54,361 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:54,390 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:54,401 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:54,915 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:28:54,926 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:28:54,946 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:54,977 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:54,986 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:55,622 p=26033 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:28:55,632 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:28:55,666 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:55,682 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:55,695 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:56,151 p=26033 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:28:56,160 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 15:28:56,180 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:56,209 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:56,220 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:56,876 p=26033 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:28:56,888 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:28:56,923 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:56,942 p=26033 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.065058",
        "end": "2022-03-21 15:28:57.056204",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:28:56.991146",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/16C7528 |        no |              single |            draining\nnode_2 |     2 | co7-node02:5432 |       0/0 |        no |        wait_standby |        wait_standby\nnode_3 |     3 | co7-node03:5432 |       0/0 |        no |        wait_standby |        wait_standby",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/16C7528 |        no |              single |            draining",
            "node_2 |     2 | co7-node02:5432 |       0/0 |        no |        wait_standby |        wait_standby",
            "node_3 |     3 | co7-node03:5432 |       0/0 |        no |        wait_standby |        wait_standby"
        ]
    }
}
2022-03-21 15:28:56,943 p=26033 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:28:56,954 p=26033 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:28:56,963 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:28:56,998 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:28:57,012 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,019 p=26033 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"ansible_job_id": "114589662261.2790", "changed": false, "child_pid": 2794, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/114589662261.2790", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:32:06,019 p=26033 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"ansible_job_id": "346001150920.1967", "changed": false, "child_pid": 1971, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/346001150920.1967", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:32:06,028 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:32:06,096 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,103 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,115 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 15:32:06,136 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,147 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,157 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:32:06,177 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,187 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,197 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 15:32:06,218 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,228 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,237 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:32:06,257 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,267 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,278 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:32:06,297 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,308 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,318 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 15:32:06,337 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,348 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,358 p=26033 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:32:06,377 p=26033 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:32:06,389 p=26033 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:32:06,423 p=26033 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:32:06,423 p=26033 u=moonja n=ansible | co7-master                 : ok=28   changed=9    unreachable=0    failed=0    skipped=18   rescued=0    ignored=0   
2022-03-21 15:32:06,424 p=26033 u=moonja n=ansible | co7-node01                 : ok=22   changed=6    unreachable=0    failed=0    skipped=24   rescued=0    ignored=0   
2022-03-21 15:32:06,424 p=26033 u=moonja n=ansible | co7-node02                 : ok=12   changed=1    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:32:06,424 p=26033 u=moonja n=ansible | co7-node03                 : ok=12   changed=1    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:34:01,423 p=28846 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:34:01,656 p=28846 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:34:01,660 p=28846 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:34:01,709 p=28846 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:34:01,723 p=28846 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:34:01,750 p=28846 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:34:04,099 p=28846 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:34:04,102 p=28846 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:34:04,132 p=28846 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:34:04,136 p=28846 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:34:04,153 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 15:34:05,081 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:34:05,082 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:34:05,089 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:34:05,098 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:34:05,109 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 15:34:05,790 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:34:05,799 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:34:05,813 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:34:06,212 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:34:06,393 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:34:06,608 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:34:06,802 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:34:06,820 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:34:06,986 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:34:07,207 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:34:07,428 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:34:07,455 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:34:07,601 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:34:07,818 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:34:08,046 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:34:08,066 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:34:08,077 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:34:10,084 p=28846 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:34:10,086 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:34:10,093 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:10,098 p=28846 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:34:10,107 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 15:34:11,735 p=28846 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:34:11,735 p=28846 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:34:11,843 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:34:11,844 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:11,854 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:34:11,887 p=28846 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:34:11,902 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:11,913 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:12,578 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:12,587 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:34:12,619 p=28846 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:34:12,634 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:12,645 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:13,085 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:13,095 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:34:13,813 p=28846 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:34:13,817 p=28846 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:34:13,830 p=28846 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:34:13,841 p=28846 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:34:13,850 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:34:13,916 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:13,929 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:15,134 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:34:15,595 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:15,605 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:34:15,642 p=28846 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:34:15,658 p=28846 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:34:16,336 p=28846 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:34:16,336 p=28846 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:34:16,346 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:34:16,366 p=28846 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:34:16,382 p=28846 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:34:17,049 p=28846 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:34:17,066 p=28846 u=moonja n=ansible | ...ignoring
2022-03-21 15:34:17,067 p=28846 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 15:34:17,067 p=28846 u=moonja n=ansible | ...ignoring
2022-03-21 15:34:17,078 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 15:34:17,099 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:17,101 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:17,105 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:17,109 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:17,110 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:17,112 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:34:17,115 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:17,117 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:17,119 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:17,121 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:17,128 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:17,128 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:34:17,831 p=28846 u=moonja n=ansible | ok: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:34:17,832 p=28846 u=moonja n=ansible | ok: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:34:18,264 p=28846 u=moonja n=ansible | ok: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:34:18,264 p=28846 u=moonja n=ansible | ok: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:34:18,822 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:34:18,824 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:34:19,405 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 15:34:19,407 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 15:34:19,927 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:34:19,928 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:34:20,397 p=28846 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 15:34:20,398 p=28846 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 15:34:20,412 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:34:20,434 p=28846 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:34:20,463 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:20,475 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:20,917 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:34:20,927 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:34:20,947 p=28846 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:34:20,976 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:20,986 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:21,627 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:34:21,637 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:34:21,659 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:21,660 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:21,664 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:21,669 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:21,669 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:21,669 p=28846 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:34:21,693 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:21,695 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:21,700 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:21,700 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:21,703 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:21,704 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:34:21,706 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:21,708 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:21,711 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:21,714 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:21,716 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:21,717 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:34:22,085 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:34:22,554 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:34:23,239 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:34:23,817 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 15:34:24,252 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:34:24,749 p=28846 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 15:34:24,761 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:34:24,807 p=28846 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:34:24,808 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:24,819 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:25,236 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:25,245 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:34:25,291 p=28846 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:34:25,292 p=28846 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:34:25,303 p=28846 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:34:25,953 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:34:25,963 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:34:26,000 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:26,002 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:26,005 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:26,009 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:26,013 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:26,014 p=28846 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:34:26,015 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:26,016 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:26,019 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:26,022 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:26,024 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:26,025 p=28846 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:34:26,030 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:34:26,033 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:34:26,035 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:34:26,038 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:34:26,041 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:34:26,041 p=28846 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:34:26,501 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:34:26,910 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:34:27,314 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:34:27,728 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 15:34:28,180 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:34:28,692 p=28846 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-21 15:34:28,706 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 15:35:02,623 p=28846 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:35:02,632 p=28846 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:35:04,332 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:04,767 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:35:04,778 p=28846 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:35:05,332 p=28846 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:35:05,332 p=28846 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:35:05,355 p=28846 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:05,355 p=28846 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:35:05,403 p=28846 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:35:05,404 p=28846 u=moonja n=ansible | co7-master                 : ok=14   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2022-03-21 15:35:05,404 p=28846 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:35:05,404 p=28846 u=moonja n=ansible | co7-node02                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 15:35:05,404 p=28846 u=moonja n=ansible | co7-node03                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 15:35:05,977 p=30373 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:35:06,217 p=30373 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:35:06,222 p=30373 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:35:06,268 p=30373 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:35:06,281 p=30373 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:35:06,309 p=30373 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:35:08,448 p=30373 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:35:08,450 p=30373 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:35:08,452 p=30373 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:35:08,457 p=30373 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:35:08,475 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 15:35:09,676 p=30373 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 15:35:09,678 p=30373 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 15:35:09,684 p=30373 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 15:35:09,691 p=30373 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 15:35:10,369 p=30373 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:35:10,402 p=30373 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:35:10,403 p=30373 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:35:11,000 p=30373 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:35:11,231 p=30373 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 15:35:11,262 p=30373 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 15:35:11,379 p=30373 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 15:35:11,847 p=30373 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 15:35:11,861 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 15:35:13,119 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:35:13,139 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:35:13,153 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:13,164 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:35:13,174 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 15:35:14,030 p=30373 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:35:14,041 p=30373 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:35:14,070 p=30373 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:35:14,095 p=30373 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:35:14,106 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 15:35:14,749 p=30373 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:35:14,805 p=30373 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:35:14,822 p=30373 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:35:15,270 p=30373 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:35:15,364 p=30373 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:35:15,394 p=30373 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:35:15,462 p=30373 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:35:15,907 p=30373 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:35:15,988 p=30373 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:35:16,011 p=30373 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:35:16,157 p=30373 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:35:16,541 p=30373 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:35:16,601 p=30373 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:35:16,663 p=30373 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:35:16,780 p=30373 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:35:17,752 p=30373 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:35:17,764 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:35:19,411 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:35:19,414 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:35:19,426 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:19,432 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:35:19,442 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:35:21,410 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:35:21,418 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:35:21,421 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:21,454 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:35:21,464 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 15:35:28,284 p=30373 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 15:35:28,292 p=30373 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 15:35:28,336 p=30373 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 15:35:28,343 p=30373 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 15:35:28,352 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 15:35:56,313 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:35:57,140 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:35:57,297 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:57,630 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:35:57,642 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:35:57,691 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:35:57,692 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:35:57,703 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:35:58,264 p=30373 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 15:35:58,264 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:58,276 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:35:58,313 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 10.17 (VMware Postgres 10.17.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 15:35:58,330 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:35:58,330 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:35:58,342 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:35:58,351 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:35:58,382 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:35:58,397 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:35:58,410 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:35:58,825 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:35:58,837 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:35:58,874 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 10.17 (VMware Postgres 10.17.0)"
}
2022-03-21 15:35:58,890 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:35:58,892 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:35:58,902 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:35:58,912 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:35:59,569 p=30373 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:35:59,569 p=30373 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:35:59,573 p=30373 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:35:59,576 p=30373 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:35:59,586 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 15:35:59,634 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:35:59,639 p=30373 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:35:59,653 p=30373 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:35:59,671 p=30373 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:35:59,681 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:35:59,729 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:35:59,734 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:35:59,749 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:35:59,765 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:35:59,775 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:35:59,811 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:35:59,828 p=30373 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:35:59,830 p=30373 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:35:59,841 p=30373 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:35:59,851 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 15:35:59,884 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:35:59,899 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:35:59,911 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:18,540 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:18,549 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:18,586 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "703064711446.5610",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:15.770207",
        "end": "2022-03-21 15:36:16.542861",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/703064711446.5610",
        "start": "2022-03-21 15:36:00.772654",
        "started": 1,
        "stderr": "15:36:00 5620 INFO  Using default --ssl-mode \"require\"\n15:36:00 5620 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:36:00 5620 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:36:00 5620 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:36:00 5620 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n15:36:00 5620 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n15:36:06 5620 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n15:36:06 5620 INFO  Started pg_autoctl postgres service with pid 5767\n15:36:06 5767 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n15:36:06 5620 INFO  Started pg_autoctl monitor-init service with pid 5768\n15:36:06 5768 INFO  Granting connection privileges on 192.168.0.0/24\n15:36:06 5772 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:36:07 5767 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 5772\n15:36:13 5768 WARN  NOTICE:  installing required extension \"btree_gist\"\n15:36:14 5768 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n15:36:14 5768 INFO  Monitor has been successfully initialized.\n15:36:14 5620 WARN  pg_autoctl service monitor-init exited with exit status 0\n15:36:14 5767 INFO  Postgres controller service received signal SIGTERM, terminating\n15:36:14 5767 INFO  Stopping pg_autoctl postgres service\n15:36:14 5767 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n15:36:14 5620 INFO  Waiting for subprocesses to terminate.\n15:36:16 5620 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:36:00 5620 INFO  Using default --ssl-mode \"require\"",
            "15:36:00 5620 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:36:00 5620 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:36:00 5620 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:36:00 5620 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "15:36:00 5620 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "15:36:06 5620 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "15:36:06 5620 INFO  Started pg_autoctl postgres service with pid 5767",
            "15:36:06 5767 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "15:36:06 5620 INFO  Started pg_autoctl monitor-init service with pid 5768",
            "15:36:06 5768 INFO  Granting connection privileges on 192.168.0.0/24",
            "15:36:06 5772 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "15:36:07 5767 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 5772",
            "15:36:13 5768 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "15:36:14 5768 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "15:36:14 5768 INFO  Monitor has been successfully initialized.",
            "15:36:14 5620 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "15:36:14 5767 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:36:14 5767 INFO  Stopping pg_autoctl postgres service",
            "15:36:14 5767 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "15:36:14 5620 INFO  Waiting for subprocesses to terminate.",
            "15:36:16 5620 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:36:18,602 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:18,603 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:18,615 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:18,625 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 15:36:18,658 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:18,674 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:18,686 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:25,000 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:25,009 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 15:36:25,059 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:25,060 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:25,069 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:25,610 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:25,623 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:36:25,674 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:25,675 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:25,686 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:26,768 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:26,795 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:26,833 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "-.mount systemd-journald.socket basic.target system.slice",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount basic.target system.slice",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:36:26,849 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:26,850 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:26,862 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:26,871 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:36:26,905 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:26,920 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:26,932 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:27,643 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:27,652 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 15:36:27,701 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:27,702 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:27,713 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:28,146 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:28,155 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:28,193 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.035123",
        "end": "2022-03-21 15:36:28.449911",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:36:28.414788",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres  6730     1  0 15:36 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres  6733  6730  0 15:36 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres  6734  6730  0 15:36 ?        00:00:00 pg_autoctl: monitor listener\npostgres  6764  6733  2 15:36 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\njomoon    6980 30372  0 15:36 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=jaksibekaniigddrvqhiufcxvwxkjxia] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-jaksibekaniigddrvqhiufcxvwxkjxia ; /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py' && sleep 0\nroot      7004  6980  0 15:36 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=jaksibekaniigddrvqhiufcxvwxkjxia] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-jaksibekaniigddrvqhiufcxvwxkjxia ; /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py\npostgres  7005  7004  0 15:36 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-jaksibekaniigddrvqhiufcxvwxkjxia ; /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py\npostgres  7006  7005  0 15:36 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py\npostgres  7008  7006  0 15:36 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres  7009  7008  0 15:36 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres  7010  7009  0 15:36 pts/0    00:00:00 ps -ef\npostgres  7011  7009  0 15:36 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres  6730     1  0 15:36 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres  6733  6730  0 15:36 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres  6734  6730  0 15:36 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres  6764  6733  2 15:36 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "jomoon    6980 30372  0 15:36 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=jaksibekaniigddrvqhiufcxvwxkjxia] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-jaksibekaniigddrvqhiufcxvwxkjxia ; /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py' && sleep 0",
            "root      7004  6980  0 15:36 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=jaksibekaniigddrvqhiufcxvwxkjxia] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-jaksibekaniigddrvqhiufcxvwxkjxia ; /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py",
            "postgres  7005  7004  0 15:36 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-jaksibekaniigddrvqhiufcxvwxkjxia ; /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py",
            "postgres  7006  7005  0 15:36 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647844587.7501929-31897-5610123453887/AnsiballZ_command.py",
            "postgres  7008  7006  0 15:36 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres  7009  7008  0 15:36 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres  7010  7009  0 15:36 pts/0    00:00:00 ps -ef",
            "postgres  7011  7009  0 15:36 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 15:36:28,209 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:28,209 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:28,222 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:28,231 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 15:36:28,278 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:28,279 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:28,290 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:28,832 p=30373 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:36:28,842 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:28,876 p=30373 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.034482",
        "end": "2022-03-21 15:36:29.140799",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:36:29.106317",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-21 15:36:28,892 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:36:28,892 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:28,905 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:28,914 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:36:28,934 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:28,964 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:28,975 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:48,196 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:36:48,205 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:48,241 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:48,261 p=30373 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "147064336873.10466",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:10.689552",
        "end": "2022-03-21 15:36:42.304102",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/147064336873.10466",
        "start": "2022-03-21 15:36:31.614550",
        "started": 1,
        "stderr": "15:36:31 10476 INFO  Using default --ssl-mode \"require\"\n15:36:31 10476 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:36:31 10476 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:36:31 10476 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:36:31 10476 INFO  Started pg_autoctl postgres service with pid 10478\n15:36:31 10478 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:36:31 10476 INFO  Started pg_autoctl node-init service with pid 10479\n15:36:31 10479 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n15:36:31 10479 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:36:32 10479 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:36:32 10479 INFO  Successfully registered as \"single\" to the monitor.\n15:36:32 10479 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n15:36:32 10479 INFO  Initialising postgres as a primary\n15:36:32 10479 INFO  Initialising a PostgreSQL cluster at \"ha\"\n15:36:32 10479 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n15:36:35 10479 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:36:35 10479 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:36:35 10479 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:36:35 10479 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:36:35 10479 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:36:36 10631 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:36:37 10478 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 10631\n15:36:37 10479 INFO  CREATE DATABASE appdb;\n15:36:38 10479 INFO  CREATE EXTENSION pg_stat_statements;\n15:36:38 10479 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:36:38 10479 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n15:36:38 10479 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:36:38 10479 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n15:36:38 10479 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:36:38 10479 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n15:36:38 10479 INFO  Transition complete: current state is now \"single\"\n15:36:39 10479 INFO  keeper has been successfully initialized.\n15:36:39 10476 WARN  pg_autoctl service node-init exited with exit status 0\n15:36:39 10478 INFO  Postgres controller service received signal SIGTERM, terminating\n15:36:39 10478 INFO  Stopping pg_autoctl postgres service\n15:36:39 10478 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:36:40 10476 INFO  Waiting for subprocesses to terminate.\n15:36:42 10476 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:36:31 10476 INFO  Using default --ssl-mode \"require\"",
            "15:36:31 10476 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:36:31 10476 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:36:31 10476 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:36:31 10476 INFO  Started pg_autoctl postgres service with pid 10478",
            "15:36:31 10478 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:36:31 10476 INFO  Started pg_autoctl node-init service with pid 10479",
            "15:36:31 10479 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "15:36:31 10479 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:36:32 10479 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:36:32 10479 INFO  Successfully registered as \"single\" to the monitor.",
            "15:36:32 10479 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "15:36:32 10479 INFO  Initialising postgres as a primary",
            "15:36:32 10479 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "15:36:32 10479 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "15:36:35 10479 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:36:35 10479 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:36:35 10479 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:36:35 10479 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:36:35 10479 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:36:36 10631 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:36:37 10478 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 10631",
            "15:36:37 10479 INFO  CREATE DATABASE appdb;",
            "15:36:38 10479 INFO  CREATE EXTENSION pg_stat_statements;",
            "15:36:38 10479 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:36:38 10479 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "15:36:38 10479 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:36:38 10479 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "15:36:38 10479 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:36:38 10479 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "15:36:38 10479 INFO  Transition complete: current state is now \"single\"",
            "15:36:39 10479 INFO  keeper has been successfully initialized.",
            "15:36:39 10476 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:36:39 10478 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:36:39 10478 INFO  Stopping pg_autoctl postgres service",
            "15:36:39 10478 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:36:40 10476 INFO  Waiting for subprocesses to terminate.",
            "15:36:42 10476 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:36:48,262 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:48,272 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:48,281 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 15:36:48,314 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:48,330 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:48,342 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:55,667 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:36:55,675 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:55,696 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:55,729 p=30373 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "191124945469.11065",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031174",
        "end": "2022-03-21 15:36:50.133874",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/191124945469.11065",
        "start": "2022-03-21 15:36:50.102700",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:36:55,730 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:55,740 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:55,750 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 15:36:55,770 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:55,800 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:55,811 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:56,290 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:36:56,301 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:36:56,335 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:56,351 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:56,363 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:57,104 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:36:57,116 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:36:57,151 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:57,168 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:57,181 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:57,708 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:36:57,718 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 15:36:57,739 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:57,769 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:57,780 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:58,308 p=30373 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:36:58,319 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:36:58,355 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:58,374 p=30373 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.066581",
        "end": "2022-03-21 15:36:58.610714",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:36:58.544133",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/16C4E38 |        no |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/16C4E38 |        no |              single |              single"
        ]
    }
}
2022-03-21 15:36:58,375 p=30373 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:36:58,384 p=30373 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:36:58,395 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:36:58,431 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:36:58,444 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:15,885 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:37:15,930 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:37:15,940 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:37:15,978 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:15,993 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:16,033 p=30373 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "909863197301.12872",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:16.111802",
        "end": "2022-03-21 15:37:15.541661",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/909863197301.12872",
        "start": "2022-03-21 15:36:59.429859",
        "started": 1,
        "stderr": "15:36:59 12882 INFO  Using default --ssl-mode \"require\"\n15:36:59 12882 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:36:59 12882 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:36:59 12882 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:36:59 12882 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n15:36:59 12882 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n15:36:59 12882 INFO  Started pg_autoctl postgres service with pid 12884\n15:36:59 12884 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:36:59 12882 INFO  Started pg_autoctl node-init service with pid 12885\n15:37:00 12885 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"\n15:37:00 12885 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:37:00 12885 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:37:00 12885 INFO  Successfully registered as \"wait_standby\" to the monitor.\n15:37:00 12885 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n15:37:00 12885 INFO  Transition complete: current state is now \"wait_standby\"\n15:37:02 12885 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n15:37:03 12885 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n15:37:03 12885 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n15:37:03 12885 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n15:37:03 12885 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n15:37:03 12885 INFO  Initialising PostgreSQL as a hot standby\n15:37:03 12885 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3\n15:37:03 12885 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n15:37:05 12885 INFO  pg_basebackup: checkpoint completed\n15:37:05 12885 INFO  pg_basebackup: write-ahead log start point: 0/20000D0 on timeline 1\n15:37:05 12885 INFO  pg_basebackup: starting background WAL receiver\n15:37:05 12885 INFO      0/32432 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)\r\n15:37:06 12885 INFO   1655/32432 kB (5%), 0/1 tablespace (.../pgsql/backup/node_3/base/1/1249)\r\n15:37:08 12885 INFO  32441/32441 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)\r32441/32441 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)\r32441/32441 kB (100%), 1/1 tablespace                                         \r\n15:37:08 12885 INFO  pg_basebackup: write-ahead log end point: 0/3000050\n15:37:08 12885 INFO  pg_basebackup: waiting for background process to finish streaming ...\n15:37:10 12885 INFO  pg_basebackup: base backup completed\n15:37:10 12885 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"\n15:37:10 12885 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"\n15:37:11 13110 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:37:13 12884 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 13110\n15:37:13 12885 INFO  PostgreSQL started on port 5432\n15:37:13 12885 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n15:37:13 12885 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:37:13 12885 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:37:13 12885 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:37:13 12885 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:37:13 12885 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n15:37:13 12885 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:37:13 12885 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.\n15:37:13 12885 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:37:13 12885 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"\n15:37:13 12885 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)\n15:37:13 12885 INFO  Transition complete: current state is now \"catchingup\"\n15:37:14 12885 INFO  keeper has been successfully initialized.\n15:37:14 12882 WARN  pg_autoctl service node-init exited with exit status 0\n15:37:14 12884 INFO  Postgres controller service received signal SIGTERM, terminating\n15:37:14 12884 INFO  Stopping pg_autoctl postgres service\n15:37:14 12884 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:37:14 12882 INFO  Waiting for subprocesses to terminate.\n15:37:15 12882 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:36:59 12882 INFO  Using default --ssl-mode \"require\"",
            "15:36:59 12882 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:36:59 12882 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:36:59 12882 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:36:59 12882 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "15:36:59 12882 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "15:36:59 12882 INFO  Started pg_autoctl postgres service with pid 12884",
            "15:36:59 12884 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:36:59 12882 INFO  Started pg_autoctl node-init service with pid 12885",
            "15:37:00 12885 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"",
            "15:37:00 12885 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:37:00 12885 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:37:00 12885 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "15:37:00 12885 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "15:37:00 12885 INFO  Transition complete: current state is now \"wait_standby\"",
            "15:37:02 12885 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "15:37:03 12885 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "15:37:03 12885 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "15:37:03 12885 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "15:37:03 12885 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "15:37:03 12885 INFO  Initialising PostgreSQL as a hot standby",
            "15:37:03 12885 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3",
            "15:37:03 12885 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "15:37:05 12885 INFO  pg_basebackup: checkpoint completed",
            "15:37:05 12885 INFO  pg_basebackup: write-ahead log start point: 0/20000D0 on timeline 1",
            "15:37:05 12885 INFO  pg_basebackup: starting background WAL receiver",
            "15:37:05 12885 INFO      0/32432 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)",
            "15:37:06 12885 INFO   1655/32432 kB (5%), 0/1 tablespace (.../pgsql/backup/node_3/base/1/1249)",
            "15:37:08 12885 INFO  32441/32441 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)",
            "32441/32441 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)",
            "32441/32441 kB (100%), 1/1 tablespace                                         ",
            "15:37:08 12885 INFO  pg_basebackup: write-ahead log end point: 0/3000050",
            "15:37:08 12885 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "15:37:10 12885 INFO  pg_basebackup: base backup completed",
            "15:37:10 12885 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"",
            "15:37:10 12885 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"",
            "15:37:11 13110 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:37:13 12884 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 13110",
            "15:37:13 12885 INFO  PostgreSQL started on port 5432",
            "15:37:13 12885 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "15:37:13 12885 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:37:13 12885 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:37:13 12885 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:37:13 12885 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:37:13 12885 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "15:37:13 12885 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:37:13 12885 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.",
            "15:37:13 12885 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:37:13 12885 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"",
            "15:37:13 12885 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)",
            "15:37:13 12885 INFO  Transition complete: current state is now \"catchingup\"",
            "15:37:14 12885 INFO  keeper has been successfully initialized.",
            "15:37:14 12882 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:37:14 12884 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:37:14 12884 INFO  Stopping pg_autoctl postgres service",
            "15:37:14 12884 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:37:14 12882 INFO  Waiting for subprocesses to terminate.",
            "15:37:15 12882 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:37:16,037 p=30373 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "731234359094.12130",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:14.704890",
        "end": "2022-03-21 15:37:14.141308",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/731234359094.12130",
        "start": "2022-03-21 15:36:59.436418",
        "started": 1,
        "stderr": "15:36:59 12140 INFO  Using default --ssl-mode \"require\"\n15:36:59 12140 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:36:59 12140 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:36:59 12140 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:36:59 12140 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n15:36:59 12140 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n15:36:59 12140 INFO  Started pg_autoctl postgres service with pid 12142\n15:36:59 12140 INFO  Started pg_autoctl node-init service with pid 12143\n15:36:59 12142 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:36:59 12143 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"\n15:36:59 12143 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:36:59 12143 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:37:00 12143 INFO  Successfully registered as \"wait_standby\" to the monitor.\n15:37:00 12143 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n15:37:00 12143 INFO  Transition complete: current state is now \"wait_standby\"\n15:37:01 12143 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby\n15:37:02 12143 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n15:37:02 12143 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n15:37:02 12143 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n15:37:03 12143 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n15:37:03 12143 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n15:37:03 12143 INFO  Initialising PostgreSQL as a hot standby\n15:37:03 12143 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2\n15:37:03 12143 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n15:37:05 12143 INFO  pg_basebackup: checkpoint completed\n15:37:05 12143 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1\n15:37:05 12143 INFO  pg_basebackup: starting background WAL receiver\n15:37:05 12143 INFO      0/32432 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)\r\n15:37:06 12143 INFO  13078/32432 kB (40%), 0/1 tablespace (...ql/backup/node_2/base/13807/3455)\r\n15:37:06 12143 INFO  32441/32441 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\r32441/32441 kB (100%), 1/1 tablespace                                         \r\n15:37:06 12143 INFO  pg_basebackup: write-ahead log end point: 0/20001A0\n15:37:06 12143 INFO  pg_basebackup: waiting for background process to finish streaming ...\n15:37:09 12143 INFO  pg_basebackup: base backup completed\n15:37:09 12143 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"\n15:37:09 12143 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"\n15:37:09 12281 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:37:11 12142 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 12281\n15:37:11 12143 INFO  PostgreSQL started on port 5432\n15:37:11 12143 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n15:37:11 12143 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:37:11 12143 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:37:11 12143 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:37:11 12143 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:37:11 12143 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n15:37:11 12143 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:37:11 12143 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.\n15:37:11 12143 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:37:11 12143 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"\n15:37:11 12143 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)\n15:37:11 12143 INFO  Transition complete: current state is now \"catchingup\"\n15:37:12 12143 INFO  keeper has been successfully initialized.\n15:37:12 12140 WARN  pg_autoctl service node-init exited with exit status 0\n15:37:12 12142 INFO  Postgres controller service received signal SIGTERM, terminating\n15:37:12 12142 INFO  Stopping pg_autoctl postgres service\n15:37:12 12142 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:37:13 12140 INFO  Waiting for subprocesses to terminate.\n15:37:14 12140 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:36:59 12140 INFO  Using default --ssl-mode \"require\"",
            "15:36:59 12140 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:36:59 12140 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:36:59 12140 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:36:59 12140 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "15:36:59 12140 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "15:36:59 12140 INFO  Started pg_autoctl postgres service with pid 12142",
            "15:36:59 12140 INFO  Started pg_autoctl node-init service with pid 12143",
            "15:36:59 12142 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:36:59 12143 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"",
            "15:36:59 12143 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:36:59 12143 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:37:00 12143 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "15:37:00 12143 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "15:37:00 12143 INFO  Transition complete: current state is now \"wait_standby\"",
            "15:37:01 12143 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby",
            "15:37:02 12143 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "15:37:02 12143 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "15:37:02 12143 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "15:37:03 12143 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "15:37:03 12143 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "15:37:03 12143 INFO  Initialising PostgreSQL as a hot standby",
            "15:37:03 12143 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2",
            "15:37:03 12143 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "15:37:05 12143 INFO  pg_basebackup: checkpoint completed",
            "15:37:05 12143 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1",
            "15:37:05 12143 INFO  pg_basebackup: starting background WAL receiver",
            "15:37:05 12143 INFO      0/32432 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)",
            "15:37:06 12143 INFO  13078/32432 kB (40%), 0/1 tablespace (...ql/backup/node_2/base/13807/3455)",
            "15:37:06 12143 INFO  32441/32441 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "32441/32441 kB (100%), 1/1 tablespace                                         ",
            "15:37:06 12143 INFO  pg_basebackup: write-ahead log end point: 0/20001A0",
            "15:37:06 12143 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "15:37:09 12143 INFO  pg_basebackup: base backup completed",
            "15:37:09 12143 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"",
            "15:37:09 12143 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"",
            "15:37:09 12281 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:37:11 12142 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 12281",
            "15:37:11 12143 INFO  PostgreSQL started on port 5432",
            "15:37:11 12143 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "15:37:11 12143 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:37:11 12143 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:37:11 12143 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:37:11 12143 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:37:11 12143 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "15:37:11 12143 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:37:11 12143 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.",
            "15:37:11 12143 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:37:11 12143 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"",
            "15:37:11 12143 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)",
            "15:37:11 12143 INFO  Transition complete: current state is now \"catchingup\"",
            "15:37:12 12143 INFO  keeper has been successfully initialized.",
            "15:37:12 12140 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:37:12 12142 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:37:12 12142 INFO  Stopping pg_autoctl postgres service",
            "15:37:12 12142 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:37:13 12140 INFO  Waiting for subprocesses to terminate.",
            "15:37:14 12140 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:37:16,049 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 15:37:16,085 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:16,098 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:22,520 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:37:22,520 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:37:22,530 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:37:22,554 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:22,571 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:22,590 p=30373 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "310473340203.13442",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032281",
        "end": "2022-03-21 15:37:17.080536",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/310473340203.13442",
        "start": "2022-03-21 15:37:17.048255",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:37:22,603 p=30373 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "56300892034.12699",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032562",
        "end": "2022-03-21 15:37:17.087789",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/56300892034.12699",
        "start": "2022-03-21 15:37:17.055227",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:37:22,614 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 15:37:22,634 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:22,650 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:23,245 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:37:23,245 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:37:23,254 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:37:23,274 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:23,291 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:24,118 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:37:24,126 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:37:24,138 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:37:24,158 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:24,175 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:24,743 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:37:24,743 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:37:24,752 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 15:37:24,773 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:24,803 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:25,443 p=30373 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:37:25,444 p=30373 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:37:25,454 p=30373 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:37:25,474 p=30373 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:37:25,491 p=30373 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:37:25,531 p=30373 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.070398",
        "end": "2022-03-21 15:37:25.750491",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:37:25.680093",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/3080000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/3080000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 15:37:25,532 p=30373 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.067967",
        "end": "2022-03-21 15:37:25.745981",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:37:25.678014",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/3080000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/3080000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 15:37:25,575 p=30373 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:37:25,575 p=30373 u=moonja n=ansible | co7-master                 : ok=27   changed=15   unreachable=0    failed=0    skipped=19   rescued=0    ignored=0   
2022-03-21 15:37:25,575 p=30373 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:37:25,576 p=30373 u=moonja n=ansible | co7-node02                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:37:25,576 p=30373 u=moonja n=ansible | co7-node03                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:38:51,135 p=33240 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:38:51,368 p=33240 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:38:51,372 p=33240 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:38:51,423 p=33240 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:38:51,436 p=33240 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:38:51,463 p=33240 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:38:53,685 p=33240 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:38:53,780 p=33240 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:38:53,828 p=33240 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:38:53,831 p=33240 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:38:53,847 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 15:38:54,892 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:38:54,896 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:38:54,907 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:38:54,924 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:38:54,935 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 15:38:55,660 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:38:55,665 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:38:55,667 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:38:55,670 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:38:56,490 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:38:56,490 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:38:56,513 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:38:56,520 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:38:57,108 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:38:57,108 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:38:57,122 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:38:57,140 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:38:57,728 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:38:57,759 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:38:58,362 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:38:58,363 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:38:58,376 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:39:00,448 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:00,454 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:00,473 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:00,480 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:00,490 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 15:39:02,024 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:02,077 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:02,111 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:02,120 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:02,132 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:39:02,165 p=33240 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:39:02,180 p=33240 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:39:02,191 p=33240 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:39:02,864 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:02,876 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:39:02,925 p=33240 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:39:02,925 p=33240 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:39:02,935 p=33240 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:39:03,462 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:03,473 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:39:04,268 p=33240 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:39:04,269 p=33240 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:39:04,272 p=33240 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:39:04,276 p=33240 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:39:04,286 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:39:06,165 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:06,203 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:06,735 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:06,793 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:06,803 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:39:06,823 p=33240 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:39:06,838 p=33240 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:39:07,517 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:07,517 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:07,525 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:39:07,545 p=33240 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:39:07,574 p=33240 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:39:08,330 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:08,345 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:08,355 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 15:39:08,377 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:08,378 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:08,382 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:08,387 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:08,391 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:08,393 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:39:08,394 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:08,394 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:08,396 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:08,401 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:08,401 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:08,402 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:39:09,075 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:39:09,076 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:39:09,487 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:39:09,488 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:39:09,908 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:39:09,909 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:39:10,395 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 15:39:10,395 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 15:39:10,910 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:39:10,974 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:39:11,364 p=33240 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 15:39:11,429 p=33240 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 15:39:11,442 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:39:11,462 p=33240 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:39:11,491 p=33240 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:39:11,502 p=33240 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:39:12,127 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:12,139 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:39:12,160 p=33240 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:39:12,190 p=33240 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:39:12,201 p=33240 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:39:13,026 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:13,036 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:39:13,059 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:13,061 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:13,065 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:13,068 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:13,069 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:13,070 p=33240 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:39:13,094 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:13,095 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:13,101 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:13,102 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:13,102 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:13,103 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:39:13,106 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:13,112 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:13,112 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:13,113 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:13,116 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:13,117 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:39:13,608 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:39:14,081 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:39:14,538 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:39:15,008 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 15:39:15,470 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:39:15,987 p=33240 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 15:39:16,002 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:39:16,034 p=33240 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:39:16,050 p=33240 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:39:16,062 p=33240 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:39:16,572 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:16,584 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:39:16,622 p=33240 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:39:16,637 p=33240 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:39:16,649 p=33240 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:39:17,303 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:17,315 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:39:17,354 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:17,356 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:17,359 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:17,363 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:17,368 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:17,368 p=33240 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:39:17,369 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:17,370 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:17,376 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:17,376 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:17,377 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:17,379 p=33240 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:39:17,385 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:39:17,387 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:39:17,390 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:39:17,392 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:39:17,395 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:39:17,395 p=33240 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:39:17,892 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:39:18,513 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:39:19,020 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:39:19,507 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 15:39:19,994 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:39:20,510 p=33240 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-21 15:39:20,523 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 15:39:49,088 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:49,098 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:50,283 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:50,608 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:50,620 p=33240 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:39:51,081 p=33240 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:39:51,085 p=33240 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:39:51,092 p=33240 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:39:51,112 p=33240 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:39:51,158 p=33240 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:39:51,158 p=33240 u=moonja n=ansible | co7-master                 : ok=14   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2022-03-21 15:39:51,158 p=33240 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:39:51,158 p=33240 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:39:51,158 p=33240 u=moonja n=ansible | co7-node03                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:43:05,256 p=34764 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:43:05,501 p=34764 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:43:05,505 p=34764 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:43:05,555 p=34764 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:43:05,568 p=34764 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:43:05,599 p=34764 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:43:07,766 p=34764 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:43:07,844 p=34764 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:43:07,848 p=34764 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:43:07,943 p=34764 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:43:07,962 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 15:43:08,964 p=34764 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 15:43:08,975 p=34764 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 15:43:08,985 p=34764 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 15:43:09,020 p=34764 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 15:43:09,699 p=34764 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:43:09,703 p=34764 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:43:09,751 p=34764 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:43:09,795 p=34764 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:43:15,394 p=34764 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 15:43:15,539 p=34764 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 15:43:15,548 p=34764 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 15:43:15,961 p=34764 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 15:43:15,974 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 15:43:17,340 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:43:17,357 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:43:17,359 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:43:18,271 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:43:18,281 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 15:43:19,158 p=34764 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:43:19,160 p=34764 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:43:19,161 p=34764 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:43:19,167 p=34764 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:43:19,177 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 15:43:19,853 p=34764 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:43:19,869 p=34764 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:43:19,897 p=34764 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:43:19,897 p=34764 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:43:20,458 p=34764 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:43:20,461 p=34764 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:43:20,522 p=34764 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:43:20,527 p=34764 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:43:21,070 p=34764 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:43:21,080 p=34764 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:43:21,137 p=34764 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:43:21,147 p=34764 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:43:21,821 p=34764 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:43:21,864 p=34764 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:43:21,867 p=34764 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:43:21,871 p=34764 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:43:21,882 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:43:23,525 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:43:23,527 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:43:23,529 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:43:23,544 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:43:23,556 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:43:25,176 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:43:25,185 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:43:25,189 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:43:25,579 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:43:25,588 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 15:43:32,429 p=34764 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 15:43:32,638 p=34764 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 15:43:32,686 p=34764 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 15:43:33,308 p=34764 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 15:43:33,318 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 15:44:06,592 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:44:07,610 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:44:07,891 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:44:08,241 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:08,253 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:44:08,300 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:08,378 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:08,401 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:09,094 p=34764 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 15:44:09,095 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:09,106 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:09,140 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 12.7 (VMware Postgres 12.7.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 15:44:09,158 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:09,177 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:09,199 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:09,223 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:44:09,273 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:09,274 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:09,286 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:09,762 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:09,771 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:09,808 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 12.7 (VMware Postgres 12.7.0)"
}
2022-03-21 15:44:09,824 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:09,826 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:09,835 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:09,846 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:44:10,618 p=34764 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:44:10,621 p=34764 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:44:10,632 p=34764 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:44:10,636 p=34764 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:44:10,644 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 15:44:10,695 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:44:10,700 p=34764 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:44:10,714 p=34764 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:44:10,733 p=34764 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:44:10,746 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:44:10,794 p=34764 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:44:10,800 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:10,816 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:10,831 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:10,842 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:10,878 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:44:10,894 p=34764 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:44:10,896 p=34764 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:44:10,911 p=34764 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:44:10,921 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 15:44:10,970 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:10,970 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:10,982 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:27,963 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:27,971 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:28,011 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "16275776329.15104",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:14.731656",
        "end": "2022-03-21 15:44:26.713884",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/16275776329.15104",
        "start": "2022-03-21 15:44:11.982228",
        "started": 1,
        "stderr": "15:44:12 15114 INFO  Using default --ssl-mode \"require\"\n15:44:12 15114 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:44:12 15114 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:44:12 15114 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:44:12 15114 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n15:44:12 15114 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n15:44:14 15114 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n15:44:14 15114 INFO  Started pg_autoctl postgres service with pid 15131\n15:44:14 15131 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n15:44:14 15114 INFO  Started pg_autoctl monitor-init service with pid 15132\n15:44:14 15132 INFO  Granting connection privileges on 192.168.0.0/24\n15:44:14 15137 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:44:15 15131 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 15137\n15:44:19 15132 WARN  NOTICE:  installing required extension \"btree_gist\"\n15:44:22 15132 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n15:44:22 15132 INFO  Monitor has been successfully initialized.\n15:44:22 15114 WARN  pg_autoctl service monitor-init exited with exit status 0\n15:44:22 15131 INFO  Postgres controller service received signal SIGTERM, terminating\n15:44:22 15131 INFO  Stopping pg_autoctl postgres service\n15:44:22 15131 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n15:44:23 15114 INFO  Waiting for subprocesses to terminate.\n15:44:26 15114 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:44:12 15114 INFO  Using default --ssl-mode \"require\"",
            "15:44:12 15114 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:44:12 15114 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:44:12 15114 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:44:12 15114 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "15:44:12 15114 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "15:44:14 15114 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "15:44:14 15114 INFO  Started pg_autoctl postgres service with pid 15131",
            "15:44:14 15131 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "15:44:14 15114 INFO  Started pg_autoctl monitor-init service with pid 15132",
            "15:44:14 15132 INFO  Granting connection privileges on 192.168.0.0/24",
            "15:44:14 15137 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "15:44:15 15131 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 15137",
            "15:44:19 15132 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "15:44:22 15132 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "15:44:22 15132 INFO  Monitor has been successfully initialized.",
            "15:44:22 15114 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "15:44:22 15131 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:44:22 15131 INFO  Stopping pg_autoctl postgres service",
            "15:44:22 15131 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "15:44:23 15114 INFO  Waiting for subprocesses to terminate.",
            "15:44:26 15114 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:44:28,027 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:28,028 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:28,041 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:28,050 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 15:44:28,083 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:28,099 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:28,110 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:34,371 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:34,380 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 15:44:34,415 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:34,430 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:34,443 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:34,860 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:34,870 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:44:34,905 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:34,921 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:34,934 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:35,977 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:35,989 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:36,043 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "basic.target systemd-journald.socket -.mount system.slice",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount system.slice basic.target",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:44:36,059 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:36,060 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:36,072 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:36,082 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:44:36,117 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:36,132 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:36,145 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:36,822 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:36,833 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 15:44:36,868 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:36,884 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:36,896 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:37,361 p=34764 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:44:37,373 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:37,414 p=34764 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.034640",
        "end": "2022-03-21 15:44:37.656557",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:44:37.621917",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 16226     1  0 15:44 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 16229 16226  0 15:44 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 16230 16226  0 15:44 ?        00:00:00 pg_autoctl: monitor listener\npostgres 16259 16229  0 15:44 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\njomoon   16475 11314  0 15:44 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=dvoztlotpscibtfalyosphwaluwtnqex] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-dvoztlotpscibtfalyosphwaluwtnqex ; /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py' && sleep 0\nroot     16499 16475  0 15:44 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=dvoztlotpscibtfalyosphwaluwtnqex] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-dvoztlotpscibtfalyosphwaluwtnqex ; /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py\npostgres 16500 16499  0 15:44 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-dvoztlotpscibtfalyosphwaluwtnqex ; /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py\npostgres 16501 16500  0 15:44 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py\npostgres 16503 16501  0 15:44 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 16504 16503  0 15:44 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 16505 16504  0 15:44 pts/0    00:00:00 ps -ef\npostgres 16506 16504  0 15:44 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 16226     1  0 15:44 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 16229 16226  0 15:44 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 16230 16226  0 15:44 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 16259 16229  0 15:44 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "jomoon   16475 11314  0 15:44 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=dvoztlotpscibtfalyosphwaluwtnqex] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-dvoztlotpscibtfalyosphwaluwtnqex ; /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py' && sleep 0",
            "root     16499 16475  0 15:44 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=dvoztlotpscibtfalyosphwaluwtnqex] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-dvoztlotpscibtfalyosphwaluwtnqex ; /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py",
            "postgres 16500 16499  0 15:44 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-dvoztlotpscibtfalyosphwaluwtnqex ; /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py",
            "postgres 16501 16500  0 15:44 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647845076.909908-36350-64975871612951/AnsiballZ_command.py",
            "postgres 16503 16501  0 15:44 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 16504 16503  0 15:44 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 16505 16504  0 15:44 pts/0    00:00:00 ps -ef",
            "postgres 16506 16504  0 15:44 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 15:44:37,431 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:37,431 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:37,443 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:37,453 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 15:44:37,502 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:37,503 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:37,518 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:38,017 p=34764 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": true, "cmd": "( psql -c \"\\l\" )", "delta": "0:00:00.030894", "end": "2022-03-21 15:44:38.353593", "msg": "non-zero return code", "rc": 2, "start": "2022-03-21 15:44:38.322699", "stderr": "psql: error: could not connect to server: No such file or directory\n\tIs the server running locally and accepting\n\tconnections on Unix domain socket \"/tmp/.s.PGSQL.5432\"?", "stderr_lines": ["psql: error: could not connect to server: No such file or directory", "\tIs the server running locally and accepting", "\tconnections on Unix domain socket \"/tmp/.s.PGSQL.5432\"?"], "stdout": "", "stdout_lines": []}
2022-03-21 15:44:38,028 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:38,050 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:44:38,068 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:38,081 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:38,090 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:44:38,125 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:38,136 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:55,494 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:44:55,502 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:44:55,543 p=34764 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "405325103271.19318",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:10.381168",
        "end": "2022-03-21 15:44:51.819399",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/405325103271.19318",
        "start": "2022-03-21 15:44:41.438231",
        "started": 1,
        "stderr": "15:44:41 19328 INFO  Using default --ssl-mode \"require\"\n15:44:41 19328 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:44:41 19328 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:44:41 19328 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:44:41 19328 INFO  Started pg_autoctl postgres service with pid 19330\n15:44:41 19328 INFO  Started pg_autoctl node-init service with pid 19331\n15:44:41 19330 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:44:43 19331 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready\n15:44:43 19331 WARN  The server at \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" is running but is in a state that disallows connections (startup, shutdown, or crash recovery).\n15:44:44 19331 INFO  Successfully connected to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 10 attempts in 3 seconds.\n15:44:44 19331 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n15:44:44 19331 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:44:44 19331 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:44:44 19331 INFO  Successfully registered as \"single\" to the monitor.\n15:44:44 19331 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n15:44:44 19331 INFO  Initialising postgres as a primary\n15:44:44 19331 INFO  Initialising a PostgreSQL cluster at \"ha\"\n15:44:44 19331 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n15:44:47 19331 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:44:47 19331 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:44:47 19331 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:44:47 19331 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:44:47 19331 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:44:47 19490 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:44:48 19330 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 19490\n15:44:48 19331 INFO  CREATE DATABASE appdb;\n15:44:50 19331 INFO  CREATE EXTENSION pg_stat_statements;\n15:44:50 19331 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:44:50 19331 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n15:44:50 19331 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:44:50 19331 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n15:44:50 19331 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:44:50 19331 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n15:44:50 19331 INFO  Transition complete: current state is now \"single\"\n15:44:51 19331 INFO  keeper has been successfully initialized.\n15:44:51 19328 WARN  pg_autoctl service node-init exited with exit status 0\n15:44:51 19330 INFO  Postgres controller service received signal SIGTERM, terminating\n15:44:51 19330 INFO  Stopping pg_autoctl postgres service\n15:44:51 19330 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:44:51 19328 INFO  Waiting for subprocesses to terminate.\n15:44:51 19328 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:44:41 19328 INFO  Using default --ssl-mode \"require\"",
            "15:44:41 19328 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:44:41 19328 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:44:41 19328 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:44:41 19328 INFO  Started pg_autoctl postgres service with pid 19330",
            "15:44:41 19328 INFO  Started pg_autoctl node-init service with pid 19331",
            "15:44:41 19330 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:44:43 19331 WARN  Failed to connect to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\", retrying until the server is ready",
            "15:44:43 19331 WARN  The server at \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" is running but is in a state that disallows connections (startup, shutdown, or crash recovery).",
            "15:44:44 19331 INFO  Successfully connected to \"postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require\" after 10 attempts in 3 seconds.",
            "15:44:44 19331 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "15:44:44 19331 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:44:44 19331 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:44:44 19331 INFO  Successfully registered as \"single\" to the monitor.",
            "15:44:44 19331 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "15:44:44 19331 INFO  Initialising postgres as a primary",
            "15:44:44 19331 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "15:44:44 19331 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "15:44:47 19331 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:44:47 19331 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:44:47 19331 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:44:47 19331 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:44:47 19331 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:44:47 19490 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:44:48 19330 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 19490",
            "15:44:48 19331 INFO  CREATE DATABASE appdb;",
            "15:44:50 19331 INFO  CREATE EXTENSION pg_stat_statements;",
            "15:44:50 19331 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:44:50 19331 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "15:44:50 19331 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:44:50 19331 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "15:44:50 19331 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:44:50 19331 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "15:44:50 19331 INFO  Transition complete: current state is now \"single\"",
            "15:44:51 19331 INFO  keeper has been successfully initialized.",
            "15:44:51 19328 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:44:51 19330 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:44:51 19330 INFO  Stopping pg_autoctl postgres service",
            "15:44:51 19330 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:44:51 19328 INFO  Waiting for subprocesses to terminate.",
            "15:44:51 19328 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:44:55,544 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:55,555 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:44:55,608 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 15:44:55,644 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:44:55,657 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:02,077 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:45:02,085 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:45:02,124 p=34764 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "875141251889.19915",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031334",
        "end": "2022-03-21 15:44:56.654474",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/875141251889.19915",
        "start": "2022-03-21 15:44:56.623140",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:45:02,124 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:45:02,137 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:02,147 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 15:45:02,180 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:45:02,192 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:02,627 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:45:02,637 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:45:02,672 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:45:02,685 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:03,409 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:45:03,419 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:45:03,454 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:45:03,465 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:03,985 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:45:03,995 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 15:45:04,032 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:45:04,043 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:04,956 p=34764 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:45:04,966 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:45:05,004 p=34764 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.430636",
        "end": "2022-03-21 15:45:05.283332",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:45:04.852696",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/16D8DD0 |        no |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/16D8DD0 |        no |              single |              single"
        ]
    }
}
2022-03-21 15:45:05,004 p=34764 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:45:05,014 p=34764 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:45:05,026 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:45:05,061 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:22,390 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:45:23,637 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:45:23,646 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:45:23,669 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:23,692 p=34764 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "440796198717.21561",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:12.889281",
        "end": "2022-03-21 15:45:18.870488",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/440796198717.21561",
        "start": "2022-03-21 15:45:05.981207",
        "started": 1,
        "stderr": "15:45:06 21571 INFO  Using default --ssl-mode \"require\"\n15:45:06 21571 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:45:06 21571 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:45:06 21571 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:45:06 21571 INFO  Started pg_autoctl postgres service with pid 21573\n15:45:06 21573 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:45:06 21571 INFO  Started pg_autoctl node-init service with pid 21574\n15:45:06 21574 INFO  Registered node 2 (co7-node02:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"\n15:45:06 21574 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:45:06 21574 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:45:06 21574 INFO  Successfully registered as \"wait_standby\" to the monitor.\n15:45:06 21574 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n15:45:06 21574 INFO  Transition complete: current state is now \"wait_standby\"\n15:45:06 21574 INFO  New state for node 3 \"node_3\" (co7-node03:5432): wait_standby  wait_standby\n15:45:07 21574 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n15:45:07 21574 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n15:45:07 21574 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n15:45:07 21574 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n15:45:07 21574 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n15:45:07 21574 INFO  Initialising PostgreSQL as a hot standby\n15:45:07 21574 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2\n15:45:07 21574 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n15:45:09 21574 INFO  pg_basebackup: checkpoint completed\n15:45:09 21574 INFO  pg_basebackup: write-ahead log start point: 0/20000D8 on timeline 1\n15:45:09 21574 INFO  pg_basebackup: starting background WAL receiver\n15:45:09 21574 INFO      0/33531 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)\n15:45:12 21574 INFO  33541/33541 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n15:45:12 21574 INFO  33541/33541 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n15:45:12 21574 INFO  33541/33541 kB (100%), 1/1 tablespace                                         \n15:45:12 21574 INFO  pg_basebackup: write-ahead log end point: 0/3000050\n15:45:12 21574 INFO  pg_basebackup: waiting for background process to finish streaming ...\n15:45:12 21574 INFO  pg_basebackup: syncing data to disk ...\n15:45:15 21574 INFO  pg_basebackup: base backup completed\n15:45:15 21574 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"\n15:45:15 21574 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"\n15:45:16 21713 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:45:17 21573 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 21713\n15:45:17 21574 INFO  PostgreSQL started on port 5432\n15:45:17 21574 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n15:45:17 21574 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:45:17 21574 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:45:17 21574 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:45:17 21574 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:45:17 21574 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n15:45:17 21574 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:45:17 21574 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.\n15:45:17 21574 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:45:17 21574 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"\n15:45:17 21574 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.85:5432)\n15:45:17 21574 INFO  Transition complete: current state is now \"catchingup\"\n15:45:18 21574 INFO  keeper has been successfully initialized.\n15:45:18 21571 WARN  pg_autoctl service node-init exited with exit status 0\n15:45:18 21573 INFO  Postgres controller service received signal SIGTERM, terminating\n15:45:18 21573 INFO  Stopping pg_autoctl postgres service\n15:45:18 21573 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:45:18 21571 INFO  Waiting for subprocesses to terminate.\n15:45:18 21571 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:45:06 21571 INFO  Using default --ssl-mode \"require\"",
            "15:45:06 21571 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:45:06 21571 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:45:06 21571 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:45:06 21571 INFO  Started pg_autoctl postgres service with pid 21573",
            "15:45:06 21573 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:45:06 21571 INFO  Started pg_autoctl node-init service with pid 21574",
            "15:45:06 21574 INFO  Registered node 2 (co7-node02:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"",
            "15:45:06 21574 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:45:06 21574 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:45:06 21574 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "15:45:06 21574 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "15:45:06 21574 INFO  Transition complete: current state is now \"wait_standby\"",
            "15:45:06 21574 INFO  New state for node 3 \"node_3\" (co7-node03:5432): wait_standby  wait_standby",
            "15:45:07 21574 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "15:45:07 21574 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "15:45:07 21574 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "15:45:07 21574 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "15:45:07 21574 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "15:45:07 21574 INFO  Initialising PostgreSQL as a hot standby",
            "15:45:07 21574 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2",
            "15:45:07 21574 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "15:45:09 21574 INFO  pg_basebackup: checkpoint completed",
            "15:45:09 21574 INFO  pg_basebackup: write-ahead log start point: 0/20000D8 on timeline 1",
            "15:45:09 21574 INFO  pg_basebackup: starting background WAL receiver",
            "15:45:09 21574 INFO      0/33531 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)",
            "15:45:12 21574 INFO  33541/33541 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "15:45:12 21574 INFO  33541/33541 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "15:45:12 21574 INFO  33541/33541 kB (100%), 1/1 tablespace                                         ",
            "15:45:12 21574 INFO  pg_basebackup: write-ahead log end point: 0/3000050",
            "15:45:12 21574 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "15:45:12 21574 INFO  pg_basebackup: syncing data to disk ...",
            "15:45:15 21574 INFO  pg_basebackup: base backup completed",
            "15:45:15 21574 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"",
            "15:45:15 21574 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"",
            "15:45:16 21713 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:45:17 21573 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 21713",
            "15:45:17 21574 INFO  PostgreSQL started on port 5432",
            "15:45:17 21574 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "15:45:17 21574 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:45:17 21574 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:45:17 21574 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:45:17 21574 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:45:17 21574 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "15:45:17 21574 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:45:17 21574 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.",
            "15:45:17 21574 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:45:17 21574 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"",
            "15:45:17 21574 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.85:5432)",
            "15:45:17 21574 INFO  Transition complete: current state is now \"catchingup\"",
            "15:45:18 21574 INFO  keeper has been successfully initialized.",
            "15:45:18 21571 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:45:18 21573 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:45:18 21573 INFO  Stopping pg_autoctl postgres service",
            "15:45:18 21573 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:45:18 21571 INFO  Waiting for subprocesses to terminate.",
            "15:45:18 21571 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:45:23,705 p=34764 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "62531648061.20818",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:11.887817",
        "end": "2022-03-21 15:45:17.870862",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/62531648061.20818",
        "start": "2022-03-21 15:45:05.983045",
        "started": 1,
        "stderr": "15:45:06 20828 INFO  Using default --ssl-mode \"require\"\n15:45:06 20828 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:45:06 20828 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:45:06 20828 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:45:06 20828 INFO  Started pg_autoctl postgres service with pid 20830\n15:45:06 20828 INFO  Started pg_autoctl node-init service with pid 20831\n15:45:06 20830 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:45:06 20831 INFO  Registered node 3 (co7-node03:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"\n15:45:06 20831 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:45:06 20831 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:45:06 20831 INFO  Successfully registered as \"wait_standby\" to the monitor.\n15:45:06 20831 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n15:45:06 20831 INFO  Transition complete: current state is now \"wait_standby\"\n15:45:06 20831 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n15:45:07 20831 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n15:45:07 20831 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n15:45:07 20831 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n15:45:07 20831 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n15:45:07 20831 INFO  Initialising PostgreSQL as a hot standby\n15:45:07 20831 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3\n15:45:07 20831 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n15:45:09 20831 INFO  pg_basebackup: checkpoint completed\n15:45:09 20831 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1\n15:45:09 20831 INFO  pg_basebackup: starting background WAL receiver\n15:45:09 20831 INFO      0/33532 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)\n15:45:09 20831 INFO  33541/33541 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)\n15:45:09 20831 INFO  33541/33541 kB (100%), 1/1 tablespace                                         \n15:45:09 20831 INFO  pg_basebackup: write-ahead log end point: 0/20001B0\n15:45:09 20831 INFO  pg_basebackup: waiting for background process to finish streaming ...\n15:45:09 20831 INFO  pg_basebackup: syncing data to disk ...\n15:45:11 20831 INFO  pg_basebackup: base backup completed\n15:45:11 20831 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"\n15:45:11 20831 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"\n15:45:12 20969 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:45:16 20830 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 20969\n15:45:16 20831 INFO  PostgreSQL started on port 5432\n15:45:16 20831 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n15:45:16 20831 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:45:16 20831 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:45:16 20831 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:45:16 20831 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:45:16 20831 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n15:45:16 20831 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:45:16 20831 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.\n15:45:16 20831 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:45:16 20831 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"\n15:45:16 20831 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.84:5432)\n15:45:16 20831 INFO  Transition complete: current state is now \"catchingup\"\n15:45:16 20831 INFO  keeper has been successfully initialized.\n15:45:16 20828 WARN  pg_autoctl service node-init exited with exit status 0\n15:45:16 20830 INFO  Postgres controller service received signal SIGTERM, terminating\n15:45:16 20830 INFO  Stopping pg_autoctl postgres service\n15:45:16 20830 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:45:16 20828 INFO  Waiting for subprocesses to terminate.\n15:45:17 20828 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:45:06 20828 INFO  Using default --ssl-mode \"require\"",
            "15:45:06 20828 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:45:06 20828 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:45:06 20828 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:45:06 20828 INFO  Started pg_autoctl postgres service with pid 20830",
            "15:45:06 20828 INFO  Started pg_autoctl node-init service with pid 20831",
            "15:45:06 20830 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:45:06 20831 INFO  Registered node 3 (co7-node03:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"",
            "15:45:06 20831 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:45:06 20831 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:45:06 20831 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "15:45:06 20831 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "15:45:06 20831 INFO  Transition complete: current state is now \"wait_standby\"",
            "15:45:06 20831 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "15:45:07 20831 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "15:45:07 20831 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "15:45:07 20831 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "15:45:07 20831 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "15:45:07 20831 INFO  Initialising PostgreSQL as a hot standby",
            "15:45:07 20831 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3",
            "15:45:07 20831 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "15:45:09 20831 INFO  pg_basebackup: checkpoint completed",
            "15:45:09 20831 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1",
            "15:45:09 20831 INFO  pg_basebackup: starting background WAL receiver",
            "15:45:09 20831 INFO      0/33532 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)",
            "15:45:09 20831 INFO  33541/33541 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)",
            "15:45:09 20831 INFO  33541/33541 kB (100%), 1/1 tablespace                                         ",
            "15:45:09 20831 INFO  pg_basebackup: write-ahead log end point: 0/20001B0",
            "15:45:09 20831 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "15:45:09 20831 INFO  pg_basebackup: syncing data to disk ...",
            "15:45:11 20831 INFO  pg_basebackup: base backup completed",
            "15:45:11 20831 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"",
            "15:45:11 20831 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"",
            "15:45:12 20969 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:45:16 20830 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 20969",
            "15:45:16 20831 INFO  PostgreSQL started on port 5432",
            "15:45:16 20831 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "15:45:16 20831 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:45:16 20831 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:45:16 20831 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:45:16 20831 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:45:16 20831 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "15:45:16 20831 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:45:16 20831 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.",
            "15:45:16 20831 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:45:16 20831 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"",
            "15:45:16 20831 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.84:5432)",
            "15:45:16 20831 INFO  Transition complete: current state is now \"catchingup\"",
            "15:45:16 20831 INFO  keeper has been successfully initialized.",
            "15:45:16 20828 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:45:16 20830 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:45:16 20830 INFO  Stopping pg_autoctl postgres service",
            "15:45:16 20830 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:45:16 20828 INFO  Waiting for subprocesses to terminate.",
            "15:45:17 20828 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:45:23,716 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 15:45:23,750 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:30,075 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:45:30,075 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:45:30,086 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:45:30,111 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:30,132 p=34764 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "244010278654.22129",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032955",
        "end": "2022-03-21 15:45:24.747902",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/244010278654.22129",
        "start": "2022-03-21 15:45:24.714947",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:45:30,146 p=34764 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "380273366252.21386",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032775",
        "end": "2022-03-21 15:45:24.739248",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/380273366252.21386",
        "start": "2022-03-21 15:45:24.706473",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:45:30,156 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 15:45:30,192 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:30,619 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:45:30,619 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:45:30,629 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:45:30,664 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:31,445 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:45:31,451 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:45:31,463 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:45:31,483 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:31,997 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:45:31,997 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:45:32,008 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 15:45:32,043 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:32,633 p=34764 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:45:32,634 p=34764 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:45:32,643 p=34764 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:45:32,664 p=34764 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:45:32,708 p=34764 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.068358",
        "end": "2022-03-21 15:45:32.965351",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:45:32.896993",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node03:5432 | 0/3020000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node03:5432 | 0/3020000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 15:45:32,710 p=34764 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.067847",
        "end": "2022-03-21 15:45:32.967123",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:45:32.899276",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node03:5432 | 0/3020000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node03:5432 | 0/3020000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 15:45:32,788 p=34764 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:45:32,788 p=34764 u=moonja n=ansible | co7-master                 : ok=25   changed=14   unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2022-03-21 15:45:32,788 p=34764 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:45:32,788 p=34764 u=moonja n=ansible | co7-node02                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:45:32,788 p=34764 u=moonja n=ansible | co7-node03                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:48:14,381 p=38751 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:48:14,633 p=38751 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:48:14,638 p=38751 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:48:14,688 p=38751 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:48:14,703 p=38751 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:48:14,733 p=38751 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:48:17,022 p=38751 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:48:17,027 p=38751 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:48:17,035 p=38751 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:48:17,092 p=38751 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:48:17,109 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 15:48:18,038 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:48:18,062 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:48:18,064 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:48:18,065 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:48:18,076 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 15:48:18,744 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:48:18,790 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:48:18,797 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:48:18,809 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:48:19,359 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:48:19,388 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:48:19,435 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:48:19,460 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:48:19,984 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:48:20,031 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:48:20,055 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:48:20,078 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:48:20,611 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:48:20,648 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:48:20,691 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:48:20,709 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:48:20,720 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:48:22,681 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:48:22,710 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:22,718 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:48:22,744 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:48:22,753 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 15:48:24,263 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:48:24,268 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:48:25,038 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:48:25,657 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:25,669 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:48:25,702 p=38751 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:48:25,718 p=38751 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:48:25,731 p=38751 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:48:26,371 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:26,381 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:48:26,416 p=38751 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:48:26,432 p=38751 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:48:26,444 p=38751 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:48:26,892 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:26,902 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:48:27,623 p=38751 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:48:27,625 p=38751 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:48:27,630 p=38751 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:48:27,630 p=38751 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:48:27,642 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:48:29,366 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:48:29,502 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:48:31,166 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:48:31,360 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:31,373 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:48:31,395 p=38751 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:48:31,411 p=38751 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:48:32,132 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:48:32,133 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:48:32,143 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:48:32,164 p=38751 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:48:32,193 p=38751 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:48:33,010 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:48:33,011 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:48:33,021 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 15:48:33,044 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:33,045 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:33,049 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:33,053 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:33,054 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:33,054 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:48:33,060 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:33,061 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:33,063 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:33,067 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:33,073 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:33,077 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:48:33,740 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:48:33,741 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:48:34,253 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:48:34,254 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:48:34,704 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:48:34,704 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:48:35,131 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 15:48:35,132 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 15:48:35,565 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:48:35,566 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:48:36,078 p=38751 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 15:48:36,081 p=38751 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 15:48:36,097 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:48:36,117 p=38751 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:48:36,145 p=38751 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:48:36,157 p=38751 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:48:36,619 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:48:36,632 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:48:36,667 p=38751 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:48:36,683 p=38751 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:48:36,696 p=38751 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:48:37,515 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:48:37,527 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:48:37,551 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:37,571 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:37,576 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:37,593 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:37,594 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:37,594 p=38751 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 15:48:37,599 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:37,601 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:37,601 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:37,602 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:37,604 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:37,604 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:48:37,616 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:37,623 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:37,623 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:37,623 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:37,626 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:37,627 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:48:38,061 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:48:38,502 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:48:38,995 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:48:39,449 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 15:48:39,980 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:48:40,511 p=38751 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 15:48:40,556 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 15:48:40,610 p=38751 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:48:40,611 p=38751 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:48:40,623 p=38751 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:48:41,053 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:41,064 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:48:41,098 p=38751 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:48:41,114 p=38751 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:48:41,127 p=38751 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:48:41,778 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:48:41,788 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 15:48:41,827 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:41,831 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:41,839 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:41,840 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:41,840 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:41,841 p=38751 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 15:48:41,841 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:41,843 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:41,846 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:41,851 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:41,853 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:41,853 p=38751 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 15:48:41,857 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 15:48:41,860 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 15:48:41,866 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 15:48:41,866 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 15:48:41,867 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 15:48:41,868 p=38751 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 15:48:42,243 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 15:48:42,831 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 15:48:43,275 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 15:48:43,763 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 15:48:44,204 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 15:48:44,771 p=38751 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-21 15:48:44,784 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 15:49:13,427 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:49:13,464 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:49:14,912 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:49:16,790 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:49:16,801 p=38751 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:49:17,274 p=38751 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:49:17,277 p=38751 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:49:17,280 p=38751 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:49:17,305 p=38751 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:49:17,353 p=38751 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:49:17,353 p=38751 u=moonja n=ansible | co7-master                 : ok=14   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2022-03-21 15:49:17,354 p=38751 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:49:17,354 p=38751 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:49:17,354 p=38751 u=moonja n=ansible | co7-node03                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 15:51:35,202 p=40269 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:51:35,447 p=40269 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 15:51:35,452 p=40269 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 15:51:35,502 p=40269 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 15:51:35,516 p=40269 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 15:51:35,547 p=40269 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 15:51:37,817 p=40269 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:51:37,875 p=40269 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:51:37,886 p=40269 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:51:37,899 p=40269 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:51:37,916 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 15:51:39,083 p=40269 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 15:51:39,084 p=40269 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 15:51:39,091 p=40269 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 15:51:39,093 p=40269 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 15:51:39,821 p=40269 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 15:51:39,832 p=40269 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 15:51:39,839 p=40269 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 15:51:39,919 p=40269 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 15:51:40,666 p=40269 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 15:51:40,673 p=40269 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 15:51:41,163 p=40269 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 15:51:41,768 p=40269 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 15:51:41,779 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 15:51:42,982 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:51:43,001 p=40269 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:51:43,017 p=40269 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:51:43,681 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:51:43,693 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 15:51:44,532 p=40269 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 15:51:44,537 p=40269 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 15:51:44,546 p=40269 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 15:51:44,546 p=40269 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 15:51:44,558 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 15:51:45,237 p=40269 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 15:51:45,247 p=40269 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 15:51:45,256 p=40269 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 15:51:45,270 p=40269 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 15:51:45,852 p=40269 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 15:51:45,880 p=40269 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 15:51:45,882 p=40269 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 15:51:46,032 p=40269 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 15:51:46,480 p=40269 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 15:51:46,521 p=40269 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 15:51:46,548 p=40269 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 15:51:46,669 p=40269 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 15:51:47,099 p=40269 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 15:51:47,162 p=40269 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 15:51:47,162 p=40269 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 15:51:47,293 p=40269 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 15:51:47,305 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 15:51:48,922 p=40269 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:51:48,929 p=40269 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:51:48,934 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:51:48,983 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:51:48,996 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 15:51:50,426 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:51:50,427 p=40269 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:51:50,427 p=40269 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:51:51,561 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:51:51,572 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 15:51:58,502 p=40269 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 15:51:58,550 p=40269 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 15:51:58,551 p=40269 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 15:51:59,638 p=40269 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 15:51:59,647 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 15:52:16,745 p=40269 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 15:52:17,090 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:17,279 p=40269 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 15:52:17,666 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:52:17,676 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:52:17,712 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:17,728 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:17,741 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:18,389 p=40269 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 15:52:18,389 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:18,402 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:18,444 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 13.3 (VMware Postgres 13.3.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 15:52:18,462 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:18,464 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:18,475 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:18,485 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 15:52:18,519 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:18,533 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:18,545 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:18,990 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:19,001 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:19,039 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 13.3 (VMware Postgres 13.3.0)"
}
2022-03-21 15:52:19,055 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:19,056 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:19,067 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:19,077 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 15:52:19,805 p=40269 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 15:52:19,811 p=40269 u=moonja n=ansible | ok: [co7-master]
2022-03-21 15:52:19,816 p=40269 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 15:52:19,819 p=40269 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 15:52:19,830 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 15:52:19,878 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:52:19,883 p=40269 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:52:19,899 p=40269 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:52:19,915 p=40269 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 15:52:19,925 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 15:52:19,974 p=40269 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 15:52:19,978 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:19,993 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:20,009 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:20,020 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:20,052 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:52:20,071 p=40269 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:52:20,072 p=40269 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:52:20,084 p=40269 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 15:52:20,094 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 15:52:20,141 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:20,142 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:20,151 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:27,742 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:27,751 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:27,788 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "122113649895.24633",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:04.787410",
        "end": "2022-03-21 15:52:25.957021",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/122113649895.24633",
        "start": "2022-03-21 15:52:21.169611",
        "started": 1,
        "stderr": "15:52:21 24643 INFO  Using default --ssl-mode \"require\"\n15:52:21 24643 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:52:21 24643 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:52:21 24643 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:52:21 24643 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n15:52:21 24643 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n15:52:22 24643 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n15:52:23 24643 INFO  Started pg_autoctl postgres service with pid 24659\n15:52:23 24659 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n15:52:23 24643 INFO  Started pg_autoctl monitor-init service with pid 24660\n15:52:23 24660 INFO  Granting connection privileges on 192.168.0.0/24\n15:52:23 24665 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n15:52:23 24659 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 24665\n15:52:24 24660 WARN  NOTICE:  installing required extension \"btree_gist\"\n15:52:25 24660 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n15:52:25 24660 INFO  Monitor has been successfully initialized.\n15:52:25 24643 WARN  pg_autoctl service monitor-init exited with exit status 0\n15:52:25 24659 INFO  Postgres controller service received signal SIGTERM, terminating\n15:52:25 24659 INFO  Stopping pg_autoctl postgres service\n15:52:25 24659 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n15:52:25 24643 INFO  Waiting for subprocesses to terminate.\n15:52:25 24643 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:52:21 24643 INFO  Using default --ssl-mode \"require\"",
            "15:52:21 24643 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:52:21 24643 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:52:21 24643 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:52:21 24643 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "15:52:21 24643 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "15:52:22 24643 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "15:52:23 24643 INFO  Started pg_autoctl postgres service with pid 24659",
            "15:52:23 24659 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "15:52:23 24643 INFO  Started pg_autoctl monitor-init service with pid 24660",
            "15:52:23 24660 INFO  Granting connection privileges on 192.168.0.0/24",
            "15:52:23 24665 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "15:52:23 24659 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 24665",
            "15:52:24 24660 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "15:52:25 24660 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "15:52:25 24660 INFO  Monitor has been successfully initialized.",
            "15:52:25 24643 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "15:52:25 24659 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:52:25 24659 INFO  Stopping pg_autoctl postgres service",
            "15:52:25 24659 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "15:52:25 24643 INFO  Waiting for subprocesses to terminate.",
            "15:52:25 24643 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:52:27,804 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:27,804 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:27,817 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:27,826 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 15:52:27,858 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:27,873 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:27,886 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:34,296 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:34,305 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 15:52:34,353 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:34,353 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:34,365 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:34,806 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:34,818 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 15:52:34,855 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:34,870 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:34,883 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:35,945 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:35,957 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:36,012 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "basic.target systemd-journald.socket -.mount system.slice",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "basic.target -.mount system.slice",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 15:52:36,025 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:36,026 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:36,038 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:36,047 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:52:36,096 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:36,097 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:36,109 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:36,768 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:36,781 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 15:52:36,818 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:36,833 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:36,845 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:37,279 p=40269 u=moonja n=ansible | changed: [co7-master]
2022-03-21 15:52:37,291 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:37,361 p=40269 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.034827",
        "end": "2022-03-21 15:52:37.669593",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:52:37.634766",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 25580     1  0 15:52 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 25583 25580  0 15:52 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 25584 25580  0 15:52 ?        00:00:00 pg_autoctl: monitor listener\npostgres 25696 25583  0 15:52 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres 25724 25696  0 15:52 ?        00:00:00 postgres: pg_auto_failover monitor: logger \njomoon   25831 21113  0 15:52 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=mlcbthknozlfegkvwsigywfauyotzbxa] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-mlcbthknozlfegkvwsigywfauyotzbxa ; /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py' && sleep 0\nroot     25855 25831  0 15:52 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=mlcbthknozlfegkvwsigywfauyotzbxa] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-mlcbthknozlfegkvwsigywfauyotzbxa ; /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py\npostgres 25856 25855  0 15:52 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-mlcbthknozlfegkvwsigywfauyotzbxa ; /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py\npostgres 25857 25856  0 15:52 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py\npostgres 25859 25857  0 15:52 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 25860 25859  0 15:52 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 25861 25860  0 15:52 pts/0    00:00:00 ps -ef\npostgres 25862 25860  0 15:52 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 25580     1  0 15:52 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 25583 25580  0 15:52 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 25584 25580  0 15:52 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 25696 25583  0 15:52 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres 25724 25696  0 15:52 ?        00:00:00 postgres: pg_auto_failover monitor: logger ",
            "jomoon   25831 21113  0 15:52 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=mlcbthknozlfegkvwsigywfauyotzbxa] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-mlcbthknozlfegkvwsigywfauyotzbxa ; /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py' && sleep 0",
            "root     25855 25831  0 15:52 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=mlcbthknozlfegkvwsigywfauyotzbxa] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-mlcbthknozlfegkvwsigywfauyotzbxa ; /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py",
            "postgres 25856 25855  0 15:52 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-mlcbthknozlfegkvwsigywfauyotzbxa ; /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py",
            "postgres 25857 25856  0 15:52 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647845556.855768-41693-273610286698109/AnsiballZ_command.py",
            "postgres 25859 25857  0 15:52 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 25860 25859  0 15:52 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 25861 25860  0 15:52 pts/0    00:00:00 ps -ef",
            "postgres 25862 25860  0 15:52 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 15:52:37,378 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:37,378 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:37,392 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:37,402 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 15:52:37,451 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:37,452 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:37,464 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:53,361 p=40269 u=moonja n=ansible | fatal: [co7-master]: FAILED! => {"changed": true, "cmd": "( psql -c \"\\l\" )", "delta": "0:00:12.946109", "end": "2022-03-21 15:52:53.750374", "msg": "non-zero return code", "rc": 2, "start": "2022-03-21 15:52:40.804265", "stderr": "psql: error: FATAL:  the database system is starting up", "stderr_lines": ["psql: error: FATAL:  the database system is starting up"], "stdout": "", "stdout_lines": []}
2022-03-21 15:52:53,370 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:52:53,391 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:52:53,411 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:53,436 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:52:53,485 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:52:53,524 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:52:53,534 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:05,995 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:53:06,005 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:53:06,061 p=40269 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "403319836638.28051",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:06.366942",
        "end": "2022-03-21 15:53:03.188930",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/403319836638.28051",
        "start": "2022-03-21 15:52:56.821988",
        "started": 1,
        "stderr": "15:52:56 28061 INFO  Using default --ssl-mode \"require\"\n15:52:56 28061 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n15:52:56 28061 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n15:52:56 28061 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n15:52:56 28061 INFO  Started pg_autoctl postgres service with pid 28063\n15:52:56 28061 INFO  Started pg_autoctl node-init service with pid 28064\n15:52:56 28063 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n15:52:57 28064 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n15:52:57 28064 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n15:52:57 28064 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n15:52:57 28064 INFO  Successfully registered as \"single\" to the monitor.\n15:52:57 28064 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n15:52:57 28064 INFO  Initialising postgres as a primary\n15:52:57 28064 INFO  Initialising a PostgreSQL cluster at \"ha\"\n15:52:57 28064 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n15:52:59 28064 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:52:59 28064 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n15:52:59 28064 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:52:59 28064 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n15:52:59 28064 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:52:59 28194 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n15:53:00 28063 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 28194\n15:53:00 28064 INFO  CREATE DATABASE appdb;\n15:53:01 28064 INFO  CREATE EXTENSION pg_stat_statements;\n15:53:01 28064 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n15:53:01 28064 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n15:53:01 28064 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n15:53:01 28064 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n15:53:01 28064 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n15:53:01 28064 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n15:53:01 28064 INFO  Transition complete: current state is now \"single\"\n15:53:01 28064 INFO  keeper has been successfully initialized.\n15:53:01 28061 WARN  pg_autoctl service node-init exited with exit status 0\n15:53:01 28063 INFO  Postgres controller service received signal SIGTERM, terminating\n15:53:01 28063 INFO  Stopping pg_autoctl postgres service\n15:53:01 28063 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n15:53:02 28061 INFO  Waiting for subprocesses to terminate.\n15:53:03 28061 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "15:52:56 28061 INFO  Using default --ssl-mode \"require\"",
            "15:52:56 28061 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "15:52:56 28061 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "15:52:56 28061 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "15:52:56 28061 INFO  Started pg_autoctl postgres service with pid 28063",
            "15:52:56 28061 INFO  Started pg_autoctl node-init service with pid 28064",
            "15:52:56 28063 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "15:52:57 28064 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "15:52:57 28064 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "15:52:57 28064 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "15:52:57 28064 INFO  Successfully registered as \"single\" to the monitor.",
            "15:52:57 28064 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "15:52:57 28064 INFO  Initialising postgres as a primary",
            "15:52:57 28064 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "15:52:57 28064 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "15:52:59 28064 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:52:59 28064 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "15:52:59 28064 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:52:59 28064 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "15:52:59 28064 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:52:59 28194 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "15:53:00 28063 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 28194",
            "15:53:00 28064 INFO  CREATE DATABASE appdb;",
            "15:53:01 28064 INFO  CREATE EXTENSION pg_stat_statements;",
            "15:53:01 28064 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "15:53:01 28064 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "15:53:01 28064 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "15:53:01 28064 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "15:53:01 28064 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "15:53:01 28064 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "15:53:01 28064 INFO  Transition complete: current state is now \"single\"",
            "15:53:01 28064 INFO  keeper has been successfully initialized.",
            "15:53:01 28061 WARN  pg_autoctl service node-init exited with exit status 0",
            "15:53:01 28063 INFO  Postgres controller service received signal SIGTERM, terminating",
            "15:53:01 28063 INFO  Stopping pg_autoctl postgres service",
            "15:53:01 28063 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "15:53:02 28061 INFO  Waiting for subprocesses to terminate.",
            "15:53:03 28061 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 15:53:06,062 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:06,062 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:06,071 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 15:53:06,104 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:06,116 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:13,328 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:53:13,338 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:53:13,375 p=40269 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "540578066802.28556",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031626",
        "end": "2022-03-21 15:53:07.137197",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/540578066802.28556",
        "start": "2022-03-21 15:53:07.105571",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 15:53:13,375 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:13,383 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:13,409 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 15:53:13,446 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:13,457 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:13,982 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:53:13,994 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 15:53:14,029 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:14,041 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:14,820 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:53:14,832 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:53:14,866 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:14,877 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:15,346 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:53:15,356 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 15:53:15,390 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:15,402 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:15,882 p=40269 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 15:53:15,892 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:53:15,959 p=40269 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.068872",
        "end": "2022-03-21 15:53:16.272248",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 15:53:16.203376",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/1662668 |        no |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/1662668 |        no |              single |              single"
        ]
    }
}
2022-03-21 15:53:15,961 p=40269 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 15:53:15,961 p=40269 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 15:53:15,974 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 15:53:16,009 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,197 p=40269 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"ansible_job_id": "873672803847.29324", "changed": false, "child_pid": 29328, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/873672803847.29324", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:59:26,473 p=40269 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"ansible_job_id": "800093376140.30062", "changed": false, "child_pid": 30066, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/800093376140.30062", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 15:59:26,484 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:59:26,506 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,516 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 15:59:26,534 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,543 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:59:26,561 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,570 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 15:59:26,588 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,597 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 15:59:26,614 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,624 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 15:59:26,641 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,650 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 15:59:26,667 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,676 p=40269 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 15:59:26,693 p=40269 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 15:59:26,716 p=40269 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 15:59:26,717 p=40269 u=moonja n=ansible | co7-master                 : ok=25   changed=14   unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2022-03-21 15:59:26,717 p=40269 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 15:59:26,717 p=40269 u=moonja n=ansible | co7-node02                 : ok=12   changed=6    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 15:59:26,717 p=40269 u=moonja n=ansible | co7-node03                 : ok=12   changed=6    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 16:00:05,050 p=45265 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:00:05,298 p=45265 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:00:05,303 p=45265 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 16:00:05,353 p=45265 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 16:00:05,368 p=45265 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 16:00:05,398 p=45265 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 16:00:07,533 p=45265 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:00:07,602 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:07,659 p=45265 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:00:07,660 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:00:07,676 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 16:00:08,733 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 16:00:08,746 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 16:00:08,750 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 16:00:08,762 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 16:00:09,482 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 16:00:09,502 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 16:00:09,515 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 16:00:09,515 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 16:00:14,974 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 16:00:15,123 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 16:00:15,696 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 16:00:15,841 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 16:00:15,853 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 16:00:16,799 p=45265 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:00:16,828 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:16,829 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:00:16,852 p=45265 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:00:16,862 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 16:00:17,703 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=5432)
2022-03-21 16:00:17,708 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=5432)
2022-03-21 16:00:17,710 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=5432)
2022-03-21 16:00:17,711 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=5432)
2022-03-21 16:00:17,722 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 16:00:18,381 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=co7-master)
2022-03-21 16:00:18,382 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=co7-master)
2022-03-21 16:00:18,392 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=co7-master)
2022-03-21 16:00:18,397 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=co7-master)
2022-03-21 16:00:18,964 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=co7-node01)
2022-03-21 16:00:18,970 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node01)
2022-03-21 16:00:18,970 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node01)
2022-03-21 16:00:18,980 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node01)
2022-03-21 16:00:19,550 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node02)
2022-03-21 16:00:19,563 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=co7-node02)
2022-03-21 16:00:19,574 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node02)
2022-03-21 16:00:19,577 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node02)
2022-03-21 16:00:20,119 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=co7-node03)
2022-03-21 16:00:20,151 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=co7-node03)
2022-03-21 16:00:20,169 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=co7-node03)
2022-03-21 16:00:20,172 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=co7-node03)
2022-03-21 16:00:20,183 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 16:00:21,797 p=45265 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:00:21,808 p=45265 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:00:21,814 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:21,815 p=45265 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:00:21,826 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 16:00:23,061 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:23,070 p=45265 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:00:23,085 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:00:23,089 p=45265 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:00:23,099 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 16:00:29,735 p=45265 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 16:00:30,791 p=45265 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 16:00:30,800 p=45265 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 16:00:31,275 p=45265 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 16:00:31,284 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 16:00:38,053 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:00:38,068 p=45265 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:00:38,068 p=45265 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:00:38,570 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:38,580 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:00:38,615 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:38,629 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:38,642 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:39,331 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:39,340 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:39,376 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 13.3 (VMware Postgres 13.3.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 16:00:39,392 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:39,393 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:39,404 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:39,414 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:00:39,459 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:39,460 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:39,471 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:39,934 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:39,943 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:39,978 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 13.3 (VMware Postgres 13.3.0)"
}
2022-03-21 16:00:39,994 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:39,994 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:40,007 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:40,017 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 16:00:40,694 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:00:40,698 p=45265 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:00:40,702 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:40,702 p=45265 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:00:40,712 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 16:00:40,760 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:25580,25583,25584"
}
2022-03-21 16:00:40,765 p=45265 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:29094,29097,29098"
}
2022-03-21 16:00:40,780 p=45265 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:00:40,796 p=45265 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:00:40,806 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 16:00:40,874 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:40,889 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:42,914 p=45265 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:00:43,127 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:43,137 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:43,173 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "stopped",
        "status": {
            "ActiveEnterTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "ActiveEnterTimestampMonotonic": "8159644853",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "active",
            "After": "-.mount basic.target system.slice systemd-journald.socket",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "yes",
            "AssertTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "AssertTimestampMonotonic": "8159644469",
            "Before": "shutdown.target multi-user.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "yes",
            "ConditionTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "ConditionTimestampMonotonic": "8159644469",
            "Conflicts": "shutdown.target",
            "ControlGroup": "/system.slice/pgautofailover.service",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "25580",
            "ExecMainStartTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "ExecMainStartTimestampMonotonic": "8159644812",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[Mon 2022-03-21 15:52:36 KST] ; stop_time=[n/a] ; pid=25580 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "InactiveExitTimestampMonotonic": "8159644853",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "25580",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "basic.target system.slice -.mount",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "running",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "enabled",
            "User": "postgres",
            "WantedBy": "multi-user.target",
            "WatchdogTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "WatchdogTimestampMonotonic": "8159644839",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 16:00:43,193 p=45265 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "stopped",
        "status": {
            "ActiveEnterTimestamp": "Mon 2022-03-21 15:53:15 KST",
            "ActiveEnterTimestampMonotonic": "8197528020",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "active",
            "After": "basic.target -.mount system.slice systemd-journald.socket",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "yes",
            "AssertTimestamp": "Mon 2022-03-21 15:53:15 KST",
            "AssertTimestampMonotonic": "8197527600",
            "Before": "shutdown.target multi-user.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "yes",
            "ConditionTimestamp": "Mon 2022-03-21 15:53:15 KST",
            "ConditionTimestampMonotonic": "8197527600",
            "Conflicts": "shutdown.target",
            "ControlGroup": "/system.slice/pgautofailover.service",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/ha",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "29094",
            "ExecMainStartTimestamp": "Mon 2022-03-21 15:53:15 KST",
            "ExecMainStartTimestampMonotonic": "8197527964",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[Mon 2022-03-21 15:53:15 KST] ; stop_time=[n/a] ; pid=29094 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestamp": "Mon 2022-03-21 15:53:15 KST",
            "InactiveExitTimestampMonotonic": "8197528020",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "31193",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "31193",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "29094",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount system.slice basic.target",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "running",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "enabled",
            "User": "postgres",
            "WantedBy": "multi-user.target",
            "WatchdogTimestamp": "Mon 2022-03-21 15:53:15 KST",
            "WatchdogTimestampMonotonic": "8197527993",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 16:00:43,194 p=45265 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:00:43,206 p=45265 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:00:43,216 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 16:00:43,249 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:43,263 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:43,276 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:49,517 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:49,526 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:49,565 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "416899454421.29772",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:01.981433",
        "end": "2022-03-21 16:00:46.220976",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/416899454421.29772",
        "start": "2022-03-21 16:00:44.239543",
        "started": 1,
        "stderr": "16:00:44 29790 INFO  Using default --ssl-mode \"require\"\n16:00:44 29790 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:00:44 29790 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:00:44 29790 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:00:44 29790 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n16:00:44 29790 INFO  Started pg_autoctl postgres service with pid 29794\n16:00:44 29794 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n16:00:44 29790 INFO  Started pg_autoctl monitor-init service with pid 29795\n16:00:44 29795 INFO  Granting connection privileges on 192.168.0.0/24\n16:00:44 29798 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n16:00:44 29794 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 29798\n16:00:45 29795 INFO  The user \"autoctl\" already exists, skipping.\n16:00:45 29795 INFO  The database \"pg_auto_failover\" already exists, skipping.\n16:00:45 29795 WARN  NOTICE:  extension \"pgautofailover\" already exists, skipping\n16:00:45 29795 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n16:00:45 29795 INFO  Monitor has been successfully initialized.\n16:00:45 29790 WARN  pg_autoctl service monitor-init exited with exit status 0\n16:00:45 29794 INFO  Postgres controller service received signal SIGTERM, terminating\n16:00:45 29794 INFO  Stopping pg_autoctl postgres service\n16:00:45 29794 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n16:00:45 29790 INFO  Waiting for subprocesses to terminate.\n16:00:46 29790 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:00:44 29790 INFO  Using default --ssl-mode \"require\"",
            "16:00:44 29790 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:00:44 29790 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:00:44 29790 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:00:44 29790 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "16:00:44 29790 INFO  Started pg_autoctl postgres service with pid 29794",
            "16:00:44 29794 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "16:00:44 29790 INFO  Started pg_autoctl monitor-init service with pid 29795",
            "16:00:44 29795 INFO  Granting connection privileges on 192.168.0.0/24",
            "16:00:44 29798 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "16:00:44 29794 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 29798",
            "16:00:45 29795 INFO  The user \"autoctl\" already exists, skipping.",
            "16:00:45 29795 INFO  The database \"pg_auto_failover\" already exists, skipping.",
            "16:00:45 29795 WARN  NOTICE:  extension \"pgautofailover\" already exists, skipping",
            "16:00:45 29795 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "16:00:45 29795 INFO  Monitor has been successfully initialized.",
            "16:00:45 29790 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "16:00:45 29794 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:00:45 29794 INFO  Stopping pg_autoctl postgres service",
            "16:00:45 29794 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "16:00:45 29790 INFO  Waiting for subprocesses to terminate.",
            "16:00:46 29790 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:00:49,581 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:49,581 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:49,593 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:49,603 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 16:00:49,654 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:49,655 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:49,667 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:55,979 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:55,987 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 16:00:56,022 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:56,036 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:56,049 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:56,706 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:56,726 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 16:00:56,771 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:56,789 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:56,804 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:57,425 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:57,435 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:57,474 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "ActiveEnterTimestampMonotonic": "8159644853",
            "ActiveExitTimestamp": "Mon 2022-03-21 16:00:42 KST",
            "ActiveExitTimestampMonotonic": "8645498397",
            "ActiveState": "inactive",
            "After": "-.mount systemd-journald.socket system.slice basic.target",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "yes",
            "AssertTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "AssertTimestampMonotonic": "8159644469",
            "Before": "multi-user.target shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "yes",
            "ConditionTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "ConditionTimestampMonotonic": "8159644469",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "1",
            "ExecMainExitTimestamp": "Mon 2022-03-21 16:00:43 KST",
            "ExecMainExitTimestampMonotonic": "8646809286",
            "ExecMainPID": "25580",
            "ExecMainStartTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "ExecMainStartTimestampMonotonic": "8159644812",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestamp": "Mon 2022-03-21 16:00:43 KST",
            "InactiveEnterTimestampMonotonic": "8646809553",
            "InactiveExitTimestamp": "Mon 2022-03-21 15:52:36 KST",
            "InactiveExitTimestampMonotonic": "8159644853",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount system.slice basic.target",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "enabled",
            "User": "postgres",
            "WantedBy": "multi-user.target",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 16:00:57,491 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:57,510 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:57,510 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:57,520 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:00:57,570 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:57,582 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:57,582 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:58,193 p=45265 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:00:58,211 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 16:00:58,245 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:58,260 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:58,272 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:58,704 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:58,714 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:58,752 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.035066",
        "end": "2022-03-21 16:00:59.134727",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:00:59.099661",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 30695     1  0 16:00 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 30698 30695  0 16:00 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 30699 30695  0 16:00 ?        00:00:00 pg_autoctl: monitor listener\npostgres 30729 30698  1 16:00 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres 30840 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: logger \npostgres 30875 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer \npostgres 30876 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: background writer\npostgres 30877 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: walwriter \npostgres 30878 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher\npostgres 30879 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector \npostgres 30880 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor\npostgres 30881 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: logical replication launcher\npostgres 30898 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker\npostgres 30899 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker\npostgres 30900 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle\njomoon   30955 26424  0 16:00 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=xciqyjiwdgzbulhevzrixwgvcworzeey] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-xciqyjiwdgzbulhevzrixwgvcworzeey ; /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py' && sleep 0\nroot     30979 30955  0 16:00 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=xciqyjiwdgzbulhevzrixwgvcworzeey] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-xciqyjiwdgzbulhevzrixwgvcworzeey ; /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py\npostgres 30980 30979  0 16:00 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-xciqyjiwdgzbulhevzrixwgvcworzeey ; /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py\npostgres 30981 30980  0 16:00 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py\npostgres 30983 30981  0 16:00 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 30984 30983  0 16:00 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 30985 30984  0 16:00 pts/0    00:00:00 ps -ef\npostgres 30986 30984  0 16:00 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 30695     1  0 16:00 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 30698 30695  0 16:00 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 30699 30695  0 16:00 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 30729 30698  1 16:00 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres 30840 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: logger ",
            "postgres 30875 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer ",
            "postgres 30876 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: background writer",
            "postgres 30877 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: walwriter ",
            "postgres 30878 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher",
            "postgres 30879 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector ",
            "postgres 30880 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor",
            "postgres 30881 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: logical replication launcher",
            "postgres 30898 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker",
            "postgres 30899 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker",
            "postgres 30900 30729  0 16:00 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle",
            "jomoon   30955 26424  0 16:00 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=xciqyjiwdgzbulhevzrixwgvcworzeey] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-xciqyjiwdgzbulhevzrixwgvcworzeey ; /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py' && sleep 0",
            "root     30979 30955  0 16:00 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=xciqyjiwdgzbulhevzrixwgvcworzeey] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-xciqyjiwdgzbulhevzrixwgvcworzeey ; /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py",
            "postgres 30980 30979  0 16:00 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-xciqyjiwdgzbulhevzrixwgvcworzeey ; /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py",
            "postgres 30981 30980  0 16:00 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647846058.3119528-46622-229900803028078/AnsiballZ_command.py",
            "postgres 30983 30981  0 16:00 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 30984 30983  0 16:00 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 30985 30984  0 16:00 pts/0    00:00:00 ps -ef",
            "postgres 30986 30984  0 16:00 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 16:00:58,768 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:58,768 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:58,782 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:58,792 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 16:00:58,825 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:58,841 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:58,853 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:59,307 p=45265 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:00:59,318 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:00:59,355 p=45265 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.034183",
        "end": "2022-03-21 16:00:59.731341",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:00:59.697158",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-21 16:00:59,370 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:00:59,371 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:59,384 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:00:59,393 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 16:00:59,412 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:00:59,442 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:00:59,454 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:06,866 p=45265 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:01:06,875 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:01:06,897 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:06,934 p=45265 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "363785253599.524",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:00.237427",
        "end": "2022-03-21 16:01:00.803074",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/363785253599.524",
        "start": "2022-03-21 16:01:00.565647",
        "started": 1,
        "stderr": "16:01:00 535 INFO  Using default --ssl-mode \"require\"\n16:01:00 535 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:01:00 535 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:01:00 535 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:01:00 535 INFO  Started pg_autoctl postgres service with pid 540\n16:01:00 540 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:01:00 535 INFO  Started pg_autoctl node-init service with pid 541\n16:01:00 541 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress\n16:01:00 541 INFO  HINT: use `pg_autoctl run` to start the service.\n16:01:00 535 WARN  pg_autoctl service node-init exited with exit status 0\n16:01:00 540 INFO  Postgres controller service received signal SIGTERM, terminating\n16:01:00 535 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:01:00 535 INFO  Using default --ssl-mode \"require\"",
            "16:01:00 535 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:01:00 535 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:01:00 535 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:01:00 535 INFO  Started pg_autoctl postgres service with pid 540",
            "16:01:00 540 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:01:00 535 INFO  Started pg_autoctl node-init service with pid 541",
            "16:01:00 541 FATAL The state file \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\" exists and there's no init in progress",
            "16:01:00 541 INFO  HINT: use `pg_autoctl run` to start the service.",
            "16:01:00 535 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:01:00 540 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:01:00 535 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:01:06,935 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:06,942 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:06,951 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 16:01:06,971 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:07,001 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:07,011 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:13,992 p=45265 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:01:14,001 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:01:14,023 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:14,057 p=45265 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "731639986748.958",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032985",
        "end": "2022-03-21 16:01:08.044934",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/731639986748.958",
        "start": "2022-03-21 16:01:08.011949",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:01:14,058 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:14,069 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:14,084 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 16:01:14,104 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:14,133 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:14,145 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:14,586 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:01:14,596 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 16:01:14,617 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:14,647 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:14,660 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:15,325 p=45265 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:01:15,335 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:01:15,356 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:15,386 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:15,399 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:15,832 p=45265 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:01:15,843 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 16:01:15,863 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:15,893 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:15,904 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:16,392 p=45265 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:01:16,402 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:01:16,437 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:16,484 p=45265 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.066544",
        "end": "2022-03-21 16:01:16.819092",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:01:16.752548",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/1665598 |        no |              single |            draining\nnode_2 |     2 | co7-node02:5432 |       0/0 |        no |        wait_standby |        wait_standby\nnode_3 |     3 | co7-node03:5432 |       0/0 |        no |        wait_standby |        wait_standby",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/1665598 |        no |              single |            draining",
            "node_2 |     2 | co7-node02:5432 |       0/0 |        no |        wait_standby |        wait_standby",
            "node_3 |     3 | co7-node03:5432 |       0/0 |        no |        wait_standby |        wait_standby"
        ]
    }
}
2022-03-21 16:01:16,486 p=45265 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:01:16,486 p=45265 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:01:16,497 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 16:01:16,517 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:01:16,534 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:26,372 p=45265 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"ansible_job_id": "156293738109.6023", "changed": false, "child_pid": 6027, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/156293738109.6023", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 16:07:27,604 p=45265 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"ansible_job_id": "674339048306.6769", "changed": false, "child_pid": 6773, "finished": 1, "msg": "Timeout exceeded", "results_file": "/var/lib/pgsql/.ansible_async/674339048306.6769", "started": 1, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-03-21 16:07:27,612 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:07:27,634 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,644 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,655 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 16:07:27,676 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,688 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,698 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:07:27,718 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,729 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,740 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 16:07:27,760 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,772 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,782 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 16:07:27,803 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,812 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,823 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:07:27,844 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,855 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,865 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 16:07:27,886 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,896 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,909 p=45265 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:07:27,929 p=45265 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:07:27,939 p=45265 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:07:27,971 p=45265 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 16:07:27,972 p=45265 u=moonja n=ansible | co7-master                 : ok=28   changed=9    unreachable=0    failed=0    skipped=18   rescued=0    ignored=0   
2022-03-21 16:07:27,972 p=45265 u=moonja n=ansible | co7-node01                 : ok=22   changed=6    unreachable=0    failed=0    skipped=24   rescued=0    ignored=0   
2022-03-21 16:07:27,972 p=45265 u=moonja n=ansible | co7-node02                 : ok=12   changed=1    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 16:07:27,972 p=45265 u=moonja n=ansible | co7-node03                 : ok=12   changed=1    unreachable=0    failed=1    skipped=25   rescued=0    ignored=0   
2022-03-21 16:17:40,289 p=50178 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:17:40,538 p=50178 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:17:40,543 p=50178 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 16:17:40,593 p=50178 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 16:17:40,607 p=50178 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 16:17:40,637 p=50178 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 16:17:42,840 p=50178 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:17:42,882 p=50178 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:17:42,909 p=50178 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:17:43,892 p=50178 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:17:43,908 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 16:17:44,808 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 16:17:44,815 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 16:17:44,841 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 16:17:44,841 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 16:17:44,852 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 16:17:45,524 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 16:17:45,537 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 16:17:45,544 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 16:17:45,619 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 16:17:46,132 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 16:17:46,145 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 16:17:46,175 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 16:17:46,229 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 16:17:46,761 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 16:17:46,788 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 16:17:46,808 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 16:17:46,877 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 16:17:47,371 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 16:17:47,400 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 16:17:47,422 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 16:17:47,487 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 16:17:47,497 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 16:17:49,445 p=50178 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:17:49,451 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:17:49,456 p=50178 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:17:49,468 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:17:49,477 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 16:17:50,933 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:17:50,954 p=50178 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:17:50,969 p=50178 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:17:51,003 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:17:51,013 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:17:51,059 p=50178 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:17:51,060 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:17:51,071 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:17:51,819 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:17:51,828 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:17:51,861 p=50178 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:17:51,884 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:17:51,896 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:17:52,436 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:17:52,446 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 16:17:53,161 p=50178 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:17:53,165 p=50178 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:17:53,168 p=50178 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:17:53,172 p=50178 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:17:53,182 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 16:17:53,248 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:17:53,261 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:17:54,688 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:17:54,946 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:17:54,957 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 16:17:54,977 p=50178 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:17:54,993 p=50178 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:17:55,610 p=50178 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:17:55,611 p=50178 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:17:55,620 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 16:17:55,640 p=50178 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:17:55,657 p=50178 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:17:56,334 p=50178 u=moonja n=ansible | fatal: [co7-node03]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 16:17:56,335 p=50178 u=moonja n=ansible | ...ignoring
2022-03-21 16:17:56,335 p=50178 u=moonja n=ansible | fatal: [co7-node02]: FAILED! => {"changed": false, "msg": "Could not find the requested service pgautofailover: host"}
2022-03-21 16:17:56,335 p=50178 u=moonja n=ansible | ...ignoring
2022-03-21 16:17:56,343 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 16:17:56,366 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:17:56,368 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:17:56,371 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:17:56,375 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:17:56,379 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:17:56,380 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 16:17:56,381 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:17:56,383 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:17:56,385 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:17:56,388 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:17:56,391 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:17:56,395 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 16:17:57,097 p=50178 u=moonja n=ansible | ok: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:17:57,098 p=50178 u=moonja n=ansible | ok: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:17:57,532 p=50178 u=moonja n=ansible | ok: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:17:57,536 p=50178 u=moonja n=ansible | ok: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:17:57,997 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:17:57,998 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:17:58,511 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 16:17:58,512 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 16:17:58,909 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:17:58,911 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:17:59,319 p=50178 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 16:17:59,320 p=50178 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 16:17:59,332 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 16:17:59,352 p=50178 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:17:59,382 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:17:59,391 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:17:59,840 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:17:59,851 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 16:17:59,870 p=50178 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:17:59,900 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:17:59,911 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:18:00,610 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:18:00,620 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 16:18:00,641 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:18:00,646 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:18:00,646 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:18:00,654 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:18:00,655 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:18:00,655 p=50178 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 16:18:00,674 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:18:00,675 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:18:00,681 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:18:00,683 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:18:00,684 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:18:00,684 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 16:18:00,688 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:18:00,691 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:18:00,694 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:18:00,696 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:18:00,699 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:18:00,699 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 16:18:01,125 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:18:01,532 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:18:01,955 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:18:02,387 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 16:18:02,813 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:18:03,985 p=50178 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 16:18:03,997 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 16:18:04,030 p=50178 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:18:04,045 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:18:04,058 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:18:04,540 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:18:04,550 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 16:18:04,584 p=50178 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:18:04,599 p=50178 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:18:04,610 p=50178 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:18:05,450 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:18:05,460 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 16:18:05,498 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:18:05,499 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:18:05,502 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:18:05,506 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:18:05,510 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:18:05,511 p=50178 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 16:18:05,512 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:18:05,513 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:18:05,516 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:18:05,521 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:18:05,522 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:18:05,523 p=50178 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 16:18:05,527 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:18:05,530 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:18:05,532 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:18:05,535 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:18:05,538 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:18:05,538 p=50178 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 16:18:05,937 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:18:06,466 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:18:07,055 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:18:07,603 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 16:18:08,089 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:18:08,719 p=50178 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-21 16:18:08,732 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 16:18:31,688 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:18:31,914 p=50178 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:18:32,141 p=50178 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:18:37,232 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:18:37,244 p=50178 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 16:18:37,710 p=50178 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:18:37,726 p=50178 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:18:37,737 p=50178 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:18:37,740 p=50178 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:18:37,785 p=50178 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 16:18:37,785 p=50178 u=moonja n=ansible | co7-master                 : ok=14   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2022-03-21 16:18:37,785 p=50178 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 16:18:37,785 p=50178 u=moonja n=ansible | co7-node02                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 16:18:37,786 p=50178 u=moonja n=ansible | co7-node03                 : ok=11   changed=8    unreachable=0    failed=0    skipped=9    rescued=0    ignored=1   
2022-03-21 16:19:51,737 p=53431 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:19:51,990 p=53431 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:19:51,995 p=53431 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 16:19:52,044 p=53431 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 16:19:52,058 p=53431 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 16:19:52,088 p=53431 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 16:19:54,271 p=53431 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:19:54,296 p=53431 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:19:54,324 p=53431 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:19:55,329 p=53431 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:19:55,346 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 16:19:56,322 p=53431 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 16:19:56,329 p=53431 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 16:19:56,371 p=53431 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 16:19:56,391 p=53431 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 16:19:57,051 p=53431 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 16:19:57,056 p=53431 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 16:19:57,109 p=53431 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 16:19:57,151 p=53431 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 16:19:57,922 p=53431 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 16:19:57,944 p=53431 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 16:19:57,994 p=53431 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 16:19:58,010 p=53431 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 16:19:58,021 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 16:19:59,319 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:19:59,320 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:19:59,331 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:20:00,810 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:20:00,820 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 16:20:01,713 p=53431 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 16:20:01,714 p=53431 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 16:20:01,715 p=53431 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 16:20:01,722 p=53431 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 16:20:01,732 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 16:20:02,539 p=53431 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 16:20:02,540 p=53431 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 16:20:02,584 p=53431 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 16:20:02,587 p=53431 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 16:20:03,150 p=53431 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 16:20:03,152 p=53431 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 16:20:03,183 p=53431 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 16:20:03,196 p=53431 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 16:20:03,748 p=53431 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 16:20:03,783 p=53431 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 16:20:03,794 p=53431 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 16:20:03,840 p=53431 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 16:20:04,425 p=53431 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 16:20:04,452 p=53431 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 16:20:04,805 p=53431 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 16:20:04,814 p=53431 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 16:20:04,824 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 16:20:06,482 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:20:06,498 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:20:06,506 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:20:06,512 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:20:06,522 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 16:20:08,086 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:20:08,086 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:20:08,093 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:20:08,702 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:20:08,712 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 16:20:15,473 p=53431 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 16:20:15,512 p=53431 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 16:20:15,528 p=53431 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 16:20:15,529 p=53431 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 16:20:15,539 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 16:20:43,634 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:20:43,834 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:20:45,876 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:20:47,697 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:20:47,708 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:20:47,756 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:20:47,757 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:20:47,768 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:20:48,480 p=53431 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 16:20:48,480 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:20:48,491 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:20:48,528 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 11.12 (VMware Postgres 11.12.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 16:20:48,544 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:20:48,545 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:20:48,558 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:20:48,601 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:20:48,636 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:20:48,654 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:20:48,668 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:20:49,302 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:20:49,314 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:20:49,351 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 11.12 (VMware Postgres 11.12.0)"
}
2022-03-21 16:20:49,366 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:20:49,368 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:20:49,378 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:20:49,388 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 16:20:50,077 p=53431 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:20:50,078 p=53431 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:20:50,078 p=53431 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:20:50,078 p=53431 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:20:50,086 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 16:20:50,133 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:20:50,139 p=53431 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:20:50,153 p=53431 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:20:50,168 p=53431 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:20:50,179 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 16:20:50,226 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:20:50,228 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:20:50,243 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:20:50,261 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:20:50,271 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:20:50,305 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:20:50,323 p=53431 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:20:50,324 p=53431 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:20:50,336 p=53431 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:20:50,347 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 16:20:50,382 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:20:50,397 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:20:50,411 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:13,097 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:13,106 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:13,173 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "670426044247.7325",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:19.356767",
        "end": "2022-03-21 16:21:10.842001",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/670426044247.7325",
        "start": "2022-03-21 16:20:51.485234",
        "started": 1,
        "stderr": "16:20:51 7335 INFO  Using default --ssl-mode \"require\"\n16:20:51 7335 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:20:51 7335 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:20:51 7335 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:20:51 7335 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n16:20:51 7335 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n16:20:54 7335 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n16:20:54 7335 INFO  Started pg_autoctl postgres service with pid 7351\n16:20:54 7351 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n16:20:54 7335 INFO  Started pg_autoctl monitor-init service with pid 7352\n16:20:54 7352 INFO  Granting connection privileges on 192.168.0.0/24\n16:20:56 7388 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n16:20:57 7351 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 7388\n16:21:06 7352 WARN  NOTICE:  installing required extension \"btree_gist\"\n16:21:07 7352 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n16:21:07 7352 INFO  Monitor has been successfully initialized.\n16:21:07 7335 WARN  pg_autoctl service monitor-init exited with exit status 0\n16:21:07 7351 INFO  Postgres controller service received signal SIGTERM, terminating\n16:21:07 7351 INFO  Stopping pg_autoctl postgres service\n16:21:07 7351 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n16:21:07 7335 INFO  Waiting for subprocesses to terminate.\n16:21:10 7335 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:20:51 7335 INFO  Using default --ssl-mode \"require\"",
            "16:20:51 7335 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:20:51 7335 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:20:51 7335 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:20:51 7335 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "16:20:51 7335 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "16:20:54 7335 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "16:20:54 7335 INFO  Started pg_autoctl postgres service with pid 7351",
            "16:20:54 7351 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "16:20:54 7335 INFO  Started pg_autoctl monitor-init service with pid 7352",
            "16:20:54 7352 INFO  Granting connection privileges on 192.168.0.0/24",
            "16:20:56 7388 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "16:20:57 7351 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 7388",
            "16:21:06 7352 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "16:21:07 7352 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "16:21:07 7352 INFO  Monitor has been successfully initialized.",
            "16:21:07 7335 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "16:21:07 7351 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:21:07 7351 INFO  Stopping pg_autoctl postgres service",
            "16:21:07 7351 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "16:21:07 7335 INFO  Waiting for subprocesses to terminate.",
            "16:21:10 7335 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:21:13,186 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:13,187 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:13,200 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:13,209 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 16:21:13,256 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:13,256 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:13,267 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:19,816 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:19,826 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 16:21:19,860 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:19,874 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:19,886 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:20,352 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:20,363 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 16:21:20,395 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:20,410 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:20,421 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:21,670 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:21,683 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:21,723 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "basic.target systemd-journald.socket system.slice -.mount",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "basic.target system.slice -.mount",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 16:21:21,739 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:21,739 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:21,752 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:21,761 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:21:21,808 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:21,810 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:21,820 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:22,581 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:22,593 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 16:21:22,642 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:22,643 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:22,654 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:23,137 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:23,149 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:23,224 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.035776",
        "end": "2022-03-21 16:21:23.545482",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:21:23.509706",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres  8530     1  0 16:21 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres  8533  8530  0 16:21 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres  8534  8530  0 16:21 ?        00:00:00 pg_autoctl: monitor listener\npostgres  8564  8533  3 16:21 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres  8607  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: logger   \npostgres  8611  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer   \npostgres  8612  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: background writer  \npostgres  8613  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: walwriter   \npostgres  8614  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher  \npostgres  8615  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector  \npostgres  8616  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor  \npostgres  8617  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: logical replication launcher  \npostgres  8618  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker  \npostgres  8619  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle\npostgres  8620  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker  \njomoon    8792  3629  0 16:21 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=loqfskpotitrqiughlyhlaqknzwduogk] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-loqfskpotitrqiughlyhlaqknzwduogk ; /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py' && sleep 0\nroot      8816  8792  0 16:21 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=loqfskpotitrqiughlyhlaqknzwduogk] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-loqfskpotitrqiughlyhlaqknzwduogk ; /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py\npostgres  8817  8816  0 16:21 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-loqfskpotitrqiughlyhlaqknzwduogk ; /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py\npostgres  8818  8817  0 16:21 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py\npostgres  8820  8818  0 16:21 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres  8821  8820  0 16:21 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres  8822  8821  0 16:21 pts/0    00:00:00 ps -ef\npostgres  8823  8821  0 16:21 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres  8530     1  0 16:21 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres  8533  8530  0 16:21 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres  8534  8530  0 16:21 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres  8564  8533  3 16:21 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres  8607  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: logger   ",
            "postgres  8611  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer   ",
            "postgres  8612  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: background writer  ",
            "postgres  8613  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: walwriter   ",
            "postgres  8614  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher  ",
            "postgres  8615  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector  ",
            "postgres  8616  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor  ",
            "postgres  8617  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: logical replication launcher  ",
            "postgres  8618  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker  ",
            "postgres  8619  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle",
            "postgres  8620  8564  0 16:21 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker  ",
            "jomoon    8792  3629  0 16:21 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=loqfskpotitrqiughlyhlaqknzwduogk] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-loqfskpotitrqiughlyhlaqknzwduogk ; /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py' && sleep 0",
            "root      8816  8792  0 16:21 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=loqfskpotitrqiughlyhlaqknzwduogk] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-loqfskpotitrqiughlyhlaqknzwduogk ; /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py",
            "postgres  8817  8816  0 16:21 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-loqfskpotitrqiughlyhlaqknzwduogk ; /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py",
            "postgres  8818  8817  0 16:21 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647847282.7130601-54964-173071772392752/AnsiballZ_command.py",
            "postgres  8820  8818  0 16:21 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres  8821  8820  0 16:21 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres  8822  8821  0 16:21 pts/0    00:00:00 ps -ef",
            "postgres  8823  8821  0 16:21 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 16:21:23,240 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:23,241 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:23,253 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:23,262 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 16:21:23,294 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:23,308 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:23,320 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:23,864 p=53431 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:21:23,875 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:23,922 p=53431 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.034281",
        "end": "2022-03-21 16:21:24.269682",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:21:24.235401",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-21 16:21:23,936 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:23,937 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:23,949 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:23,958 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 16:21:23,978 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:24,006 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:24,018 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:36,051 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:21:36,060 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:36,094 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:36,123 p=53431 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "596143772422.8988",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:07.770736",
        "end": "2022-03-21 16:21:32.898070",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/596143772422.8988",
        "start": "2022-03-21 16:21:25.127334",
        "started": 1,
        "stderr": "16:21:25 8998 INFO  Using default --ssl-mode \"require\"\n16:21:25 8998 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:21:25 8998 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:21:25 8998 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:21:25 8998 INFO  Started pg_autoctl postgres service with pid 9000\n16:21:25 8998 INFO  Started pg_autoctl node-init service with pid 9001\n16:21:25 9000 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:21:25 9001 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n16:21:25 9001 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n16:21:25 9001 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n16:21:25 9001 INFO  Successfully registered as \"single\" to the monitor.\n16:21:25 9001 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n16:21:25 9001 INFO  Initialising postgres as a primary\n16:21:25 9001 INFO  Initialising a PostgreSQL cluster at \"ha\"\n16:21:25 9001 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n16:21:27 9001 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:21:27 9001 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n16:21:27 9001 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:21:27 9001 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n16:21:27 9001 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n16:21:27 9022 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n16:21:28 9000 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 9022\n16:21:28 9001 INFO  CREATE DATABASE appdb;\n16:21:31 9001 INFO  CREATE EXTENSION pg_stat_statements;\n16:21:31 9001 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n16:21:31 9001 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n16:21:31 9001 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:21:31 9001 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n16:21:31 9001 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:21:31 9001 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n16:21:31 9001 INFO  Transition complete: current state is now \"single\"\n16:21:32 9001 INFO  keeper has been successfully initialized.\n16:21:32 8998 WARN  pg_autoctl service node-init exited with exit status 0\n16:21:32 9000 INFO  Postgres controller service received signal SIGTERM, terminating\n16:21:32 9000 INFO  Stopping pg_autoctl postgres service\n16:21:32 9000 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n16:21:32 8998 INFO  Waiting for subprocesses to terminate.\n16:21:32 8998 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:21:25 8998 INFO  Using default --ssl-mode \"require\"",
            "16:21:25 8998 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:21:25 8998 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:21:25 8998 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:21:25 8998 INFO  Started pg_autoctl postgres service with pid 9000",
            "16:21:25 8998 INFO  Started pg_autoctl node-init service with pid 9001",
            "16:21:25 9000 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:21:25 9001 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "16:21:25 9001 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "16:21:25 9001 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "16:21:25 9001 INFO  Successfully registered as \"single\" to the monitor.",
            "16:21:25 9001 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "16:21:25 9001 INFO  Initialising postgres as a primary",
            "16:21:25 9001 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "16:21:25 9001 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "16:21:27 9001 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:21:27 9001 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "16:21:27 9001 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:21:27 9001 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "16:21:27 9001 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "16:21:27 9022 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "16:21:28 9000 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 9022",
            "16:21:28 9001 INFO  CREATE DATABASE appdb;",
            "16:21:31 9001 INFO  CREATE EXTENSION pg_stat_statements;",
            "16:21:31 9001 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "16:21:31 9001 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "16:21:31 9001 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:21:31 9001 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "16:21:31 9001 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:21:31 9001 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "16:21:31 9001 INFO  Transition complete: current state is now \"single\"",
            "16:21:32 9001 INFO  keeper has been successfully initialized.",
            "16:21:32 8998 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:21:32 9000 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:21:32 9000 INFO  Stopping pg_autoctl postgres service",
            "16:21:32 9000 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "16:21:32 8998 INFO  Waiting for subprocesses to terminate.",
            "16:21:32 8998 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 16:21:36,123 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:36,124 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:36,134 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 16:21:36,164 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:36,180 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:36,191 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:42,947 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:21:42,956 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:42,976 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:43,007 p=53431 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "486239306482.9492",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032804",
        "end": "2022-03-21 16:21:37.568984",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/486239306482.9492",
        "start": "2022-03-21 16:21:37.536180",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:21:43,009 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:43,018 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:43,029 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 16:21:43,061 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:43,077 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:43,088 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:43,535 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:21:43,546 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 16:21:43,580 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:43,595 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:43,607 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:44,376 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:21:44,386 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:21:44,407 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:44,436 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:44,447 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:44,996 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:21:45,008 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 16:21:45,029 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:45,057 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:45,068 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:45,544 p=53431 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:21:45,554 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:45,573 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:45,622 p=53431 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.064463",
        "end": "2022-03-21 16:21:45.950677",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:21:45.886214",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/16E46E0 |        no |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/16E46E0 |        no |              single |              single"
        ]
    }
}
2022-03-21 16:21:45,623 p=53431 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:21:45,623 p=53431 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:21:45,631 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 16:21:45,665 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:45,681 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:57,638 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:21:57,638 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:21:57,648 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:21:57,669 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:57,685 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:21:57,724 p=53431 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "603687608349.19798",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:10.481262",
        "end": "2022-03-21 16:21:57.158875",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/603687608349.19798",
        "start": "2022-03-21 16:21:46.677613",
        "started": 1,
        "stderr": "16:21:46 19808 INFO  Using default --ssl-mode \"require\"\n16:21:46 19808 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:21:46 19808 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:21:46 19808 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:21:46 19808 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n16:21:46 19808 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n16:21:46 19808 INFO  Started pg_autoctl postgres service with pid 19810\n16:21:46 19808 INFO  Started pg_autoctl node-init service with pid 19811\n16:21:46 19810 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:21:47 19811 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"\n16:21:47 19811 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n16:21:47 19811 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n16:21:47 19811 INFO  Successfully registered as \"wait_standby\" to the monitor.\n16:21:47 19811 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n16:21:47 19811 INFO  Transition complete: current state is now \"wait_standby\"\n16:21:47 19811 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n16:21:48 19811 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n16:21:48 19811 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n16:21:48 19811 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n16:21:48 19811 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n16:21:48 19811 INFO  Initialising PostgreSQL as a hot standby\n16:21:48 19811 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3\n16:21:48 19811 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n16:21:50 19811 INFO  pg_basebackup: checkpoint completed\n16:21:50 19811 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1\n16:21:50 19811 INFO  pg_basebackup: starting background WAL receiver\n16:21:50 19811 INFO      0/32462 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)\n16:21:50 19811 INFO  32471/32471 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)\n16:21:50 19811 INFO  32471/32471 kB (100%), 1/1 tablespace                                         \n16:21:50 19811 INFO  pg_basebackup: write-ahead log end point: 0/20001A0\n16:21:50 19811 INFO  pg_basebackup: waiting for background process to finish streaming ...\n16:21:53 19811 INFO  pg_basebackup: base backup completed\n16:21:53 19811 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"\n16:21:53 19811 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"\n16:21:53 19957 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n16:21:55 19810 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 19957\n16:21:55 19811 INFO  PostgreSQL started on port 5432\n16:21:55 19811 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n16:21:55 19811 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:21:55 19811 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n16:21:55 19811 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:21:55 19811 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n16:21:55 19811 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n16:21:55 19811 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:21:55 19811 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.\n16:21:55 19811 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:21:55 19811 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"\n16:21:55 19811 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)\n16:21:55 19811 INFO  Transition complete: current state is now \"catchingup\"\n16:21:56 19811 INFO  keeper has been successfully initialized.\n16:21:56 19808 WARN  pg_autoctl service node-init exited with exit status 0\n16:21:56 19810 INFO  Postgres controller service received signal SIGTERM, terminating\n16:21:56 19810 INFO  Stopping pg_autoctl postgres service\n16:21:56 19810 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n16:21:56 19808 INFO  Waiting for subprocesses to terminate.\n16:21:57 19808 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:21:46 19808 INFO  Using default --ssl-mode \"require\"",
            "16:21:46 19808 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:21:46 19808 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:21:46 19808 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:21:46 19808 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "16:21:46 19808 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "16:21:46 19808 INFO  Started pg_autoctl postgres service with pid 19810",
            "16:21:46 19808 INFO  Started pg_autoctl node-init service with pid 19811",
            "16:21:46 19810 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:21:47 19811 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"",
            "16:21:47 19811 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "16:21:47 19811 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "16:21:47 19811 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "16:21:47 19811 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "16:21:47 19811 INFO  Transition complete: current state is now \"wait_standby\"",
            "16:21:47 19811 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "16:21:48 19811 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "16:21:48 19811 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "16:21:48 19811 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "16:21:48 19811 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "16:21:48 19811 INFO  Initialising PostgreSQL as a hot standby",
            "16:21:48 19811 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3",
            "16:21:48 19811 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "16:21:50 19811 INFO  pg_basebackup: checkpoint completed",
            "16:21:50 19811 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1",
            "16:21:50 19811 INFO  pg_basebackup: starting background WAL receiver",
            "16:21:50 19811 INFO      0/32462 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)",
            "16:21:50 19811 INFO  32471/32471 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)",
            "16:21:50 19811 INFO  32471/32471 kB (100%), 1/1 tablespace                                         ",
            "16:21:50 19811 INFO  pg_basebackup: write-ahead log end point: 0/20001A0",
            "16:21:50 19811 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "16:21:53 19811 INFO  pg_basebackup: base backup completed",
            "16:21:53 19811 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"",
            "16:21:53 19811 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"",
            "16:21:53 19957 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "16:21:55 19810 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 19957",
            "16:21:55 19811 INFO  PostgreSQL started on port 5432",
            "16:21:55 19811 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "16:21:55 19811 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:21:55 19811 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "16:21:55 19811 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:21:55 19811 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "16:21:55 19811 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "16:21:55 19811 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:21:55 19811 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.",
            "16:21:55 19811 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:21:55 19811 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"",
            "16:21:55 19811 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)",
            "16:21:55 19811 INFO  Transition complete: current state is now \"catchingup\"",
            "16:21:56 19811 INFO  keeper has been successfully initialized.",
            "16:21:56 19808 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:21:56 19810 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:21:56 19810 INFO  Stopping pg_autoctl postgres service",
            "16:21:56 19810 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "16:21:56 19808 INFO  Waiting for subprocesses to terminate.",
            "16:21:57 19808 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 16:21:57,727 p=53431 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "498952013830.19052",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:10.885831",
        "end": "2022-03-21 16:21:57.561925",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/498952013830.19052",
        "start": "2022-03-21 16:21:46.676094",
        "started": 1,
        "stderr": "16:21:46 19062 INFO  Using default --ssl-mode \"require\"\n16:21:46 19062 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:21:46 19062 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:21:46 19062 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:21:46 19062 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n16:21:46 19062 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"\n16:21:46 19062 INFO  Started pg_autoctl postgres service with pid 19064\n16:21:46 19062 INFO  Started pg_autoctl node-init service with pid 19065\n16:21:46 19064 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:21:46 19065 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"\n16:21:46 19065 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n16:21:46 19065 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n16:21:47 19065 INFO  Successfully registered as \"wait_standby\" to the monitor.\n16:21:47 19065 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n16:21:47 19065 INFO  Transition complete: current state is now \"wait_standby\"\n16:21:47 19065 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby\n16:21:48 19065 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n16:21:48 19065 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n16:21:48 19065 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n16:21:48 19065 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n16:21:48 19065 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n16:21:48 19065 INFO  Initialising PostgreSQL as a hot standby\n16:21:48 19065 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2\n16:21:48 19065 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n16:21:50 19065 INFO  pg_basebackup: checkpoint completed\n16:21:50 19065 INFO  pg_basebackup: write-ahead log start point: 0/20000D0 on timeline 1\n16:21:50 19065 INFO  pg_basebackup: starting background WAL receiver\n16:21:50 19065 INFO      0/32461 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)\n16:21:53 19065 INFO  32471/32471 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n16:21:53 19065 INFO  32471/32471 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n16:21:53 19065 INFO  32471/32471 kB (100%), 1/1 tablespace                                         \n16:21:53 19065 INFO  pg_basebackup: write-ahead log end point: 0/3000050\n16:21:53 19065 INFO  pg_basebackup: waiting for background process to finish streaming ...\n16:21:54 19065 INFO  pg_basebackup: base backup completed\n16:21:54 19065 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"\n16:21:54 19065 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"\n16:21:55 19211 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n16:21:56 19064 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 19211\n16:21:56 19065 INFO  PostgreSQL started on port 5432\n16:21:56 19065 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n16:21:56 19065 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:21:56 19065 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n16:21:56 19065 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:21:56 19065 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n16:21:56 19065 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n16:21:56 19065 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:21:56 19065 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.\n16:21:56 19065 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:21:56 19065 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"\n16:21:56 19065 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)\n16:21:56 19065 INFO  Transition complete: current state is now \"catchingup\"\n16:21:57 19065 INFO  keeper has been successfully initialized.\n16:21:57 19062 WARN  pg_autoctl service node-init exited with exit status 0\n16:21:57 19064 INFO  Postgres controller service received signal SIGTERM, terminating\n16:21:57 19064 INFO  Stopping pg_autoctl postgres service\n16:21:57 19064 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n16:21:57 19062 INFO  Waiting for subprocesses to terminate.\n16:21:57 19062 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:21:46 19062 INFO  Using default --ssl-mode \"require\"",
            "16:21:46 19062 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:21:46 19062 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:21:46 19062 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:21:46 19062 INFO  Found a stale pidfile at \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "16:21:46 19062 WARN  Removing the stale pid file \"/tmp/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.pid\"",
            "16:21:46 19062 INFO  Started pg_autoctl postgres service with pid 19064",
            "16:21:46 19062 INFO  Started pg_autoctl node-init service with pid 19065",
            "16:21:46 19064 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:21:46 19065 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"",
            "16:21:46 19065 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "16:21:46 19065 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "16:21:47 19065 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "16:21:47 19065 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "16:21:47 19065 INFO  Transition complete: current state is now \"wait_standby\"",
            "16:21:47 19065 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby",
            "16:21:48 19065 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "16:21:48 19065 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "16:21:48 19065 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "16:21:48 19065 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "16:21:48 19065 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "16:21:48 19065 INFO  Initialising PostgreSQL as a hot standby",
            "16:21:48 19065 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2",
            "16:21:48 19065 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "16:21:50 19065 INFO  pg_basebackup: checkpoint completed",
            "16:21:50 19065 INFO  pg_basebackup: write-ahead log start point: 0/20000D0 on timeline 1",
            "16:21:50 19065 INFO  pg_basebackup: starting background WAL receiver",
            "16:21:50 19065 INFO      0/32461 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)",
            "16:21:53 19065 INFO  32471/32471 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "16:21:53 19065 INFO  32471/32471 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "16:21:53 19065 INFO  32471/32471 kB (100%), 1/1 tablespace                                         ",
            "16:21:53 19065 INFO  pg_basebackup: write-ahead log end point: 0/3000050",
            "16:21:53 19065 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "16:21:54 19065 INFO  pg_basebackup: base backup completed",
            "16:21:54 19065 INFO  Writing recovery configuration to \"/var/lib/pgsql/ha/recovery.conf\"",
            "16:21:54 19065 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"",
            "16:21:55 19211 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "16:21:56 19064 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 19211",
            "16:21:56 19065 INFO  PostgreSQL started on port 5432",
            "16:21:56 19065 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "16:21:56 19065 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:21:56 19065 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "16:21:56 19065 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:21:56 19065 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "16:21:56 19065 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "16:21:56 19065 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:21:56 19065 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.",
            "16:21:56 19065 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:21:56 19065 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"",
            "16:21:56 19065 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)",
            "16:21:56 19065 INFO  Transition complete: current state is now \"catchingup\"",
            "16:21:57 19065 INFO  keeper has been successfully initialized.",
            "16:21:57 19062 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:21:57 19064 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:21:57 19064 INFO  Stopping pg_autoctl postgres service",
            "16:21:57 19064 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "16:21:57 19062 INFO  Waiting for subprocesses to terminate.",
            "16:21:57 19062 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 16:21:57,735 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 16:21:57,769 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:21:57,783 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:04,429 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:22:04,429 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:22:04,439 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:22:04,475 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:22:04,488 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:04,493 p=53431 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "602211633613.20286",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032570",
        "end": "2022-03-21 16:21:58.926732",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/602211633613.20286",
        "start": "2022-03-21 16:21:58.894162",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:22:04,521 p=53431 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "951616395537.19541",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032420",
        "end": "2022-03-21 16:21:58.925808",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/951616395537.19541",
        "start": "2022-03-21 16:21:58.893388",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:22:04,535 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 16:22:04,568 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:22:04,582 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:05,172 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:22:05,174 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:22:05,184 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 16:22:05,206 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:22:05,221 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:05,971 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:22:05,973 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:22:05,983 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:22:06,003 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:22:06,020 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:06,549 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:22:06,550 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:22:06,560 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 16:22:06,581 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:22:06,598 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:07,171 p=53431 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:22:07,171 p=53431 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:22:07,180 p=53431 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:22:07,216 p=53431 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:22:07,229 p=53431 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:22:07,271 p=53431 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.068907",
        "end": "2022-03-21 16:22:07.578992",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:22:07.510085",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/3000000 |       yes |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/3000000 |       yes |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 16:22:07,273 p=53431 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.067690",
        "end": "2022-03-21 16:22:07.578914",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:22:07.511224",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/3000000 |       yes |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/3000000 |       yes |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 16:22:07,329 p=53431 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 16:22:07,329 p=53431 u=moonja n=ansible | co7-master                 : ok=27   changed=15   unreachable=0    failed=0    skipped=19   rescued=0    ignored=0   
2022-03-21 16:22:07,329 p=53431 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 16:22:07,329 p=53431 u=moonja n=ansible | co7-node02                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 16:22:07,329 p=53431 u=moonja n=ansible | co7-node03                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 16:23:39,953 p=55549 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:23:40,187 p=55549 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:23:40,192 p=55549 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 16:23:40,243 p=55549 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 16:23:40,256 p=55549 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 16:23:40,285 p=55549 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 16:23:42,612 p=55549 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:23:42,614 p=55549 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:23:42,669 p=55549 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:23:42,680 p=55549 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:23:42,696 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] *************************************************************************
2022-03-21 16:23:43,559 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 16:23:43,560 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 16:23:43,565 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 16:23:43,573 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 16:23:43,583 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *********************************************************************
2022-03-21 16:23:44,325 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 16:23:44,328 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 16:23:44,350 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 16:23:44,389 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 16:23:44,915 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 16:23:44,926 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 16:23:44,947 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 16:23:44,991 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 16:23:45,516 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 16:23:45,541 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 16:23:45,552 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 16:23:45,607 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 16:23:46,148 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 16:23:46,152 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 16:23:46,173 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 16:23:46,251 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 16:23:46,264 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 16:23:48,467 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:23:48,478 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:23:48,492 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:23:48,495 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:23:48,506 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] ***************************************************************************
2022-03-21 16:23:50,076 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:23:50,091 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:23:50,103 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:23:50,671 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:23:50,684 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:23:50,723 p=55549 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:23:50,739 p=55549 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:23:50,751 p=55549 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:23:51,491 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:23:51,500 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:23:51,532 p=55549 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:23:51,547 p=55549 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:23:51,557 p=55549 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:23:52,010 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:23:52,018 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 16:23:52,748 p=55549 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:23:52,749 p=55549 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:23:52,766 p=55549 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:23:52,768 p=55549 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:23:52,779 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 16:23:55,983 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:23:55,984 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:23:57,740 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:23:58,005 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:23:58,014 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 16:23:58,035 p=55549 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:23:58,051 p=55549 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:23:58,826 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:23:58,827 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:23:58,836 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 16:23:58,855 p=55549 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:23:58,872 p=55549 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:23:59,566 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:23:59,598 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:23:59,608 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *******************************************
2022-03-21 16:23:59,630 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:23:59,631 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:23:59,635 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:23:59,639 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:23:59,645 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:23:59,646 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 16:23:59,647 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:23:59,647 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:23:59,649 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:23:59,653 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:23:59,654 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:23:59,655 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 16:24:00,348 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:24:00,349 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:24:00,780 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:24:00,780 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:24:01,303 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:24:01,739 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-21 16:24:01,982 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:24:02,143 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:24:02,424 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-21 16:24:02,741 p=55549 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-21 16:24:02,875 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:24:03,363 p=55549 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-21 16:24:03,378 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 16:24:03,398 p=55549 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:24:03,428 p=55549 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:24:03,439 p=55549 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:24:03,879 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:24:03,888 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 16:24:03,908 p=55549 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:24:03,937 p=55549 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:24:03,948 p=55549 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:24:04,679 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:24:04,691 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 16:24:04,729 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:24:04,745 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:24:04,745 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:24:04,746 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:24:04,752 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:24:04,753 p=55549 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-21 16:24:04,772 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:24:04,777 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:24:04,777 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:24:04,777 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:24:04,782 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:24:04,782 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 16:24:04,787 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:24:04,793 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:24:04,794 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:24:04,794 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:24:04,798 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:24:04,798 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 16:24:05,244 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:24:05,684 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:24:06,113 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:24:06,526 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-21 16:24:06,984 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:24:07,473 p=55549 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-21 16:24:07,485 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] ************************************************************************
2022-03-21 16:24:07,518 p=55549 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:24:07,533 p=55549 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:24:07,545 p=55549 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:24:07,981 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:24:07,990 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 16:24:08,024 p=55549 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:24:08,038 p=55549 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:24:08,050 p=55549 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:24:08,943 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:24:08,953 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *********************************************
2022-03-21 16:24:08,992 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:24:08,993 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:24:08,998 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:24:08,999 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:24:09,004 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:24:09,005 p=55549 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-21 16:24:09,006 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:24:09,007 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:24:09,009 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:24:09,012 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:24:09,015 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:24:09,015 p=55549 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-21 16:24:09,021 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-21 16:24:09,023 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-21 16:24:09,026 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-21 16:24:09,028 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-21 16:24:09,031 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-21 16:24:09,031 p=55549 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-21 16:24:09,536 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-21 16:24:10,145 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-21 16:24:10,779 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-21 16:24:11,270 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-21 16:24:11,781 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-21 16:24:13,445 p=55549 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-21 16:24:13,459 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ********************************************************
2022-03-21 16:24:45,887 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:24:47,271 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:24:47,343 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:24:50,567 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:24:50,576 p=55549 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 16:24:51,016 p=55549 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:24:51,044 p=55549 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:24:51,048 p=55549 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:24:51,059 p=55549 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:24:51,101 p=55549 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 16:24:51,102 p=55549 u=moonja n=ansible | co7-master                 : ok=14   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2022-03-21 16:24:51,102 p=55549 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 16:24:51,102 p=55549 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 16:24:51,102 p=55549 u=moonja n=ansible | co7-node03                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-21 16:26:02,123 p=57136 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from 
ansible-core in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:26:02,356 p=57136 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 
2.16. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-21 16:26:02,360 p=57136 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307,
column 3, found a duplicate dict key (when). Using last defined value only.

2022-03-21 16:26:02,407 p=57136 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-21 16:26:02,419 p=57136 u=moonja n=ansible | PLAY [all] *************************************************************************************************************************
2022-03-21 16:26:02,447 p=57136 u=moonja n=ansible | TASK [Gathering Facts] *************************************************************************************************************
2022-03-21 16:26:04,685 p=57136 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:26:04,696 p=57136 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:26:04,828 p=57136 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:26:04,829 p=57136 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:26:04,847 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ******************
2022-03-21 16:26:06,009 p=57136 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-21 16:26:06,010 p=57136 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-21 16:26:06,011 p=57136 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-21 16:26:06,663 p=57136 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-21 16:26:06,804 p=57136 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-21 16:26:06,804 p=57136 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-21 16:26:06,808 p=57136 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-21 16:26:07,409 p=57136 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-21 16:26:07,681 p=57136 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-21 16:26:07,685 p=57136 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-21 16:26:07,713 p=57136 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-21 16:26:08,648 p=57136 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-21 16:26:08,660 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] ***************************************************************************
2022-03-21 16:26:09,941 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:26:09,958 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:26:09,996 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:26:10,009 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:26:10,019 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] *****************************************************************************************
2022-03-21 16:26:11,005 p=57136 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-21 16:26:11,006 p=57136 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-21 16:26:11,007 p=57136 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-21 16:26:11,008 p=57136 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-21 16:26:11,022 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] *****************************************************************************
2022-03-21 16:26:11,833 p=57136 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-21 16:26:11,843 p=57136 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-21 16:26:11,860 p=57136 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-21 16:26:11,861 p=57136 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-21 16:26:12,468 p=57136 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-21 16:26:12,470 p=57136 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-21 16:26:12,487 p=57136 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-21 16:26:12,549 p=57136 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-21 16:26:13,308 p=57136 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-21 16:26:13,322 p=57136 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-21 16:26:13,334 p=57136 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-21 16:26:13,737 p=57136 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-21 16:26:13,922 p=57136 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-21 16:26:13,939 p=57136 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-21 16:26:13,955 p=57136 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-21 16:26:14,321 p=57136 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-21 16:26:14,331 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] **************************************************************************************
2022-03-21 16:26:16,092 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:26:16,101 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:26:16,106 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:26:16,116 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:26:16,126 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ********************************************
2022-03-21 16:26:18,193 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:26:18,200 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:26:18,204 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:26:19,178 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:26:19,187 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] *****************************************************
2022-03-21 16:26:26,020 p=57136 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-21 16:26:26,047 p=57136 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-21 16:26:26,102 p=57136 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-21 16:26:26,110 p=57136 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-21 16:26:26,131 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] **********************************************************
2022-03-21 16:26:48,615 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:26:48,625 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:26:49,540 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:26:50,512 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:26:50,525 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:26:50,558 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:26:50,573 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:26:50,585 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:26:51,396 p=57136 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues
when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-21 16:26:51,396 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:26:51,409 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:26:51,450 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 13.3 (VMware Postgres 13.3.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-21 16:26:51,465 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:26:51,465 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:26:51,477 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:26:51,486 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ******************************************
2022-03-21 16:26:51,532 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:26:51,532 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:26:51,543 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:26:52,069 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:26:52,080 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:26:52,115 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 13.3 (VMware Postgres 13.3.0)"
}
2022-03-21 16:26:52,131 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:26:52,132 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:26:52,144 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:26:52,153 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *********************************************************
2022-03-21 16:26:52,903 p=57136 u=moonja n=ansible | ok: [co7-node01]
2022-03-21 16:26:52,904 p=57136 u=moonja n=ansible | ok: [co7-master]
2022-03-21 16:26:52,912 p=57136 u=moonja n=ansible | ok: [co7-node03]
2022-03-21 16:26:52,913 p=57136 u=moonja n=ansible | ok: [co7-node02]
2022-03-21 16:26:52,923 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *********************************************************************
2022-03-21 16:26:52,969 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:26:52,974 p=57136 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:26:52,989 p=57136 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:26:53,004 p=57136 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-21 16:26:53,015 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] ****************************************************************
2022-03-21 16:26:53,060 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:26:53,064 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:26:53,077 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:26:53,093 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:26:53,103 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:26:53,137 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:26:53,153 p=57136 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:26:53,155 p=57136 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:26:53,167 p=57136 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-21 16:26:53,177 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *******************************************************************************
2022-03-21 16:26:53,209 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:26:53,223 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:26:53,236 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:05,382 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:05,391 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:05,461 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "796055890259.16911",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:08.563634",
        "end": "2022-03-21 16:27:02.854076",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/796055890259.16911",
        "start": "2022-03-21 16:26:54.290442",
        "started": 1,
        "stderr": "16:26:54 16921 INFO  Using default --ssl-mode \"require\"\n16:26:54 16921 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:26:54 16921 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:26:54 16921 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:26:54 16921 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n16:26:54 16921 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n16:26:58 16921 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n16:26:58 16921 INFO  Started pg_autoctl postgres service with pid 16937\n16:26:58 16937 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n16:26:58 16921 INFO  Started pg_autoctl monitor-init service with pid 16938\n16:26:58 16938 INFO  Granting connection privileges on 192.168.0.0/24\n16:26:58 16943 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n16:27:00 16937 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 16943\n16:27:00 16938 WARN  NOTICE:  installing required extension \"btree_gist\"\n16:27:01 16938 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n16:27:01 16938 INFO  Monitor has been successfully initialized.\n16:27:01 16921 WARN  pg_autoctl service monitor-init exited with exit status 0\n16:27:01 16937 INFO  Postgres controller service received signal SIGTERM, terminating\n16:27:01 16937 INFO  Stopping pg_autoctl postgres service\n16:27:01 16937 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n16:27:01 16921 INFO  Waiting for subprocesses to terminate.\n16:27:02 16921 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:26:54 16921 INFO  Using default --ssl-mode \"require\"",
            "16:26:54 16921 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:26:54 16921 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:26:54 16921 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:26:54 16921 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "16:26:54 16921 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "16:26:58 16921 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "16:26:58 16921 INFO  Started pg_autoctl postgres service with pid 16937",
            "16:26:58 16937 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "16:26:58 16921 INFO  Started pg_autoctl monitor-init service with pid 16938",
            "16:26:58 16938 INFO  Granting connection privileges on 192.168.0.0/24",
            "16:26:58 16943 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "16:27:00 16937 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 16943",
            "16:27:00 16938 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "16:27:01 16938 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "16:27:01 16938 INFO  Monitor has been successfully initialized.",
            "16:27:01 16921 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "16:27:01 16937 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:27:01 16937 INFO  Stopping pg_autoctl postgres service",
            "16:27:01 16937 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "16:27:01 16921 INFO  Waiting for subprocesses to terminate.",
            "16:27:02 16921 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:27:05,475 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:05,476 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:05,490 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:05,500 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *******************************************************
2022-03-21 16:27:05,547 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:05,548 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:05,560 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:13,493 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:13,503 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *********************************************************
2022-03-21 16:27:13,538 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:13,552 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:13,565 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:13,984 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:13,996 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] **************************************************
2022-03-21 16:27:14,030 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:14,046 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:14,059 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:15,213 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:15,223 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:15,261 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "-.mount basic.target systemd-journald.socket system.slice",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount basic.target system.slice",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-21 16:27:15,277 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:15,278 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:15,290 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:15,299 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:27:15,335 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:15,351 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:15,363 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:16,063 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:16,071 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] **********************************************************
2022-03-21 16:27:16,106 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:16,121 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:16,133 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:16,659 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:16,669 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:16,710 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.036431",
        "end": "2022-03-21 16:27:17.047176",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:27:17.010745",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 17944     1  0 16:27 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 17947 17944  0 16:27 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 17948 17944  0 16:27 ?        00:00:00 pg_autoctl: monitor listener\npostgres 18022 17947  2 16:27 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres 18072 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: logger \npostgres 18094 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer \npostgres 18095 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: background writer\npostgres 18096 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: walwriter \npostgres 18097 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher\npostgres 18098 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector \npostgres 18099 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor\npostgres 18100 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: logical replication launcher\npostgres 18105 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker\npostgres 18107 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker\npostgres 18179 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle\njomoon   18206 13304  0 16:27 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=czlaaovvkfdmkxjcgiewuvutfhacbrot] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-czlaaovvkfdmkxjcgiewuvutfhacbrot ; /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py' && sleep 0\nroot     18230 18206  0 16:27 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=czlaaovvkfdmkxjcgiewuvutfhacbrot] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-czlaaovvkfdmkxjcgiewuvutfhacbrot ; /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py\npostgres 18231 18230  0 16:27 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-czlaaovvkfdmkxjcgiewuvutfhacbrot ; /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py\npostgres 18232 18231  0 16:27 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py\npostgres 18234 18232  0 16:27 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 18235 18234  0 16:27 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 18236 18235  0 16:27 pts/0    00:00:00 ps -ef\npostgres 18237 18235  0 16:27 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 17944     1  0 16:27 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 17947 17944  0 16:27 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 17948 17944  0 16:27 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 18022 17947  2 16:27 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres 18072 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: logger ",
            "postgres 18094 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: checkpointer ",
            "postgres 18095 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: background writer",
            "postgres 18096 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: walwriter ",
            "postgres 18097 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: autovacuum launcher",
            "postgres 18098 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: stats collector ",
            "postgres 18099 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor",
            "postgres 18100 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: logical replication launcher",
            "postgres 18105 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker",
            "postgres 18107 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: pg_auto_failover monitor worker",
            "postgres 18179 18022  0 16:27 ?        00:00:00 postgres: pg_auto_failover monitor: autoctl_node pg_auto_failover [local] idle",
            "jomoon   18206 13304  0 16:27 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=czlaaovvkfdmkxjcgiewuvutfhacbrot] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-czlaaovvkfdmkxjcgiewuvutfhacbrot ; /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py' && sleep 0",
            "root     18230 18206  0 16:27 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=czlaaovvkfdmkxjcgiewuvutfhacbrot] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-czlaaovvkfdmkxjcgiewuvutfhacbrot ; /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py",
            "postgres 18231 18230  0 16:27 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-czlaaovvkfdmkxjcgiewuvutfhacbrot ; /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py",
            "postgres 18232 18231  0 16:27 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647847636.181525-58610-203086208141054/AnsiballZ_command.py",
            "postgres 18234 18232  0 16:27 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 18235 18234  0 16:27 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 18236 18235  0 16:27 pts/0    00:00:00 ps -ef",
            "postgres 18237 18235  0 16:27 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-21 16:27:16,725 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:16,726 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:16,738 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:16,748 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *******************************************************************
2022-03-21 16:27:16,796 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:16,797 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:16,809 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:17,245 p=57136 u=moonja n=ansible | changed: [co7-master]
2022-03-21 16:27:17,255 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:17,311 p=57136 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.034044",
        "end": "2022-03-21 16:27:17.676186",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:27:17.642142",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-21 16:27:17,326 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:17,327 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:17,339 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:17,348 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 16:27:17,368 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:17,396 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:17,406 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:33,752 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:27:33,761 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:33,794 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:33,814 p=57136 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "814802905459.17635",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:06.261189",
        "end": "2022-03-21 16:27:25.830665",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/814802905459.17635",
        "start": "2022-03-21 16:27:19.569476",
        "started": 1,
        "stderr": "16:27:19 17645 INFO  Using default --ssl-mode \"require\"\n16:27:19 17645 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:27:19 17645 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:27:19 17645 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:27:19 17645 INFO  Started pg_autoctl postgres service with pid 17647\n16:27:19 17647 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:27:19 17645 INFO  Started pg_autoctl node-init service with pid 17648\n16:27:19 17648 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n16:27:19 17648 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n16:27:19 17648 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n16:27:20 17648 INFO  Successfully registered as \"single\" to the monitor.\n16:27:20 17648 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n16:27:20 17648 INFO  Initialising postgres as a primary\n16:27:20 17648 INFO  Initialising a PostgreSQL cluster at \"ha\"\n16:27:20 17648 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n16:27:21 17648 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:27:21 17648 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n16:27:21 17648 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:27:21 17648 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n16:27:21 17648 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n16:27:21 17669 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n16:27:22 17647 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 17669\n16:27:22 17648 INFO  CREATE DATABASE appdb;\n16:27:24 17648 INFO  CREATE EXTENSION pg_stat_statements;\n16:27:24 17648 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n16:27:24 17648 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n16:27:24 17648 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:27:24 17648 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n16:27:24 17648 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:27:24 17648 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n16:27:24 17648 INFO  Transition complete: current state is now \"single\"\n16:27:24 17648 INFO  keeper has been successfully initialized.\n16:27:24 17645 WARN  pg_autoctl service node-init exited with exit status 0\n16:27:24 17647 INFO  Postgres controller service received signal SIGTERM, terminating\n16:27:24 17647 INFO  Stopping pg_autoctl postgres service\n16:27:24 17647 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n16:27:24 17645 INFO  Waiting for subprocesses to terminate.\n16:27:25 17645 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:27:19 17645 INFO  Using default --ssl-mode \"require\"",
            "16:27:19 17645 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:27:19 17645 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:27:19 17645 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:27:19 17645 INFO  Started pg_autoctl postgres service with pid 17647",
            "16:27:19 17647 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:27:19 17645 INFO  Started pg_autoctl node-init service with pid 17648",
            "16:27:19 17648 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "16:27:19 17648 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "16:27:19 17648 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "16:27:20 17648 INFO  Successfully registered as \"single\" to the monitor.",
            "16:27:20 17648 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "16:27:20 17648 INFO  Initialising postgres as a primary",
            "16:27:20 17648 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "16:27:20 17648 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "16:27:21 17648 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:27:21 17648 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "16:27:21 17648 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:27:21 17648 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "16:27:21 17648 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "16:27:21 17669 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "16:27:22 17647 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 17669",
            "16:27:22 17648 INFO  CREATE DATABASE appdb;",
            "16:27:24 17648 INFO  CREATE EXTENSION pg_stat_statements;",
            "16:27:24 17648 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "16:27:24 17648 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "16:27:24 17648 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:27:24 17648 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "16:27:24 17648 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:27:24 17648 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "16:27:24 17648 INFO  Transition complete: current state is now \"single\"",
            "16:27:24 17648 INFO  keeper has been successfully initialized.",
            "16:27:24 17645 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:27:24 17647 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:27:24 17647 INFO  Stopping pg_autoctl postgres service",
            "16:27:24 17647 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "16:27:24 17645 INFO  Waiting for subprocesses to terminate.",
            "16:27:25 17645 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 16:27:33,814 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:33,825 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:33,834 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *******************************************************
2022-03-21 16:27:33,852 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:33,881 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:33,892 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:41,874 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:27:41,884 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:41,905 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:41,937 p=57136 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "825069521193.18137",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031655",
        "end": "2022-03-21 16:27:35.513757",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/825069521193.18137",
        "start": "2022-03-21 16:27:35.482102",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:27:41,938 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:41,946 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:41,959 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] *************************************************
2022-03-21 16:27:41,990 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:42,005 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:42,015 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:42,498 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:27:42,510 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ******************************************
2022-03-21 16:27:42,533 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:42,563 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:42,573 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:43,378 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:27:43,388 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:27:43,407 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:43,437 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:43,449 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:43,964 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:27:43,976 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ******************************************************************
2022-03-21 16:27:43,996 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:44,025 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:44,035 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:44,553 p=57136 u=moonja n=ansible | changed: [co7-node01]
2022-03-21 16:27:44,564 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:27:44,597 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:44,616 p=57136 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.064096",
        "end": "2022-03-21 16:27:44.974572",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:27:44.910476",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/1662668 |       yes |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/1662668 |       yes |              single |              single"
        ]
    }
}
2022-03-21 16:27:44,616 p=57136 u=moonja n=ansible | skipping: [co7-node02]
2022-03-21 16:27:44,626 p=57136 u=moonja n=ansible | skipping: [co7-node03]
2022-03-21 16:27:44,636 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-21 16:27:44,669 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:27:44,683 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:27:56,379 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:28:01,951 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:28:01,959 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:28:01,995 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:02,008 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:02,015 p=57136 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "721599183308.28200",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:10.882728",
        "end": "2022-03-21 16:27:56.569125",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/721599183308.28200",
        "start": "2022-03-21 16:27:45.686397",
        "started": 1,
        "stderr": "16:27:45 28210 INFO  Using default --ssl-mode \"require\"\n16:27:45 28210 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:27:45 28210 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:27:45 28210 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:27:45 28210 INFO  Started pg_autoctl postgres service with pid 28212\n16:27:45 28212 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:27:45 28210 INFO  Started pg_autoctl node-init service with pid 28213\n16:27:46 28213 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"\n16:27:46 28213 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n16:27:46 28213 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n16:27:47 28213 INFO  Successfully registered as \"wait_standby\" to the monitor.\n16:27:47 28213 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n16:27:47 28213 INFO  Transition complete: current state is now \"wait_standby\"\n16:27:47 28213 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n16:27:47 28213 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n16:27:47 28213 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n16:27:47 28213 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n16:27:47 28213 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n16:27:47 28213 INFO  Initialising PostgreSQL as a hot standby\n16:27:47 28213 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3\n16:27:47 28213 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n16:27:50 28213 INFO  pg_basebackup: checkpoint completed\n16:27:50 28213 INFO  pg_basebackup: write-ahead log start point: 0/20000D8 on timeline 1\n16:27:50 28213 INFO  pg_basebackup: starting background WAL receiver\n16:27:50 28213 INFO      0/33120 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)\n16:27:51 28213 INFO  13070/33120 kB (39%), 0/1 tablespace (...ql/backup/node_3/base/14173/2655)\n16:27:51 28213 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)\n16:27:51 28213 INFO  33129/33129 kB (100%), 1/1 tablespace                                         \n16:27:51 28213 INFO  pg_basebackup: write-ahead log end point: 0/3000100\n16:27:51 28213 INFO  pg_basebackup: waiting for background process to finish streaming ...\n16:27:51 28213 INFO  pg_basebackup: syncing data to disk ...\n16:27:53 28213 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest\n16:27:53 28213 INFO  pg_basebackup: base backup completed\n16:27:53 28213 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"\n16:27:53 28213 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"\n16:27:53 28359 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n16:27:55 28212 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 28359\n16:27:55 28213 INFO  PostgreSQL started on port 5432\n16:27:55 28213 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n16:27:55 28213 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:27:55 28213 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n16:27:55 28213 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:27:55 28213 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n16:27:55 28213 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n16:27:55 28213 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:27:55 28213 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.\n16:27:55 28213 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:27:55 28213 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"\n16:27:55 28213 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)\n16:27:55 28213 INFO  Transition complete: current state is now \"catchingup\"\n16:27:56 28213 INFO  keeper has been successfully initialized.\n16:27:56 28210 WARN  pg_autoctl service node-init exited with exit status 0\n16:27:56 28212 INFO  Postgres controller service received signal SIGTERM, terminating\n16:27:56 28212 INFO  Stopping pg_autoctl postgres service\n16:27:56 28212 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n16:27:56 28210 INFO  Waiting for subprocesses to terminate.\n16:27:56 28210 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:27:45 28210 INFO  Using default --ssl-mode \"require\"",
            "16:27:45 28210 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:27:45 28210 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:27:45 28210 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:27:45 28210 INFO  Started pg_autoctl postgres service with pid 28212",
            "16:27:45 28212 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:27:45 28210 INFO  Started pg_autoctl node-init service with pid 28213",
            "16:27:46 28213 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"",
            "16:27:46 28213 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "16:27:46 28213 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "16:27:47 28213 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "16:27:47 28213 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "16:27:47 28213 INFO  Transition complete: current state is now \"wait_standby\"",
            "16:27:47 28213 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "16:27:47 28213 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "16:27:47 28213 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "16:27:47 28213 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "16:27:47 28213 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "16:27:47 28213 INFO  Initialising PostgreSQL as a hot standby",
            "16:27:47 28213 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3",
            "16:27:47 28213 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "16:27:50 28213 INFO  pg_basebackup: checkpoint completed",
            "16:27:50 28213 INFO  pg_basebackup: write-ahead log start point: 0/20000D8 on timeline 1",
            "16:27:50 28213 INFO  pg_basebackup: starting background WAL receiver",
            "16:27:50 28213 INFO      0/33120 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)",
            "16:27:51 28213 INFO  13070/33120 kB (39%), 0/1 tablespace (...ql/backup/node_3/base/14173/2655)",
            "16:27:51 28213 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)",
            "16:27:51 28213 INFO  33129/33129 kB (100%), 1/1 tablespace                                         ",
            "16:27:51 28213 INFO  pg_basebackup: write-ahead log end point: 0/3000100",
            "16:27:51 28213 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "16:27:51 28213 INFO  pg_basebackup: syncing data to disk ...",
            "16:27:53 28213 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest",
            "16:27:53 28213 INFO  pg_basebackup: base backup completed",
            "16:27:53 28213 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"",
            "16:27:53 28213 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"",
            "16:27:53 28359 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "16:27:55 28212 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 28359",
            "16:27:55 28213 INFO  PostgreSQL started on port 5432",
            "16:27:55 28213 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "16:27:55 28213 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:27:55 28213 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "16:27:55 28213 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:27:55 28213 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "16:27:55 28213 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "16:27:55 28213 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:27:55 28213 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.",
            "16:27:55 28213 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:27:55 28213 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"",
            "16:27:55 28213 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)",
            "16:27:55 28213 INFO  Transition complete: current state is now \"catchingup\"",
            "16:27:56 28213 INFO  keeper has been successfully initialized.",
            "16:27:56 28210 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:27:56 28212 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:27:56 28212 INFO  Stopping pg_autoctl postgres service",
            "16:27:56 28212 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "16:27:56 28210 INFO  Waiting for subprocesses to terminate.",
            "16:27:56 28210 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 16:28:02,060 p=57136 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "128310841374.27549",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:10.182647",
        "end": "2022-03-21 16:27:55.865108",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/128310841374.27549",
        "start": "2022-03-21 16:27:45.682461",
        "started": 1,
        "stderr": "16:27:45 27559 INFO  Using default --ssl-mode \"require\"\n16:27:45 27559 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n16:27:45 27559 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n16:27:45 27559 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n16:27:45 27559 INFO  Started pg_autoctl postgres service with pid 27561\n16:27:45 27559 INFO  Started pg_autoctl node-init service with pid 27562\n16:27:45 27561 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n16:27:46 27562 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"\n16:27:46 27562 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n16:27:46 27562 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n16:27:46 27562 INFO  Successfully registered as \"wait_standby\" to the monitor.\n16:27:46 27562 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n16:27:46 27562 INFO  Transition complete: current state is now \"wait_standby\"\n16:27:47 27562 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby\n16:27:47 27562 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n16:27:47 27562 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n16:27:47 27562 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n16:27:47 27562 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n16:27:47 27562 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n16:27:47 27562 INFO  Initialising PostgreSQL as a hot standby\n16:27:47 27562 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2\n16:27:47 27562 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n16:27:49 27562 INFO  pg_basebackup: checkpoint completed\n16:27:49 27562 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1\n16:27:49 27562 INFO  pg_basebackup: starting background WAL receiver\n16:27:49 27562 INFO      0/33121 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)\n16:27:50 27562 INFO  33130/33130 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n16:27:50 27562 INFO  33130/33130 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n16:27:50 27562 INFO  33130/33130 kB (100%), 1/1 tablespace                                         \n16:27:50 27562 INFO  pg_basebackup: write-ahead log end point: 0/2000100\n16:27:50 27562 INFO  pg_basebackup: waiting for background process to finish streaming ...\n16:27:50 27562 INFO  pg_basebackup: syncing data to disk ...\n16:27:51 27562 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest\n16:27:51 27562 INFO  pg_basebackup: base backup completed\n16:27:51 27562 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"\n16:27:51 27562 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"\n16:27:52 27708 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n16:27:54 27561 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 27708\n16:27:54 27562 INFO  PostgreSQL started on port 5432\n16:27:54 27562 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n16:27:54 27562 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:27:54 27562 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n16:27:54 27562 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:27:54 27562 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n16:27:54 27562 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n16:27:54 27562 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n16:27:54 27562 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.\n16:27:54 27562 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n16:27:54 27562 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"\n16:27:54 27562 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)\n16:27:54 27562 INFO  Transition complete: current state is now \"catchingup\"\n16:27:54 27562 INFO  keeper has been successfully initialized.\n16:27:54 27559 WARN  pg_autoctl service node-init exited with exit status 0\n16:27:54 27561 INFO  Postgres controller service received signal SIGTERM, terminating\n16:27:54 27561 INFO  Stopping pg_autoctl postgres service\n16:27:54 27561 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n16:27:55 27559 INFO  Waiting for subprocesses to terminate.\n16:27:55 27559 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "16:27:45 27559 INFO  Using default --ssl-mode \"require\"",
            "16:27:45 27559 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "16:27:45 27559 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "16:27:45 27559 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "16:27:45 27559 INFO  Started pg_autoctl postgres service with pid 27561",
            "16:27:45 27559 INFO  Started pg_autoctl node-init service with pid 27562",
            "16:27:45 27561 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "16:27:46 27562 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"",
            "16:27:46 27562 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "16:27:46 27562 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "16:27:46 27562 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "16:27:46 27562 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "16:27:46 27562 INFO  Transition complete: current state is now \"wait_standby\"",
            "16:27:47 27562 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby",
            "16:27:47 27562 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "16:27:47 27562 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "16:27:47 27562 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "16:27:47 27562 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "16:27:47 27562 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "16:27:47 27562 INFO  Initialising PostgreSQL as a hot standby",
            "16:27:47 27562 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2",
            "16:27:47 27562 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "16:27:49 27562 INFO  pg_basebackup: checkpoint completed",
            "16:27:49 27562 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1",
            "16:27:49 27562 INFO  pg_basebackup: starting background WAL receiver",
            "16:27:49 27562 INFO      0/33121 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)",
            "16:27:50 27562 INFO  33130/33130 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "16:27:50 27562 INFO  33130/33130 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "16:27:50 27562 INFO  33130/33130 kB (100%), 1/1 tablespace                                         ",
            "16:27:50 27562 INFO  pg_basebackup: write-ahead log end point: 0/2000100",
            "16:27:50 27562 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "16:27:50 27562 INFO  pg_basebackup: syncing data to disk ...",
            "16:27:51 27562 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest",
            "16:27:51 27562 INFO  pg_basebackup: base backup completed",
            "16:27:51 27562 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"",
            "16:27:51 27562 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"",
            "16:27:52 27708 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "16:27:54 27561 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 27708",
            "16:27:54 27562 INFO  PostgreSQL started on port 5432",
            "16:27:54 27562 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "16:27:54 27562 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:27:54 27562 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "16:27:54 27562 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:27:54 27562 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "16:27:54 27562 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "16:27:54 27562 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "16:27:54 27562 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.",
            "16:27:54 27562 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "16:27:54 27562 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"",
            "16:27:54 27562 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)",
            "16:27:54 27562 INFO  Transition complete: current state is now \"catchingup\"",
            "16:27:54 27562 INFO  keeper has been successfully initialized.",
            "16:27:54 27559 WARN  pg_autoctl service node-init exited with exit status 0",
            "16:27:54 27561 INFO  Postgres controller service received signal SIGTERM, terminating",
            "16:27:54 27561 INFO  Stopping pg_autoctl postgres service",
            "16:27:54 27561 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "16:27:55 27559 INFO  Waiting for subprocesses to terminate.",
            "16:27:55 27559 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-21 16:28:02,073 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] *****************************************************
2022-03-21 16:28:02,110 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:02,123 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:08,662 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:28:08,860 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:28:08,869 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:28:08,889 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:08,905 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:08,924 p=57136 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "13683770174.28776",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.042954",
        "end": "2022-03-21 16:28:03.287812",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/13683770174.28776",
        "start": "2022-03-21 16:28:03.244858",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:28:08,958 p=57136 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "612263494570.28039",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.034969",
        "end": "2022-03-21 16:28:03.276404",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/612263494570.28039",
        "start": "2022-03-21 16:28:03.241435",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-21 16:28:08,968 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *********************************************
2022-03-21 16:28:08,987 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:09,003 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:09,599 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:28:09,599 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:28:09,607 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] **************************************
2022-03-21 16:28:09,627 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:09,644 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:10,500 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:28:10,502 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:28:10,511 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] ****************************************************************************
2022-03-21 16:28:10,531 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:10,548 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:11,071 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:28:11,071 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:28:11,084 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] ****************************************************************
2022-03-21 16:28:11,103 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:11,133 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:11,925 p=57136 u=moonja n=ansible | changed: [co7-node03]
2022-03-21 16:28:12,244 p=57136 u=moonja n=ansible | changed: [co7-node02]
2022-03-21 16:28:12,256 p=57136 u=moonja n=ansible | TASK [pgfailover-postgres : debug] *************************************************************************************************
2022-03-21 16:28:12,276 p=57136 u=moonja n=ansible | skipping: [co7-master]
2022-03-21 16:28:12,292 p=57136 u=moonja n=ansible | skipping: [co7-node01]
2022-03-21 16:28:12,311 p=57136 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.473070",
        "end": "2022-03-21 16:28:12.630218",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:28:12.157148",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/3000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/4000000 |       yes |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/3000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/4000000 |       yes |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 16:28:12,358 p=57136 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.171683",
        "end": "2022-03-21 16:28:12.330790",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-21 16:28:12.159107",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/3000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/3000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/4000000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-21 16:28:12,405 p=57136 u=moonja n=ansible | PLAY RECAP *************************************************************************************************************************
2022-03-21 16:28:12,405 p=57136 u=moonja n=ansible | co7-master                 : ok=27   changed=15   unreachable=0    failed=0    skipped=19   rescued=0    ignored=0   
2022-03-21 16:28:12,405 p=57136 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 16:28:12,405 p=57136 u=moonja n=ansible | co7-node02                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-21 16:28:12,405 p=57136 u=moonja n=ansible | co7-node03                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-22 02:01:31,533 p=1674 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from ansible-core
 in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-22 02:01:31,801 p=1674 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 2.16. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-22 02:01:31,806 p=1674 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307, column 3,
found a duplicate dict key (when). Using last defined value only.

2022-03-22 02:01:31,856 p=1674 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-22 02:01:31,870 p=1674 u=moonja n=ansible | PLAY [all] ***********************************************************************************************************************************
2022-03-22 02:01:31,899 p=1674 u=moonja n=ansible | TASK [Gathering Facts] ***********************************************************************************************************************
2022-03-22 02:01:33,972 p=1674 u=moonja n=ansible | fatal: [co7-node02]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.0.84 port 22: Connection refused", "unreachable": true}
2022-03-22 02:01:36,764 p=1674 u=moonja n=ansible | fatal: [co7-node01]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host 192.168.0.83 port 22: Connection refused", "unreachable": true}
2022-03-22 02:01:41,242 p=1674 u=moonja n=ansible |  [ERROR]: User interrupted execution

2022-03-22 04:13:45,404 p=15118 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from ansible-core
 in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-22 04:13:45,704 p=15118 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 2.16. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-22 04:13:45,709 p=15118 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307, column 3,
found a duplicate dict key (when). Using last defined value only.

2022-03-22 04:13:45,759 p=15118 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-22 04:13:45,773 p=15118 u=moonja n=ansible | PLAY [all] ***********************************************************************************************************************************
2022-03-22 04:13:45,802 p=15118 u=moonja n=ansible | TASK [Gathering Facts] ***********************************************************************************************************************
2022-03-22 04:13:58,032 p=15118 u=moonja n=ansible | ok: [co7-node03]
2022-03-22 04:13:59,053 p=15118 u=moonja n=ansible | ok: [co7-master]
2022-03-22 04:13:59,571 p=15118 u=moonja n=ansible | ok: [co7-node01]
2022-03-22 04:14:00,280 p=15118 u=moonja n=ansible | ok: [co7-node02]
2022-03-22 04:14:00,297 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Disable port from public zone] ***********************************************************************************
2022-03-22 04:14:02,731 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-22 04:14:02,741 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-22 04:14:02,851 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-22 04:14:02,897 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-22 04:14:02,909 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Disable IP Addresses in whitelist] *******************************************************************************
2022-03-22 04:14:03,684 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-22 04:14:03,694 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-22 04:14:03,695 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-22 04:14:03,700 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-22 04:14:04,319 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-22 04:14:04,326 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-22 04:14:04,332 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-22 04:14:04,369 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-22 04:14:04,935 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-22 04:14:04,945 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-22 04:14:04,962 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-22 04:14:04,969 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-22 04:14:05,590 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-22 04:14:05,608 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-22 04:14:05,615 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-22 04:14:05,617 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-22 04:14:05,629 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] ************************************************************************************************
2022-03-22 04:14:08,288 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:14:08,292 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:14:08,458 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:14:08,779 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:08,792 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Stop and disable firewalld.] *************************************************************************************
2022-03-22 04:14:10,302 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:14:10,303 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:14:10,306 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:14:10,307 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:10,317 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ****************************************************
2022-03-22 04:14:10,350 p=15118 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:14:10,364 p=15118 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:14:10,375 p=15118 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:14:12,487 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:12,496 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ****************************************************
2022-03-22 04:14:12,530 p=15118 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:14:12,544 p=15118 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:14:12,556 p=15118 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:14:12,973 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:12,985 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *******************************************************************
2022-03-22 04:14:15,947 p=15118 u=moonja n=ansible | ok: [co7-node02]
2022-03-22 04:14:15,950 p=15118 u=moonja n=ansible | ok: [co7-node01]
2022-03-22 04:14:15,950 p=15118 u=moonja n=ansible | ok: [co7-master]
2022-03-22 04:14:15,953 p=15118 u=moonja n=ansible | ok: [co7-node03]
2022-03-22 04:14:15,965 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] **************************************************************************
2022-03-22 04:14:17,779 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:14:18,150 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:14:18,279 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:18,327 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:14:18,339 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] **********************************************************************************
2022-03-22 04:14:18,359 p=15118 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:14:18,375 p=15118 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:14:20,160 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:14:20,161 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:14:20,173 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] ************************************************
2022-03-22 04:14:20,193 p=15118 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:14:20,210 p=15118 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:14:20,917 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:14:20,923 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:14:20,933 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Delete secondary systemd service file of secondary instance] *****************************************************
2022-03-22 04:14:20,955 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:20,956 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:20,959 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:20,963 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:20,964 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:20,970 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-22 04:14:20,971 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:20,971 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:20,972 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:20,975 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:20,978 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:20,978 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-22 04:14:21,642 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-22 04:14:21,643 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-22 04:14:22,076 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-22 04:14:22,077 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-22 04:14:22,476 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.bash_profile)
2022-03-22 04:14:22,476 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.bash_profile)
2022-03-22 04:14:22,877 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.config)
2022-03-22 04:14:22,878 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.config)
2022-03-22 04:14:23,299 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql/.ansible)
2022-03-22 04:14:23,299 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql/.ansible)
2022-03-22 04:14:23,807 p=15118 u=moonja n=ansible | changed: [co7-node03] => (item=/var/lib/pgsql)
2022-03-22 04:14:24,711 p=15118 u=moonja n=ansible | changed: [co7-node02] => (item=/var/lib/pgsql)
2022-03-22 04:14:24,724 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] **********************************************************************************
2022-03-22 04:14:24,757 p=15118 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:14:24,800 p=15118 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:14:24,814 p=15118 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:14:25,357 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:14:25,369 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ****************************************************
2022-03-22 04:14:25,390 p=15118 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:14:25,418 p=15118 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:14:25,428 p=15118 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:14:26,145 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:14:26,156 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *******************************************************
2022-03-22 04:14:26,180 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:26,182 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:26,186 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:26,191 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:26,196 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:26,197 p=15118 u=moonja n=ansible | skipping: [co7-master] => (item=/var/lib/pgsql) 
2022-03-22 04:14:26,214 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:26,215 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:26,218 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:26,220 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:26,223 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:26,223 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-22 04:14:26,228 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:26,231 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:26,236 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:26,237 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:26,237 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:26,239 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-22 04:14:26,684 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-22 04:14:27,108 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-22 04:14:27,504 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.bash_profile)
2022-03-22 04:14:27,949 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.config)
2022-03-22 04:14:28,345 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql/.ansible)
2022-03-22 04:14:28,826 p=15118 u=moonja n=ansible | changed: [co7-node01] => (item=/var/lib/pgsql)
2022-03-22 04:14:28,838 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Delete line in a .bash_profile] **********************************************************************************
2022-03-22 04:14:28,871 p=15118 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:14:28,886 p=15118 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:14:28,898 p=15118 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:14:29,335 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:29,346 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] ************************************************************
2022-03-22 04:14:29,380 p=15118 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:14:29,394 p=15118 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:14:29,406 p=15118 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:14:30,093 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:14:30,105 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Delete primary systemd service file of secondary instance] *******************************************************
2022-03-22 04:14:30,143 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:30,148 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:30,148 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:30,148 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:30,156 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:30,157 p=15118 u=moonja n=ansible | skipping: [co7-node01] => (item=/var/lib/pgsql) 
2022-03-22 04:14:30,158 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:30,160 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:30,163 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:30,165 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:30,168 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:30,170 p=15118 u=moonja n=ansible | skipping: [co7-node02] => (item=/var/lib/pgsql) 
2022-03-22 04:14:30,174 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/etc/systemd/system/pgautofailover.service) 
2022-03-22 04:14:30,177 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/pgautofailover.service) 
2022-03-22 04:14:30,179 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.bash_profile) 
2022-03-22 04:14:30,182 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.config) 
2022-03-22 04:14:30,184 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql/.ansible) 
2022-03-22 04:14:30,184 p=15118 u=moonja n=ansible | skipping: [co7-node03] => (item=/var/lib/pgsql) 
2022-03-22 04:14:30,646 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=/etc/systemd/system/pgautofailover.service)
2022-03-22 04:14:31,072 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/pgautofailover.service)
2022-03-22 04:14:31,561 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.bash_profile)
2022-03-22 04:14:32,007 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.config)
2022-03-22 04:14:32,478 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql/.ansible)
2022-03-22 04:14:34,200 p=15118 u=moonja n=ansible | changed: [co7-master] => (item=/var/lib/pgsql)
2022-03-22 04:14:34,214 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Uninstall VMware Postgres on all hosts as root] ******************************************************************
2022-03-22 04:16:29,250 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:16:39,387 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:16:39,418 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:16:39,730 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:16:39,739 p=15118 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ******************************************************
2022-03-22 04:16:40,195 p=15118 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:16:40,197 p=15118 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:16:40,211 p=15118 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:16:40,217 p=15118 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:16:40,261 p=15118 u=moonja n=ansible | PLAY RECAP ***********************************************************************************************************************************
2022-03-22 04:16:40,261 p=15118 u=moonja n=ansible | co7-master                 : ok=14   changed=12   unreachable=0    failed=0    skipped=6    rescued=0    ignored=0   
2022-03-22 04:16:40,261 p=15118 u=moonja n=ansible | co7-node01                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-22 04:16:40,261 p=15118 u=moonja n=ansible | co7-node02                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-22 04:16:40,262 p=15118 u=moonja n=ansible | co7-node03                 : ok=12   changed=10   unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2022-03-22 04:16:40,841 p=17297 u=moonja n=ansible | [DEPRECATION WARNING]: COMMAND_WARNINGS option, the command warnings feature is being removed. This feature will be removed from ansible-core
 in version 2.14. Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-22 04:16:41,088 p=17297 u=moonja n=ansible | [DEPRECATION WARNING]: "include" is deprecated, use include_tasks/import_tasks instead. This feature will be removed in version 2.16. 
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
2022-03-22 04:16:41,092 p=17297 u=moonja n=ansible | [WARNING]: While constructing a mapping from /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/install.yml, line 307, column 3,
found a duplicate dict key (when). Using last defined value only.

2022-03-22 04:16:41,139 p=17297 u=moonja n=ansible | [WARNING]: file /Users/moonja/postgres-cluster/roles/pgfailover-postgres/tasks/upgrade.yml is empty and had no tasks to include

2022-03-22 04:16:41,152 p=17297 u=moonja n=ansible | PLAY [all] ***********************************************************************************************************************************
2022-03-22 04:16:41,180 p=17297 u=moonja n=ansible | TASK [Gathering Facts] ***********************************************************************************************************************
2022-03-22 04:16:43,287 p=17297 u=moonja n=ansible | ok: [co7-node02]
2022-03-22 04:16:43,296 p=17297 u=moonja n=ansible | ok: [co7-node01]
2022-03-22 04:16:43,297 p=17297 u=moonja n=ansible | ok: [co7-master]
2022-03-22 04:16:43,302 p=17297 u=moonja n=ansible | ok: [co7-node03]
2022-03-22 04:16:43,319 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Install rpm packages of dependenies to need installing packages regarding kubernates] ****************************
2022-03-22 04:16:44,409 p=17297 u=moonja n=ansible | ok: [co7-master] => (item=firewalld)
2022-03-22 04:16:44,421 p=17297 u=moonja n=ansible | ok: [co7-node01] => (item=firewalld)
2022-03-22 04:16:44,426 p=17297 u=moonja n=ansible | ok: [co7-node02] => (item=firewalld)
2022-03-22 04:16:44,445 p=17297 u=moonja n=ansible | ok: [co7-node03] => (item=firewalld)
2022-03-22 04:16:45,124 p=17297 u=moonja n=ansible | ok: [co7-master] => (item=python3)
2022-03-22 04:16:45,175 p=17297 u=moonja n=ansible | ok: [co7-node03] => (item=python3)
2022-03-22 04:16:45,177 p=17297 u=moonja n=ansible | ok: [co7-node01] => (item=python3)
2022-03-22 04:16:45,186 p=17297 u=moonja n=ansible | ok: [co7-node02] => (item=python3)
2022-03-22 04:16:50,767 p=17297 u=moonja n=ansible | ok: [co7-node01] => (item=python3-libselinux)
2022-03-22 04:16:51,266 p=17297 u=moonja n=ansible | ok: [co7-master] => (item=python3-libselinux)
2022-03-22 04:16:52,554 p=17297 u=moonja n=ansible | ok: [co7-node02] => (item=python3-libselinux)
2022-03-22 04:16:52,570 p=17297 u=moonja n=ansible | ok: [co7-node03] => (item=python3-libselinux)
2022-03-22 04:16:52,581 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Start and enable firewalld.] *************************************************************************************
2022-03-22 04:16:53,815 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:16:53,859 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:16:53,864 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:16:53,966 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:16:53,975 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Open Firewall] ***************************************************************************************************
2022-03-22 04:16:55,034 p=17297 u=moonja n=ansible | changed: [co7-node03] => (item=5432)
2022-03-22 04:16:55,046 p=17297 u=moonja n=ansible | changed: [co7-master] => (item=5432)
2022-03-22 04:16:55,047 p=17297 u=moonja n=ansible | changed: [co7-node02] => (item=5432)
2022-03-22 04:16:55,049 p=17297 u=moonja n=ansible | changed: [co7-node01] => (item=5432)
2022-03-22 04:16:55,058 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Whitelist of Ip addresses] ***************************************************************************************
2022-03-22 04:16:55,780 p=17297 u=moonja n=ansible | changed: [co7-master] => (item=co7-master)
2022-03-22 04:16:55,789 p=17297 u=moonja n=ansible | changed: [co7-node01] => (item=co7-master)
2022-03-22 04:16:55,791 p=17297 u=moonja n=ansible | changed: [co7-node02] => (item=co7-master)
2022-03-22 04:16:55,805 p=17297 u=moonja n=ansible | changed: [co7-node03] => (item=co7-master)
2022-03-22 04:16:56,425 p=17297 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node01)
2022-03-22 04:16:56,428 p=17297 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node01)
2022-03-22 04:16:56,431 p=17297 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node01)
2022-03-22 04:16:57,283 p=17297 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node02)
2022-03-22 04:16:57,284 p=17297 u=moonja n=ansible | changed: [co7-master] => (item=co7-node01)
2022-03-22 04:16:57,285 p=17297 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node02)
2022-03-22 04:16:57,457 p=17297 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node02)
2022-03-22 04:16:57,958 p=17297 u=moonja n=ansible | changed: [co7-master] => (item=co7-node02)
2022-03-22 04:16:57,966 p=17297 u=moonja n=ansible | changed: [co7-node03] => (item=co7-node03)
2022-03-22 04:16:57,967 p=17297 u=moonja n=ansible | changed: [co7-node02] => (item=co7-node03)
2022-03-22 04:16:58,110 p=17297 u=moonja n=ansible | changed: [co7-node01] => (item=co7-node03)
2022-03-22 04:16:58,525 p=17297 u=moonja n=ansible | changed: [co7-master] => (item=co7-node03)
2022-03-22 04:16:58,536 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Bounce firewalld] ************************************************************************************************
2022-03-22 04:17:00,096 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:00,106 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:17:00,124 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:17:00,125 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:17:00,137 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Copy the vmwawre-postgres rpm file to all hosts in cluster] ******************************************************
2022-03-22 04:17:01,658 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:17:01,660 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:17:01,760 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:01,770 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:17:01,780 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Install dependency rpm package for pgautofailover] ***************************************************************
2022-03-22 04:17:08,538 p=17297 u=moonja n=ansible | ok: [co7-master] => (item=python2-psutil)
2022-03-22 04:17:08,546 p=17297 u=moonja n=ansible | ok: [co7-node03] => (item=python2-psutil)
2022-03-22 04:17:08,618 p=17297 u=moonja n=ansible | ok: [co7-node02] => (item=python2-psutil)
2022-03-22 04:17:09,214 p=17297 u=moonja n=ansible | ok: [co7-node01] => (item=python2-psutil)
2022-03-22 04:17:09,224 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Install VMware Postgres on all hosts as root] ********************************************************************
2022-03-22 04:17:31,619 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:17:31,629 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:31,658 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:17:32,367 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:17:32,376 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ****************************************************
2022-03-22 04:17:32,411 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:32,427 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:32,439 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:33,014 p=17297 u=moonja n=ansible | [WARNING]: Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when
running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually

2022-03-22 04:17:33,014 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:33,025 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:33,060 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_autoctl version 1.4.2\npg_autoctl extension version 1.4\ncompiled with PostgreSQL 13.3 (VMware Postgres 13.3.0) on x86_64-redhat-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\ncompatible with Postgres 10, 11, 12, and 13"
}
2022-03-22 04:17:33,077 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:33,077 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:33,088 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:33,098 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Verify that pg_auto_failover/postgres was installed properly] ****************************************************
2022-03-22 04:17:33,130 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:33,145 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:33,156 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:33,573 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:33,583 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:33,619 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "pg_ctl (PostgreSQL) 13.3 (VMware Postgres 13.3.0)"
}
2022-03-22 04:17:33,634 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:33,635 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:33,647 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:33,656 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Getting process IDs of the pg_autoctl process] *******************************************************************
2022-03-22 04:17:34,389 p=17297 u=moonja n=ansible | ok: [co7-master]
2022-03-22 04:17:34,391 p=17297 u=moonja n=ansible | ok: [co7-node03]
2022-03-22 04:17:34,400 p=17297 u=moonja n=ansible | ok: [co7-node01]
2022-03-22 04:17:34,406 p=17297 u=moonja n=ansible | ok: [co7-node02]
2022-03-22 04:17:34,415 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Printing the process IDs obtained] *******************************************************************************
2022-03-22 04:17:34,462 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-22 04:17:34,467 p=17297 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-22 04:17:34,480 p=17297 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-22 04:17:34,497 p=17297 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": "PIDS of pg_autoctl:"
}
2022-03-22 04:17:34,506 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Stop pgautofailover service of systemd] **************************************************************************
2022-03-22 04:17:34,552 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:17:34,556 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:34,571 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:34,587 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:34,598 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:34,634 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-22 04:17:34,652 p=17297 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-22 04:17:34,652 p=17297 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-22 04:17:34,665 p=17297 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": false,
        "skip_reason": "Conditional result was False",
        "skipped": true
    }
}
2022-03-22 04:17:34,675 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Create the monitor node] *****************************************************************************************
2022-03-22 04:17:34,710 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:34,724 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:34,736 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:46,403 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:46,411 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:46,466 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "ansible_job_id": "517647902031.27800",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl create monitor --auth trust --ssl-self-signed --pgdata monitor )",
        "delta": "0:00:09.124989",
        "end": "2022-03-22 04:17:44.628766",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/517647902031.27800",
        "start": "2022-03-22 04:17:35.503777",
        "started": 1,
        "stderr": "04:17:35 27810 INFO  Using default --ssl-mode \"require\"\n04:17:35 27810 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n04:17:35 27810 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n04:17:35 27810 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n04:17:35 27810 INFO  Initialising a PostgreSQL cluster at \"monitor\"\n04:17:35 27810 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'\n04:17:40 27810 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"\n04:17:40 27810 INFO  Started pg_autoctl postgres service with pid 27907\n04:17:40 27810 INFO  Started pg_autoctl monitor-init service with pid 27908\n04:17:40 27907 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v\n04:17:40 27908 INFO  Granting connection privileges on 192.168.0.0/24\n04:17:40 27940 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\n04:17:41 27907 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 27940\n04:17:42 27908 WARN  NOTICE:  installing required extension \"btree_gist\"\n04:17:43 27908 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.\n04:17:43 27908 INFO  Monitor has been successfully initialized.\n04:17:43 27810 WARN  pg_autoctl service monitor-init exited with exit status 0\n04:17:43 27907 INFO  Postgres controller service received signal SIGTERM, terminating\n04:17:43 27907 INFO  Stopping pg_autoctl postgres service\n04:17:43 27907 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast\n04:17:43 27810 INFO  Waiting for subprocesses to terminate.\n04:17:44 27810 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "04:17:35 27810 INFO  Using default --ssl-mode \"require\"",
            "04:17:35 27810 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "04:17:35 27810 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "04:17:35 27810 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "04:17:35 27810 INFO  Initialising a PostgreSQL cluster at \"monitor\"",
            "04:17:35 27810 INFO  /bin/pg_ctl initdb -s -D monitor --option '--auth=trust'",
            "04:17:40 27810 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/monitor/server.crt -keyout /var/lib/pgsql/monitor/server.key -subj \"/CN=co7-master\"",
            "04:17:40 27810 INFO  Started pg_autoctl postgres service with pid 27907",
            "04:17:40 27810 INFO  Started pg_autoctl monitor-init service with pid 27908",
            "04:17:40 27907 INFO   /usr/bin/pg_autoctl do service postgres --pgdata monitor -v",
            "04:17:40 27908 INFO  Granting connection privileges on 192.168.0.0/24",
            "04:17:40 27940 INFO   /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "04:17:41 27907 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/monitor\" on port 5432 with pid 27940",
            "04:17:42 27908 WARN  NOTICE:  installing required extension \"btree_gist\"",
            "04:17:43 27908 INFO  Your pg_auto_failover monitor instance is now ready on port 5432.",
            "04:17:43 27908 INFO  Monitor has been successfully initialized.",
            "04:17:43 27810 WARN  pg_autoctl service monitor-init exited with exit status 0",
            "04:17:43 27907 INFO  Postgres controller service received signal SIGTERM, terminating",
            "04:17:43 27907 INFO  Stopping pg_autoctl postgres service",
            "04:17:43 27907 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/monitor --wait stop --mode fast",
            "04:17:43 27810 INFO  Waiting for subprocesses to terminate.",
            "04:17:44 27810 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-22 04:17:46,478 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:46,479 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:46,491 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:46,501 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of monitor instance] *****************************************************************
2022-03-22 04:17:46,535 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:46,550 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:46,563 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:53,208 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:53,215 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Copy systemd service file of monitor instance] *******************************************************************
2022-03-22 04:17:53,263 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:53,264 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:53,275 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:53,727 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:53,736 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start systemd service of monitor instance] ************************************************************
2022-03-22 04:17:53,769 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:53,784 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:53,797 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:54,918 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:54,928 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:54,966 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "enabled": true,
        "failed": false,
        "name": "pgautofailover",
        "state": "started",
        "status": {
            "ActiveEnterTimestampMonotonic": "0",
            "ActiveExitTimestampMonotonic": "0",
            "ActiveState": "inactive",
            "After": "basic.target systemd-journald.socket -.mount system.slice",
            "AllowIsolate": "no",
            "AmbientCapabilities": "0",
            "AssertResult": "no",
            "AssertTimestampMonotonic": "0",
            "Before": "shutdown.target",
            "BlockIOAccounting": "no",
            "BlockIOWeight": "18446744073709551615",
            "CPUAccounting": "no",
            "CPUQuotaPerSecUSec": "infinity",
            "CPUSchedulingPolicy": "0",
            "CPUSchedulingPriority": "0",
            "CPUSchedulingResetOnFork": "no",
            "CPUShares": "18446744073709551615",
            "CanIsolate": "no",
            "CanReload": "no",
            "CanStart": "yes",
            "CanStop": "yes",
            "CapabilityBoundingSet": "18446744073709551615",
            "CollectMode": "inactive",
            "ConditionResult": "no",
            "ConditionTimestampMonotonic": "0",
            "Conflicts": "shutdown.target",
            "ControlPID": "0",
            "DefaultDependencies": "yes",
            "Delegate": "no",
            "Description": "pg_auto_failover",
            "DevicePolicy": "auto",
            "Environment": "PGDATA=/var/lib/pgsql/monitor",
            "ExecMainCode": "0",
            "ExecMainExitTimestampMonotonic": "0",
            "ExecMainPID": "0",
            "ExecMainStartTimestampMonotonic": "0",
            "ExecMainStatus": "0",
            "ExecStart": "{ path=/usr/bin/pg_autoctl ; argv[]=/usr/bin/pg_autoctl run ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }",
            "FailureAction": "none",
            "FileDescriptorStoreMax": "0",
            "FragmentPath": "/etc/systemd/system/pgautofailover.service",
            "GuessMainPID": "yes",
            "IOScheduling": "0",
            "Id": "pgautofailover.service",
            "IgnoreOnIsolate": "no",
            "IgnoreOnSnapshot": "no",
            "IgnoreSIGPIPE": "yes",
            "InactiveEnterTimestampMonotonic": "0",
            "InactiveExitTimestampMonotonic": "0",
            "JobTimeoutAction": "none",
            "JobTimeoutUSec": "0",
            "KillMode": "control-group",
            "KillSignal": "15",
            "LimitAS": "18446744073709551615",
            "LimitCORE": "18446744073709551615",
            "LimitCPU": "18446744073709551615",
            "LimitDATA": "18446744073709551615",
            "LimitFSIZE": "18446744073709551615",
            "LimitLOCKS": "18446744073709551615",
            "LimitMEMLOCK": "65536",
            "LimitMSGQUEUE": "819200",
            "LimitNICE": "0",
            "LimitNOFILE": "4096",
            "LimitNPROC": "47321",
            "LimitRSS": "18446744073709551615",
            "LimitRTPRIO": "0",
            "LimitRTTIME": "18446744073709551615",
            "LimitSIGPENDING": "47321",
            "LimitSTACK": "18446744073709551615",
            "LoadState": "loaded",
            "MainPID": "0",
            "MemoryAccounting": "no",
            "MemoryCurrent": "18446744073709551615",
            "MemoryLimit": "18446744073709551615",
            "MountFlags": "0",
            "Names": "pgautofailover.service",
            "NeedDaemonReload": "no",
            "Nice": "0",
            "NoNewPrivileges": "no",
            "NonBlocking": "no",
            "NotifyAccess": "none",
            "OOMScoreAdjust": "0",
            "OnFailureJobMode": "replace",
            "PermissionsStartOnly": "no",
            "PrivateDevices": "no",
            "PrivateNetwork": "no",
            "PrivateTmp": "no",
            "ProtectHome": "no",
            "ProtectSystem": "no",
            "RefuseManualStart": "no",
            "RefuseManualStop": "no",
            "RemainAfterExit": "no",
            "Requires": "-.mount system.slice basic.target",
            "RequiresMountsFor": "/var/lib/pgsql",
            "Restart": "always",
            "RestartUSec": "100ms",
            "Result": "success",
            "RootDirectoryStartOnly": "no",
            "RuntimeDirectoryMode": "0755",
            "SameProcessGroup": "no",
            "SecureBits": "0",
            "SendSIGHUP": "no",
            "SendSIGKILL": "yes",
            "Slice": "system.slice",
            "StandardError": "inherit",
            "StandardInput": "null",
            "StandardOutput": "journal",
            "StartLimitAction": "none",
            "StartLimitBurst": "0",
            "StartLimitInterval": "10000000",
            "StartupBlockIOWeight": "18446744073709551615",
            "StartupCPUShares": "18446744073709551615",
            "StatusErrno": "0",
            "StopWhenUnneeded": "no",
            "SubState": "dead",
            "SyslogLevelPrefix": "yes",
            "SyslogPriority": "30",
            "SystemCallErrorNumber": "0",
            "TTYReset": "no",
            "TTYVHangup": "no",
            "TTYVTDisallocate": "no",
            "TasksAccounting": "no",
            "TasksCurrent": "18446744073709551615",
            "TasksMax": "18446744073709551615",
            "TimeoutStartUSec": "1min 30s",
            "TimeoutStopUSec": "1min 30s",
            "TimerSlackNSec": "50000",
            "Transient": "no",
            "Type": "simple",
            "UMask": "0022",
            "UnitFilePreset": "disabled",
            "UnitFileState": "disabled",
            "User": "postgres",
            "WatchdogTimestampMonotonic": "0",
            "WatchdogUSec": "0",
            "WorkingDirectory": "/var/lib/pgsql"
        }
    }
}
2022-03-22 04:17:54,981 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:54,981 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:54,993 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:55,002 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] **************************************************************************************
2022-03-22 04:17:55,036 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:55,051 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:55,062 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:56,713 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:56,721 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor instance] ********************************************************************
2022-03-22 04:17:56,756 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:56,771 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:56,782 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:57,609 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:57,619 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:57,666 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( ps -ef | grep postgres )",
        "delta": "0:00:00.372650",
        "end": "2022-03-22 04:17:57.802762",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-22 04:17:57.430112",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "postgres 28834     1  0 04:17 ?        00:00:00 /usr/bin/pg_autoctl run\npostgres 28837 28834  0 04:17 ?        00:00:00 pg_autoctl: start/stop postgres\npostgres 28838 28834  0 04:17 ?        00:00:00 pg_autoctl: monitor listener\npostgres 28869 28837  0 04:17 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *\npostgres 28913 28869  0 04:17 ?        00:00:00 postgres: pg_auto_failover monitor: logger \njomoon   29085 18800  0 04:17 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=uawqzlxdcbxxywaqmdamqlmgcxtbqsig] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-uawqzlxdcbxxywaqmdamqlmgcxtbqsig ; /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py' && sleep 0\nroot     29109 29085  0 04:17 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=uawqzlxdcbxxywaqmdamqlmgcxtbqsig] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-uawqzlxdcbxxywaqmdamqlmgcxtbqsig ; /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py\npostgres 29110 29109  0 04:17 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-uawqzlxdcbxxywaqmdamqlmgcxtbqsig ; /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py\npostgres 29111 29110  5 04:17 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py\npostgres 29113 29111  2 04:17 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 29114 29113  0 04:17 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )\npostgres 29115 29114  3 04:17 pts/0    00:00:00 ps -ef\npostgres 29116 29114  0 04:17 pts/0    00:00:00 grep postgres",
        "stdout_lines": [
            "postgres 28834     1  0 04:17 ?        00:00:00 /usr/bin/pg_autoctl run",
            "postgres 28837 28834  0 04:17 ?        00:00:00 pg_autoctl: start/stop postgres",
            "postgres 28838 28834  0 04:17 ?        00:00:00 pg_autoctl: monitor listener",
            "postgres 28869 28837  0 04:17 ?        00:00:00 /bin/postgres -D /var/lib/pgsql/monitor -p 5432 -h *",
            "postgres 28913 28869  0 04:17 ?        00:00:00 postgres: pg_auto_failover monitor: logger ",
            "jomoon   29085 18800  0 04:17 pts/0    00:00:00 /bin/sh -c sudo -H -S  -p \"[sudo via ansible, key=uawqzlxdcbxxywaqmdamqlmgcxtbqsig] password:\" -u postgres /bin/sh -c 'echo BECOME-SUCCESS-uawqzlxdcbxxywaqmdamqlmgcxtbqsig ; /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py' && sleep 0",
            "root     29109 29085  0 04:17 pts/0    00:00:00 sudo -H -S -p [sudo via ansible, key=uawqzlxdcbxxywaqmdamqlmgcxtbqsig] password: -u postgres /bin/sh -c echo BECOME-SUCCESS-uawqzlxdcbxxywaqmdamqlmgcxtbqsig ; /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py",
            "postgres 29110 29109  0 04:17 pts/0    00:00:00 /bin/sh -c echo BECOME-SUCCESS-uawqzlxdcbxxywaqmdamqlmgcxtbqsig ; /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py",
            "postgres 29111 29110  5 04:17 pts/0    00:00:00 /usr/bin/python /var/tmp/ansible-tmp-1647890276.812725-18873-153200264375248/AnsiballZ_command.py",
            "postgres 29113 29111  2 04:17 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 29114 29113  0 04:17 pts/0    00:00:00 /bin/sh -c ( ps -ef | grep postgres )",
            "postgres 29115 29114  3 04:17 pts/0    00:00:00 ps -ef",
            "postgres 29116 29114  0 04:17 pts/0    00:00:00 grep postgres"
        ]
    }
}
2022-03-22 04:17:57,679 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:57,679 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:57,691 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:57,701 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the current state of monitor] *****************************************************************************
2022-03-22 04:17:57,733 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:57,749 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:57,760 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:58,199 p=17297 u=moonja n=ansible | changed: [co7-master]
2022-03-22 04:17:58,217 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:17:58,265 p=17297 u=moonja n=ansible | ok: [co7-master] => {
    "msg": {
        "changed": true,
        "cmd": "( psql -c \"\\l\" )",
        "delta": "0:00:00.034556",
        "end": "2022-03-22 04:17:58.402280",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-22 04:17:58.367724",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "                                    List of databases\n       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   \n------------------+----------+----------+------------+------------+-----------------------\n pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | \n postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | \n template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +\n                  |          |          |            |            | postgres=CTc/postgres\n(4 rows)",
        "stdout_lines": [
            "                                    List of databases",
            "       Name       |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   ",
            "------------------+----------+----------+------------+------------+-----------------------",
            " pg_auto_failover | autoctl  | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " postgres         | postgres | UTF8     | en_US.utf8 | en_US.utf8 | ",
            " template0        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            " template1        | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +",
            "                  |          |          |            |            | postgres=CTc/postgres",
            "(4 rows)"
        ]
    }
}
2022-03-22 04:17:58,278 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:17:58,278 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:58,291 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:17:58,313 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Create primiary instance. It will automatically be set by the monitor as the primary node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-22 04:17:58,333 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:17:58,363 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:17:58,375 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:09,993 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:18:10,002 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:18:10,026 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:10,066 p=17297 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "279438537257.23690",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node01\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:09.976259",
        "end": "2022-03-22 04:18:09.396435",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/279438537257.23690",
        "start": "2022-03-22 04:17:59.420176",
        "started": 1,
        "stderr": "04:17:59 23700 INFO  Using default --ssl-mode \"require\"\n04:17:59 23700 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n04:17:59 23700 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n04:17:59 23700 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n04:17:59 23700 INFO  Started pg_autoctl postgres service with pid 23702\n04:17:59 23702 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n04:17:59 23700 INFO  Started pg_autoctl node-init service with pid 23703\n04:17:59 23703 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"\n04:17:59 23703 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n04:17:59 23703 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n04:17:59 23703 INFO  Successfully registered as \"single\" to the monitor.\n04:17:59 23703 INFO  FSM transition from \"init\" to \"single\": Start as a single node\n04:17:59 23703 INFO  Initialising postgres as a primary\n04:17:59 23703 INFO  Initialising a PostgreSQL cluster at \"ha\"\n04:17:59 23703 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'\n04:18:06 23703 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n04:18:06 23703 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n04:18:06 23703 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n04:18:06 23703 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n04:18:06 23703 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n04:18:06 23855 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n04:18:07 23702 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 23855\n04:18:07 23703 INFO  CREATE DATABASE appdb;\n04:18:08 23703 INFO  CREATE EXTENSION pg_stat_statements;\n04:18:08 23703 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"\n04:18:08 23703 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting\n04:18:08 23703 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n04:18:08 23703 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.\n04:18:08 23703 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n04:18:08 23703 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"\n04:18:08 23703 INFO  Transition complete: current state is now \"single\"\n04:18:08 23703 INFO  keeper has been successfully initialized.\n04:18:08 23700 WARN  pg_autoctl service node-init exited with exit status 0\n04:18:08 23702 INFO  Postgres controller service received signal SIGTERM, terminating\n04:18:08 23702 INFO  Stopping pg_autoctl postgres service\n04:18:08 23702 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n04:18:08 23700 INFO  Waiting for subprocesses to terminate.\n04:18:09 23700 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "04:17:59 23700 INFO  Using default --ssl-mode \"require\"",
            "04:17:59 23700 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "04:17:59 23700 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "04:17:59 23700 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "04:17:59 23700 INFO  Started pg_autoctl postgres service with pid 23702",
            "04:17:59 23702 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "04:17:59 23700 INFO  Started pg_autoctl node-init service with pid 23703",
            "04:17:59 23703 INFO  Registered node 1 (co7-node01:5432) with name \"node_1\" in formation \"default\", group 0, state \"single\"",
            "04:17:59 23703 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "04:17:59 23703 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "04:17:59 23703 INFO  Successfully registered as \"single\" to the monitor.",
            "04:17:59 23703 INFO  FSM transition from \"init\" to \"single\": Start as a single node",
            "04:17:59 23703 INFO  Initialising postgres as a primary",
            "04:17:59 23703 INFO  Initialising a PostgreSQL cluster at \"ha\"",
            "04:17:59 23703 INFO  /bin/pg_ctl initdb -s -D ha --option '--auth=trust'",
            "04:18:06 23703 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "04:18:06 23703 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "04:18:06 23703 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "04:18:06 23703 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "04:18:06 23703 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "04:18:06 23855 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "04:18:07 23702 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 23855",
            "04:18:07 23703 INFO  CREATE DATABASE appdb;",
            "04:18:08 23703 INFO  CREATE EXTENSION pg_stat_statements;",
            "04:18:08 23703 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node01\"",
            "04:18:08 23703 INFO  Contents of \"/var/lib/pgsql/ha/postgresql-auto-failover.conf\" have changed, overwriting",
            "04:18:08 23703 WARN  Failed to resolve hostname \"co7-master\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "04:18:08 23703 WARN  Postgres might deny connection attempts from \"co7-master\", even with the new HBA rules.",
            "04:18:08 23703 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "04:18:08 23703 WARN  Using IP address \"192.168.0.81\" in HBA file instead of hostname \"co7-master\"",
            "04:18:08 23703 INFO  Transition complete: current state is now \"single\"",
            "04:18:08 23703 INFO  keeper has been successfully initialized.",
            "04:18:08 23700 WARN  pg_autoctl service node-init exited with exit status 0",
            "04:18:08 23702 INFO  Postgres controller service received signal SIGTERM, terminating",
            "04:18:08 23702 INFO  Stopping pg_autoctl postgres service",
            "04:18:08 23702 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "04:18:08 23700 INFO  Waiting for subprocesses to terminate.",
            "04:18:09 23700 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-22 04:18:10,083 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:10,096 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:10,105 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of pirmary instance] *****************************************************************
2022-03-22 04:18:10,126 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:10,155 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:10,167 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:16,982 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:18:16,992 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:18:17,027 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:17,047 p=17297 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "ansible_job_id": "867709953823.24195",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.031517",
        "end": "2022-03-22 04:18:11.145531",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/867709953823.24195",
        "start": "2022-03-22 04:18:11.114014",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-22 04:18:17,048 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:17,059 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:17,069 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Copy primary systemd service file of primary instance] ***********************************************************
2022-03-22 04:18:17,102 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:17,118 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:17,129 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:18,654 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:18:18,664 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start primary systemd service of primary instance] ****************************************************
2022-03-22 04:18:18,685 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:18,714 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:18,727 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:19,494 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:18:19,505 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] **************************************************************************************
2022-03-22 04:18:19,525 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:19,555 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:19,566 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:20,203 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:18:20,214 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of primary instance] ****************************************************************************
2022-03-22 04:18:20,248 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:20,264 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:20,277 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:20,841 p=17297 u=moonja n=ansible | changed: [co7-node01]
2022-03-22 04:18:20,851 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:18:20,871 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:20,916 p=17297 u=moonja n=ansible | ok: [co7-node01] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.108732",
        "end": "2022-03-22 04:18:21.046627",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-22 04:18:20.937895",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/1662668 |        no |              single |              single",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/1662668 |        no |              single |              single"
        ]
    }
}
2022-03-22 04:18:20,917 p=17297 u=moonja n=ansible | skipping: [co7-node02]
2022-03-22 04:18:20,917 p=17297 u=moonja n=ansible | skipping: [co7-node03]
2022-03-22 04:18:20,925 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Create secondary instance. It will automatically be set by the monitor as the secondary  node with read-write capability (PGDATA = /var/lib/pgpsql/ha)] ***
2022-03-22 04:18:20,946 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:20,962 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:37,927 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:18:39,246 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:18:39,256 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:18:39,276 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:39,293 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:39,318 p=17297 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "898424506534.23604",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node02\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:14.997968",
        "end": "2022-03-22 04:18:36.790044",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/898424506534.23604",
        "start": "2022-03-22 04:18:21.792076",
        "started": 1,
        "stderr": "04:18:21 23614 INFO  Using default --ssl-mode \"require\"\n04:18:21 23614 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n04:18:21 23614 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n04:18:21 23614 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n04:18:21 23614 INFO  Started pg_autoctl postgres service with pid 23616\n04:18:21 23614 INFO  Started pg_autoctl node-init service with pid 23617\n04:18:21 23616 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n04:18:23 23617 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"\n04:18:23 23617 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n04:18:23 23617 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n04:18:23 23617 INFO  Successfully registered as \"wait_standby\" to the monitor.\n04:18:23 23617 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n04:18:23 23617 INFO  Transition complete: current state is now \"wait_standby\"\n04:18:25 23617 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n04:18:25 23617 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n04:18:25 23617 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n04:18:27 23617 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n04:18:27 23617 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n04:18:27 23617 INFO  Initialising PostgreSQL as a hot standby\n04:18:27 23617 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3\n04:18:27 23617 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n04:18:28 23617 INFO  pg_basebackup: checkpoint completed\n04:18:28 23617 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1\n04:18:28 23617 INFO  pg_basebackup: starting background WAL receiver\n04:18:28 23617 INFO      0/33121 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)\n04:18:29 23617 INFO  13070/33121 kB (39%), 0/1 tablespace (...ql/backup/node_3/base/14173/2655)\n04:18:29 23617 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)\n04:18:29 23617 INFO  33129/33129 kB (100%), 1/1 tablespace                                         \n04:18:29 23617 INFO  pg_basebackup: write-ahead log end point: 0/20001B0\n04:18:29 23617 INFO  pg_basebackup: waiting for background process to finish streaming ...\n04:18:29 23617 INFO  pg_basebackup: syncing data to disk ...\n04:18:32 23617 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest\n04:18:32 23617 INFO  pg_basebackup: base backup completed\n04:18:32 23617 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"\n04:18:32 23617 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"\n04:18:33 23849 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n04:18:34 23616 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 23849\n04:18:34 23617 INFO  PostgreSQL started on port 5432\n04:18:34 23617 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n04:18:34 23617 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n04:18:34 23617 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n04:18:34 23617 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n04:18:34 23617 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n04:18:34 23617 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n04:18:34 23617 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n04:18:34 23617 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.\n04:18:34 23617 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n04:18:34 23617 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"\n04:18:34 23617 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)\n04:18:35 23617 INFO  Transition complete: current state is now \"catchingup\"\n04:18:35 23617 INFO  keeper has been successfully initialized.\n04:18:35 23614 WARN  pg_autoctl service node-init exited with exit status 0\n04:18:35 23616 INFO  Postgres controller service received signal SIGTERM, terminating\n04:18:35 23616 INFO  Stopping pg_autoctl postgres service\n04:18:35 23616 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n04:18:35 23614 INFO  Waiting for subprocesses to terminate.\n04:18:36 23614 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "04:18:21 23614 INFO  Using default --ssl-mode \"require\"",
            "04:18:21 23614 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "04:18:21 23614 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "04:18:21 23614 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "04:18:21 23614 INFO  Started pg_autoctl postgres service with pid 23616",
            "04:18:21 23614 INFO  Started pg_autoctl node-init service with pid 23617",
            "04:18:21 23616 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "04:18:23 23617 INFO  Registered node 3 (co7-node02:5432) with name \"node_3\" in formation \"default\", group 0, state \"wait_standby\"",
            "04:18:23 23617 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "04:18:23 23617 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "04:18:23 23617 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "04:18:23 23617 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "04:18:23 23617 INFO  Transition complete: current state is now \"wait_standby\"",
            "04:18:25 23617 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "04:18:25 23617 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "04:18:25 23617 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "04:18:27 23617 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "04:18:27 23617 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "04:18:27 23617 INFO  Initialising PostgreSQL as a hot standby",
            "04:18:27 23617 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_3 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_3 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_3",
            "04:18:27 23617 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "04:18:28 23617 INFO  pg_basebackup: checkpoint completed",
            "04:18:28 23617 INFO  pg_basebackup: write-ahead log start point: 0/2000028 on timeline 1",
            "04:18:28 23617 INFO  pg_basebackup: starting background WAL receiver",
            "04:18:28 23617 INFO      0/33121 kB (0%), 0/1 tablespace (...pgsql/backup/node_3/backup_label)",
            "04:18:29 23617 INFO  13070/33121 kB (39%), 0/1 tablespace (...ql/backup/node_3/base/14173/2655)",
            "04:18:29 23617 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_3/global/pg_control)",
            "04:18:29 23617 INFO  33129/33129 kB (100%), 1/1 tablespace                                         ",
            "04:18:29 23617 INFO  pg_basebackup: write-ahead log end point: 0/20001B0",
            "04:18:29 23617 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "04:18:29 23617 INFO  pg_basebackup: syncing data to disk ...",
            "04:18:32 23617 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest",
            "04:18:32 23617 INFO  pg_basebackup: base backup completed",
            "04:18:32 23617 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"",
            "04:18:32 23617 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node02\"",
            "04:18:33 23849 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "04:18:34 23616 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 23849",
            "04:18:34 23617 INFO  PostgreSQL started on port 5432",
            "04:18:34 23617 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "04:18:34 23617 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "04:18:34 23617 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "04:18:34 23617 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "04:18:34 23617 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "04:18:34 23617 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "04:18:34 23617 WARN  Failed to resolve hostname \"co7-node03\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "04:18:34 23617 WARN  Postgres might deny connection attempts from \"co7-node03\", even with the new HBA rules.",
            "04:18:34 23617 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "04:18:34 23617 WARN  Using IP address \"192.168.0.85\" in HBA file instead of hostname \"co7-node03\"",
            "04:18:34 23617 INFO  Ensuring HBA rules for node 2 \"node_2\" (192.168.0.85:5432)",
            "04:18:35 23617 INFO  Transition complete: current state is now \"catchingup\"",
            "04:18:35 23617 INFO  keeper has been successfully initialized.",
            "04:18:35 23614 WARN  pg_autoctl service node-init exited with exit status 0",
            "04:18:35 23616 INFO  Postgres controller service received signal SIGTERM, terminating",
            "04:18:35 23616 INFO  Stopping pg_autoctl postgres service",
            "04:18:35 23616 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "04:18:35 23614 INFO  Waiting for subprocesses to terminate.",
            "04:18:36 23614 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-22 04:18:39,417 p=17297 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "131533737775.24372",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ;  pg_autoctl create postgres --pgdata \"ha\" --auth trust --ssl-self-signed --username ha-admin --dbname \"appdb\" --hostname \"co7-node03\" --pgctl /bin/pg_ctl --monitor 'postgres://autoctl_node@co7-master/pg_auto_failover?sslmode=require' )",
        "delta": "0:00:15.503981",
        "end": "2022-03-22 04:18:37.288868",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/131533737775.24372",
        "start": "2022-03-22 04:18:21.784887",
        "started": 1,
        "stderr": "04:18:21 24382 INFO  Using default --ssl-mode \"require\"\n04:18:21 24382 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic\n04:18:21 24382 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.\n04:18:21 24382 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details\n04:18:21 24382 INFO  Started pg_autoctl postgres service with pid 24384\n04:18:21 24384 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v\n04:18:21 24382 INFO  Started pg_autoctl node-init service with pid 24385\n04:18:21 24385 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"\n04:18:21 24385 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"\n04:18:23 24385 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"\n04:18:23 24385 INFO  Successfully registered as \"wait_standby\" to the monitor.\n04:18:23 24385 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary\n04:18:23 24385 INFO  Transition complete: current state is now \"wait_standby\"\n04:18:23 24385 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby\n04:18:24 24385 INFO  Still waiting for the monitor to drive us to state \"catchingup\"\n04:18:24 24385 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.\n04:18:25 24385 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary\n04:18:27 24385 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary\n04:18:27 24385 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby\n04:18:27 24385 INFO  Initialising PostgreSQL as a hot standby\n04:18:27 24385 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2\n04:18:28 24385 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete\n04:18:28 24385 INFO  pg_basebackup: checkpoint completed\n04:18:28 24385 INFO  pg_basebackup: write-ahead log start point: 0/20000D8 on timeline 1\n04:18:28 24385 INFO  pg_basebackup: starting background WAL receiver\n04:18:28 24385 INFO      0/33120 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)\n04:18:29 24385 INFO  13070/33120 kB (39%), 0/1 tablespace (...ql/backup/node_2/base/14173/2655)\n04:18:31 24385 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n04:18:31 24385 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)\n04:18:31 24385 INFO  33129/33129 kB (100%), 1/1 tablespace                                         \n04:18:31 24385 INFO  pg_basebackup: write-ahead log end point: 0/3000050\n04:18:31 24385 INFO  pg_basebackup: waiting for background process to finish streaming ...\n04:18:31 24385 INFO  pg_basebackup: syncing data to disk ...\n04:18:34 24385 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest\n04:18:34 24385 INFO  pg_basebackup: base backup completed\n04:18:34 24385 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"\n04:18:34 24385 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"\n04:18:34 24609 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *\n04:18:35 24385 INFO  PostgreSQL started on port 5432\n04:18:35 24384 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 24609\n04:18:35 24385 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.\n04:18:35 24385 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n04:18:35 24385 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.\n04:18:35 24385 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n04:18:35 24385 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"\n04:18:35 24385 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)\n04:18:35 24385 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.\n04:18:35 24385 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.\n04:18:35 24385 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.\n04:18:35 24385 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"\n04:18:35 24385 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)\n04:18:35 24385 INFO  Transition complete: current state is now \"catchingup\"\n04:18:36 24385 INFO  keeper has been successfully initialized.\n04:18:36 24382 WARN  pg_autoctl service node-init exited with exit status 0\n04:18:36 24384 INFO  Postgres controller service received signal SIGTERM, terminating\n04:18:36 24384 INFO  Stopping pg_autoctl postgres service\n04:18:36 24384 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast\n04:18:36 24382 INFO  Waiting for subprocesses to terminate.\n04:18:37 24382 INFO  Stop pg_autoctl",
        "stderr_lines": [
            "04:18:21 24382 INFO  Using default --ssl-mode \"require\"",
            "04:18:21 24382 INFO  Using --ssl-self-signed: pg_autoctl will create self-signed certificates, allowing for encrypted network traffic",
            "04:18:21 24382 WARN  Self-signed certificates provide protection against eavesdropping; this setup does NOT protect against Man-In-The-Middle attacks nor Impersonation attacks.",
            "04:18:21 24382 WARN  See https://www.postgresql.org/docs/current/libpq-ssl.html for details",
            "04:18:21 24382 INFO  Started pg_autoctl postgres service with pid 24384",
            "04:18:21 24384 INFO   /usr/bin/pg_autoctl do service postgres --pgdata ha -v",
            "04:18:21 24382 INFO  Started pg_autoctl node-init service with pid 24385",
            "04:18:21 24385 INFO  Registered node 2 (co7-node03:5432) with name \"node_2\" in formation \"default\", group 0, state \"wait_standby\"",
            "04:18:21 24385 INFO  Writing keeper state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.state\"",
            "04:18:23 24385 INFO  Writing keeper init state file at \"/var/lib/pgsql/.local/share/pg_autoctl/var/lib/pgsql/ha/pg_autoctl.init\"",
            "04:18:23 24385 INFO  Successfully registered as \"wait_standby\" to the monitor.",
            "04:18:23 24385 INFO  FSM transition from \"init\" to \"wait_standby\": Start following a primary",
            "04:18:23 24385 INFO  Transition complete: current state is now \"wait_standby\"",
            "04:18:23 24385 INFO  New state for node 3 \"node_3\" (co7-node02:5432): wait_standby  wait_standby",
            "04:18:24 24385 INFO  Still waiting for the monitor to drive us to state \"catchingup\"",
            "04:18:24 24385 WARN  Please make sure that the primary node is currently running `pg_autoctl run` and contacting the monitor.",
            "04:18:25 24385 INFO  New state for node 1 \"node_1\" (co7-node01:5432): single  wait_primary",
            "04:18:27 24385 INFO  New state for node 1 \"node_1\" (co7-node01:5432): wait_primary  wait_primary",
            "04:18:27 24385 INFO  FSM transition from \"wait_standby\" to \"catchingup\": The primary is now ready to accept a standby",
            "04:18:27 24385 INFO  Initialising PostgreSQL as a hot standby",
            "04:18:27 24385 INFO   /bin/pg_basebackup -w -d application_name=pgautofailover_standby_2 host=co7-node01 port=5432 user=pgautofailover_replicator sslmode=require --pgdata /var/lib/pgsql/backup/node_2 -U pgautofailover_replicator --verbose --progress --max-rate 100M --wal-method=stream --slot pgautofailover_standby_2",
            "04:18:28 24385 INFO  pg_basebackup: initiating base backup, waiting for checkpoint to complete",
            "04:18:28 24385 INFO  pg_basebackup: checkpoint completed",
            "04:18:28 24385 INFO  pg_basebackup: write-ahead log start point: 0/20000D8 on timeline 1",
            "04:18:28 24385 INFO  pg_basebackup: starting background WAL receiver",
            "04:18:28 24385 INFO      0/33120 kB (0%), 0/1 tablespace (...pgsql/backup/node_2/backup_label)",
            "04:18:29 24385 INFO  13070/33120 kB (39%), 0/1 tablespace (...ql/backup/node_2/base/14173/2655)",
            "04:18:31 24385 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "04:18:31 24385 INFO  33129/33129 kB (100%), 0/1 tablespace (.../backup/node_2/global/pg_control)",
            "04:18:31 24385 INFO  33129/33129 kB (100%), 1/1 tablespace                                         ",
            "04:18:31 24385 INFO  pg_basebackup: write-ahead log end point: 0/3000050",
            "04:18:31 24385 INFO  pg_basebackup: waiting for background process to finish streaming ...",
            "04:18:31 24385 INFO  pg_basebackup: syncing data to disk ...",
            "04:18:34 24385 INFO  pg_basebackup: renaming backup_manifest.tmp to backup_manifest",
            "04:18:34 24385 INFO  pg_basebackup: base backup completed",
            "04:18:34 24385 INFO  Creating the standby signal file at \"/var/lib/pgsql/ha/standby.signal\", and replication setup at \"/var/lib/pgsql/ha/postgresql-auto-failover-standby.conf\"",
            "04:18:34 24385 INFO   /bin/openssl req -new -x509 -days 365 -nodes -text -out /var/lib/pgsql/ha/server.crt -keyout /var/lib/pgsql/ha/server.key -subj \"/CN=co7-node03\"",
            "04:18:34 24609 INFO   /bin/postgres -D /var/lib/pgsql/ha -p 5432 -h *",
            "04:18:35 24385 INFO  PostgreSQL started on port 5432",
            "04:18:35 24384 INFO  Postgres is now serving PGDATA \"/var/lib/pgsql/ha\" on port 5432 with pid 24609",
            "04:18:35 24385 INFO  Fetched current list of 2 other nodes from the monitor to update HBA rules, including 2 changes.",
            "04:18:35 24385 WARN  Failed to resolve hostname \"co7-node01\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "04:18:35 24385 WARN  Postgres might deny connection attempts from \"co7-node01\", even with the new HBA rules.",
            "04:18:35 24385 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "04:18:35 24385 WARN  Using IP address \"192.168.0.83\" in HBA file instead of hostname \"co7-node01\"",
            "04:18:35 24385 INFO  Ensuring HBA rules for node 1 \"node_1\" (192.168.0.83:5432)",
            "04:18:35 24385 WARN  Failed to resolve hostname \"co7-node02\" to an IP address that resolves back to the hostname on a reverse DNS lookup.",
            "04:18:35 24385 WARN  Postgres might deny connection attempts from \"co7-node02\", even with the new HBA rules.",
            "04:18:35 24385 WARN  Hint: correct setup of HBA with host names requires proper reverse DNS setup. You might want to use IP addresses.",
            "04:18:35 24385 WARN  Using IP address \"192.168.0.84\" in HBA file instead of hostname \"co7-node02\"",
            "04:18:35 24385 INFO  Ensuring HBA rules for node 3 \"node_3\" (192.168.0.84:5432)",
            "04:18:35 24385 INFO  Transition complete: current state is now \"catchingup\"",
            "04:18:36 24385 INFO  keeper has been successfully initialized.",
            "04:18:36 24382 WARN  pg_autoctl service node-init exited with exit status 0",
            "04:18:36 24384 INFO  Postgres controller service received signal SIGTERM, terminating",
            "04:18:36 24384 INFO  Stopping pg_autoctl postgres service",
            "04:18:36 24384 INFO  /bin/pg_ctl --pgdata /var/lib/pgsql/ha --wait stop --mode fast",
            "04:18:36 24382 INFO  Waiting for subprocesses to terminate.",
            "04:18:37 24382 INFO  Stop pg_autoctl"
        ],
        "stdout": "",
        "stdout_lines": [],
        "warnings": [
            "Module remote_tmp /var/lib/pgsql/.ansible/tmp did not exist and was created with a mode of 0700, this may cause issues when running as another user. To avoid this, create the remote_tmp dir with the correct permissions manually"
        ]
    }
}
2022-03-22 04:18:39,430 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Create systemd service file of secondary instance] ***************************************************************
2022-03-22 04:18:39,452 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:39,467 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:45,785 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:18:46,745 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:18:46,754 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:18:46,775 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:46,792 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:46,811 p=17297 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "ansible_job_id": "484323431870.24179",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032625",
        "end": "2022-03-22 04:18:40.330074",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/484323431870.24179",
        "start": "2022-03-22 04:18:40.297449",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-22 04:18:46,825 p=17297 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "ansible_job_id": "314137388960.24947",
        "changed": true,
        "cmd": "( cd /var/lib/pgsql ; pg_autoctl -q show systemd --pgdata ~postgres/ha > pgautofailover.service )",
        "delta": "0:00:00.032581",
        "end": "2022-03-22 04:18:40.329870",
        "failed": false,
        "finished": 1,
        "msg": "",
        "rc": 0,
        "results_file": "/var/lib/pgsql/.ansible_async/314137388960.24947",
        "start": "2022-03-22 04:18:40.297289",
        "started": 1,
        "stderr": "",
        "stderr_lines": [],
        "stdout": "",
        "stdout_lines": []
    }
}
2022-03-22 04:18:46,836 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Copy secondary systemd service file of secondary instance] *******************************************************
2022-03-22 04:18:46,856 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:46,904 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:47,363 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:18:47,468 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:18:47,481 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Reload and start secondary systemd service of secondary instance] ************************************************
2022-03-22 04:18:47,519 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:47,533 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:48,316 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:18:48,317 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:18:48,327 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Replace database directory] **************************************************************************************
2022-03-22 04:18:48,348 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:48,365 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:49,201 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:18:49,218 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:18:49,228 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : Verify the state of secondary instance] **************************************************************************
2022-03-22 04:18:49,249 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:49,265 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:49,851 p=17297 u=moonja n=ansible | changed: [co7-node03]
2022-03-22 04:18:49,863 p=17297 u=moonja n=ansible | changed: [co7-node02]
2022-03-22 04:18:49,874 p=17297 u=moonja n=ansible | TASK [pgfailover-postgres : debug] ***********************************************************************************************************
2022-03-22 04:18:49,894 p=17297 u=moonja n=ansible | skipping: [co7-master]
2022-03-22 04:18:49,911 p=17297 u=moonja n=ansible | skipping: [co7-node01]
2022-03-22 04:18:49,966 p=17297 u=moonja n=ansible | ok: [co7-node02] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.118786",
        "end": "2022-03-22 04:18:50.061077",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-22 04:18:49.942291",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/3000000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/3000000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-22 04:18:49,969 p=17297 u=moonja n=ansible | ok: [co7-node03] => {
    "msg": {
        "changed": true,
        "cmd": "( source ~/.bash_profile ; pg_autoctl show state )",
        "delta": "0:00:00.106707",
        "end": "2022-03-22 04:18:50.048126",
        "failed": false,
        "msg": "",
        "rc": 0,
        "start": "2022-03-22 04:18:49.941419",
        "stderr": "",
        "stderr_lines": [],
        "stdout": "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State\n-------+-------+-----------------+-----------+-----------+---------------------+--------------------\nnode_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary\nnode_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup\nnode_3 |     3 | co7-node02:5432 | 0/3000000 |        no |          catchingup |          catchingup",
        "stdout_lines": [
            "  Name |  Node |       Host:Port |       LSN | Reachable |       Current State |      Assigned State",
            "-------+-------+-----------------+-----------+-----------+---------------------+--------------------",
            "node_1 |     1 | co7-node01:5432 | 0/4000060 |       yes |        wait_primary |        wait_primary",
            "node_2 |     2 | co7-node03:5432 | 0/4000000 |        no |          catchingup |          catchingup",
            "node_3 |     3 | co7-node02:5432 | 0/3000000 |        no |          catchingup |          catchingup"
        ]
    }
}
2022-03-22 04:18:50,015 p=17297 u=moonja n=ansible | PLAY RECAP ***********************************************************************************************************************************
2022-03-22 04:18:50,015 p=17297 u=moonja n=ansible | co7-master                 : ok=27   changed=15   unreachable=0    failed=0    skipped=19   rescued=0    ignored=0   
2022-03-22 04:18:50,015 p=17297 u=moonja n=ansible | co7-node01                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-22 04:18:50,015 p=17297 u=moonja n=ansible | co7-node02                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
2022-03-22 04:18:50,015 p=17297 u=moonja n=ansible | co7-node03                 : ok=21   changed=12   unreachable=0    failed=0    skipped=25   rescued=0    ignored=0   
